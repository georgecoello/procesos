{"ast":null,"code":"// src/services/aiService.js\n// Leer la API key de forma segura tanto para Vue CLI como para Vite\n// Detectar proveedor y claves desde envs (soporta Vue CLI y Vite)\nconst getEnv = keyVariants => {\n  try {\n    for (const k of keyVariants) {\n      if (typeof process !== 'undefined' && process.env && process.env[k]) return process.env[k];\n    }\n    try {\n      if (import.meta && import.meta.env) {\n        for (const k of keyVariants) {\n          if (import.meta.env[k]) return import.meta.env[k];\n        }\n      }\n    } catch (e) {\n      // import.meta not available in some environments\n    }\n  } catch (e) {\n    // ignore\n  }\n  return '';\n};\nconst AI_PROVIDER = getEnv(['AI_PROVIDER', 'VITE_AI_PROVIDER']) || 'openai';\nconst OPENAI_KEY = getEnv(['OPENAI_API_KEY', 'VUE_APP_OPENAI_API_KEY', 'VITE_OPENAI_API_KEY']);\nconst OPENAI_URL = getEnv(['OPENAI_API_URL', 'VITE_OPENAI_API_URL']) || 'https://api.openai.com/v1/chat/completions';\nconst GROQ_KEY = getEnv(['GROQ_API_KEY', 'VITE_GROQ_API_KEY']);\nconst GROQ_URL = getEnv(['GROQ_API_URL', 'VITE_GROQ_API_URL']) || '';\nconst GROQ_MODEL = getEnv(['GROQ_MODEL', 'VITE_GROQ_MODEL']) || '';\nexport class AIService {\n  constructor() {\n    this.provider = (AI_PROVIDER || 'openai').toLowerCase();\n    this.openaiKey = OPENAI_KEY;\n    this.openaiUrl = OPENAI_URL;\n    this.groqKey = GROQ_KEY;\n    this.groqUrl = GROQ_URL;\n    this.groqModel = GROQ_MODEL;\n    this.isAvailable = this.provider === 'openai' && !!this.openaiKey || this.provider === 'groq' && !!this.groqKey && !!this.groqUrl;\n  }\n\n  // Envia un prompt al proveedor configurado y devuelve el texto resultante\n  async sendPrompt(prompt, options = {}) {\n    if (!this.isAvailable) {\n      throw new Error('Proveedor de IA no configurado o faltan credenciales. Revisa tus variables de entorno.');\n    }\n\n    // Groq (u otro proveedor) - envía la petición según su API\n    if (this.provider === 'groq') {\n      const body = {\n        input: prompt\n      };\n      if (this.groqModel) body.model = this.groqModel;\n      const resp = await fetch(this.groqUrl, {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n          Authorization: `Bearer ${this.groqKey}`\n        },\n        body: JSON.stringify(body)\n      });\n      if (!resp.ok) {\n        const err = await resp.text();\n        throw new Error(`Error Groq API: ${resp.status} - ${err}`);\n      }\n      const data = await resp.json();\n      return data.output?.[0]?.content || data.output_text || data.choices?.[0]?.text || data.choices?.[0]?.message?.content || data.result || JSON.stringify(data);\n    }\n\n    // Por defecto: OpenAI-style chat completion\n    const messages = [{\n      role: 'system',\n      content: 'Eres un analista de procesos empresariales. Extrae información estructurada de descripciones de procedimientos.'\n    }, {\n      role: 'user',\n      content: prompt\n    }];\n    const resp = await fetch(this.openaiUrl, {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json',\n        Authorization: `Bearer ${this.openaiKey}`\n      },\n      body: JSON.stringify({\n        model: options.model || 'gpt-3.5-turbo',\n        messages,\n        temperature: options.temperature ?? 0.3,\n        max_tokens: options.max_tokens || 2000\n      })\n    });\n    if (!resp.ok) {\n      const errorData = await resp.json().catch(() => ({}));\n      throw new Error(`Error OpenAI API: ${resp.status} - ${errorData.error?.message || 'Error desconocido'}`);\n    }\n    const data = await resp.json();\n    return data.choices?.[0]?.message?.content || data.choices?.[0]?.text || JSON.stringify(data);\n  }\n  async analyzeProcedimiento(texto) {\n    if (!this.isAvailable) {\n      throw new Error('API key no configurada. Configura las variables de entorno correspondientes.');\n    }\n    const prompt = `Analiza el siguiente texto que describe un procedimiento empresarial. Extrae:\n1. Cada paso secuencial del procedimiento\n2. El responsable o rol de cada paso\n3. La actividad específica a realizar\n4. Detecta decisiones (preguntas sí/no), alternativas y finalizaciones\n\nFormato de respuesta JSON:\n{\n  \"pasos\": [\n    {\n      \"numero\": \"5.1\",\n      \"responsable\": \"Administrador\",\n      \"actividad\": \"Revisar lista de proveedores a pagar\",\n      \"tipo\": \"normal|decision|alternativa|fin\",\n      \"subpasos\": [\n        {\n          \"numero\": \"a\",\n          \"responsable\": \"Administrador\",\n          \"actividad\": \"Verificar documentos de respaldo\"\n        }\n      ]\n    }\n  ]\n}\n\nTexto del procedimiento:\n${texto}`;\n    const content = await this.sendPrompt(prompt, {\n      temperature: 0.3,\n      max_tokens: 2000\n    });\n\n    // Intentar extraer JSON desde una respuesta que puede incluir markdown\n    const jsonMatch = (content || '').match(/```json\\n([\\s\\S]*?)\\n```/) || (content || '').match(/{[\\s\\S]*}/);\n    let jsonText;\n    if (jsonMatch) {\n      jsonText = jsonMatch[0].replace(/```json\\n|\\n```/g, '');\n    } else {\n      const jsonStart = (content || '').indexOf('{');\n      const jsonEnd = (content || '').lastIndexOf('}');\n      if (jsonStart !== -1 && jsonEnd !== -1) {\n        jsonText = (content || '').substring(jsonStart, jsonEnd + 1);\n      } else {\n        throw new Error('No se encontró JSON en la respuesta');\n      }\n    }\n    return JSON.parse(jsonText);\n  }\n  async generarSugerencia(seccion, contenidoActual = '') {\n    if (!this.isAvailable) {\n      return null;\n    }\n    const prompts = {\n      objetivo: `Genera un objetivo profesional para un procedimiento administrativo. \\nEl objetivo debe ser: Específico, Medible, Alcanzable, Relevante y con Tiempo definido (SMART).`,\n      alcance: `Define el alcance apropiado para un procedimiento empresarial. \\nIncluye: Áreas/departamentos cubiertos, exclusiones claras, límites geográficos o funcionales.`,\n      responsabilidades: `Lista los roles y responsabilidades típicas para un procedimiento empresarial. \\nFormato: 1. [Rol]: [Responsabilidad específica]`,\n      normativa: `Menciona las normativas, políticas internas y regulaciones externas relevantes. \\nIncluye: Leyes aplicables, políticas de la empresa, estándares de calidad.`\n    };\n    const promptBase = prompts[seccion] || `Completa esta sección de un documento de procedimientos empresariales.`;\n    try {\n      const prompt = `${promptBase}\\n\\nContexto actual (puede estar vacío): ${contenidoActual}`;\n      const content = await this.sendPrompt(prompt, {\n        temperature: 0.5,\n        max_tokens: 500\n      });\n      return content;\n    } catch (error) {\n      console.error('Error en generación de sugerencia:', error);\n      return null;\n    }\n  }\n  async mejorarTextoProcedimiento(texto) {\n    if (!this.isAvailable || !texto.trim()) {\n      return texto;\n    }\n    try {\n      const prompt = `Eres un editor experto en procedimientos empresariales. Mejora el texto siguiendo estas reglas:\\n1. Claridad: Cada oración describe un solo paso\\n2. Estructura: Usa lenguaje directo (sujeto + verbo + objeto)\\n3. Responsables: Identifica claramente quién hace cada acción\\n4. Formato: Incluye decisiones (¿...?) y alternativas (Si/No)\\n5. Concisión: Elimina redundancias pero mantén precisión\\n\\nMejora este texto de procedimiento para hacerlo más claro y estructurado:\\n\\n${texto}`;\n      const content = await this.sendPrompt(prompt, {\n        temperature: 0.4,\n        max_tokens: 1500\n      });\n      return content || texto;\n    } catch (error) {\n      console.error('Error en mejora de texto:', error);\n      return texto;\n    }\n  }\n\n  // Nuevo método: Sugerir mejoras en tiempo real\n  async sugerirMejorasRapidas(texto) {\n    if (!this.isAvailable || !texto.trim()) {\n      return [];\n    }\n    try {\n      const prompt = `Analiza el texto y sugiere 2-3 mejoras rápidas. Responde en formato JSON: {\"mejoras\": [\"sugerencia 1\", \"sugerencia 2\"]}\\n\\nTexto a mejorar: ${texto}`;\n      const content = await this.sendPrompt(prompt, {\n        temperature: 0.3,\n        max_tokens: 300\n      });\n      const jsonMatch = (content || '').match(/{[\\s\\S]*}/);\n      if (jsonMatch) {\n        return JSON.parse(jsonMatch[0]).mejoras || [];\n      }\n      return [];\n    } catch (error) {\n      console.error('Error en sugerencias rápidas:', error);\n      return [];\n    }\n  }\n}\n\n// Instancia exportada\nexport const aiService = new AIService();","map":{"version":3,"names":["getEnv","keyVariants","k","process","env","import","meta","e","AI_PROVIDER","OPENAI_KEY","OPENAI_URL","GROQ_KEY","GROQ_URL","GROQ_MODEL","AIService","constructor","provider","toLowerCase","openaiKey","openaiUrl","groqKey","groqUrl","groqModel","isAvailable","sendPrompt","prompt","options","Error","body","input","model","resp","fetch","method","headers","Authorization","JSON","stringify","ok","err","text","status","data","json","output","content","output_text","choices","message","result","messages","role","temperature","max_tokens","errorData","catch","error","analyzeProcedimiento","texto","jsonMatch","match","jsonText","replace","jsonStart","indexOf","jsonEnd","lastIndexOf","substring","parse","generarSugerencia","seccion","contenidoActual","prompts","objetivo","alcance","responsabilidades","normativa","promptBase","console","mejorarTextoProcedimiento","trim","sugerirMejorasRapidas","mejoras","aiService"],"sources":["/home/jorge/Escritorio/Jorge-PC/procesos/procesos/src/services/aiService.js"],"sourcesContent":["// src/services/aiService.js\n// Leer la API key de forma segura tanto para Vue CLI como para Vite\n// Detectar proveedor y claves desde envs (soporta Vue CLI y Vite)\nconst getEnv = (keyVariants) => {\n  try {\n    for (const k of keyVariants) {\n      if (typeof process !== 'undefined' && process.env && process.env[k]) return process.env[k];\n    }\n    try {\n      if (import.meta && import.meta.env) {\n        for (const k of keyVariants) {\n          if (import.meta.env[k]) return import.meta.env[k];\n        }\n      }\n    } catch (e) {\n      // import.meta not available in some environments\n    }\n  } catch (e) {\n    // ignore\n  }\n  return '';\n};\n\nconst AI_PROVIDER = getEnv(['AI_PROVIDER', 'VITE_AI_PROVIDER']) || 'openai';\nconst OPENAI_KEY = getEnv(['OPENAI_API_KEY', 'VUE_APP_OPENAI_API_KEY', 'VITE_OPENAI_API_KEY']);\nconst OPENAI_URL = getEnv(['OPENAI_API_URL', 'VITE_OPENAI_API_URL']) || 'https://api.openai.com/v1/chat/completions';\n\nconst GROQ_KEY = getEnv(['GROQ_API_KEY', 'VITE_GROQ_API_KEY']);\nconst GROQ_URL = getEnv(['GROQ_API_URL', 'VITE_GROQ_API_URL']) || '';\nconst GROQ_MODEL = getEnv(['GROQ_MODEL', 'VITE_GROQ_MODEL']) || '';\n\nexport class AIService {\n  constructor() {\n    this.provider = (AI_PROVIDER || 'openai').toLowerCase();\n    this.openaiKey = OPENAI_KEY;\n    this.openaiUrl = OPENAI_URL;\n    this.groqKey = GROQ_KEY;\n    this.groqUrl = GROQ_URL;\n    this.groqModel = GROQ_MODEL;\n\n    this.isAvailable = (this.provider === 'openai' && !!this.openaiKey) || (this.provider === 'groq' && !!this.groqKey && !!this.groqUrl);\n  }\n\n  // Envia un prompt al proveedor configurado y devuelve el texto resultante\n  async sendPrompt(prompt, options = {}) {\n    if (!this.isAvailable) {\n      throw new Error('Proveedor de IA no configurado o faltan credenciales. Revisa tus variables de entorno.');\n    }\n\n    // Groq (u otro proveedor) - envía la petición según su API\n    if (this.provider === 'groq') {\n      const body = { input: prompt };\n      if (this.groqModel) body.model = this.groqModel;\n\n      const resp = await fetch(this.groqUrl, {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n          Authorization: `Bearer ${this.groqKey}`\n        },\n        body: JSON.stringify(body)\n      });\n\n      if (!resp.ok) {\n        const err = await resp.text();\n        throw new Error(`Error Groq API: ${resp.status} - ${err}`);\n      }\n\n      const data = await resp.json();\n      return data.output?.[0]?.content || data.output_text || data.choices?.[0]?.text || data.choices?.[0]?.message?.content || data.result || JSON.stringify(data);\n    }\n\n    // Por defecto: OpenAI-style chat completion\n    const messages = [\n      { role: 'system', content: 'Eres un analista de procesos empresariales. Extrae información estructurada de descripciones de procedimientos.' },\n      { role: 'user', content: prompt }\n    ];\n\n    const resp = await fetch(this.openaiUrl, {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json',\n        Authorization: `Bearer ${this.openaiKey}`\n      },\n      body: JSON.stringify({ model: options.model || 'gpt-3.5-turbo', messages, temperature: options.temperature ?? 0.3, max_tokens: options.max_tokens || 2000 })\n    });\n\n    if (!resp.ok) {\n      const errorData = await resp.json().catch(() => ({}));\n      throw new Error(`Error OpenAI API: ${resp.status} - ${errorData.error?.message || 'Error desconocido'}`);\n    }\n\n    const data = await resp.json();\n    return data.choices?.[0]?.message?.content || data.choices?.[0]?.text || JSON.stringify(data);\n  }\n\n  async analyzeProcedimiento(texto) {\n    if (!this.isAvailable) {\n      throw new Error('API key no configurada. Configura las variables de entorno correspondientes.');\n    }\n\n    const prompt = `Analiza el siguiente texto que describe un procedimiento empresarial. Extrae:\n1. Cada paso secuencial del procedimiento\n2. El responsable o rol de cada paso\n3. La actividad específica a realizar\n4. Detecta decisiones (preguntas sí/no), alternativas y finalizaciones\n\nFormato de respuesta JSON:\n{\n  \"pasos\": [\n    {\n      \"numero\": \"5.1\",\n      \"responsable\": \"Administrador\",\n      \"actividad\": \"Revisar lista de proveedores a pagar\",\n      \"tipo\": \"normal|decision|alternativa|fin\",\n      \"subpasos\": [\n        {\n          \"numero\": \"a\",\n          \"responsable\": \"Administrador\",\n          \"actividad\": \"Verificar documentos de respaldo\"\n        }\n      ]\n    }\n  ]\n}\n\nTexto del procedimiento:\n${texto}`;\n\n    const content = await this.sendPrompt(prompt, { temperature: 0.3, max_tokens: 2000 });\n\n    // Intentar extraer JSON desde una respuesta que puede incluir markdown\n    const jsonMatch = (content || '').match(/```json\\n([\\s\\S]*?)\\n```/) || (content || '').match(/{[\\s\\S]*}/);\n    let jsonText;\n\n    if (jsonMatch) {\n      jsonText = jsonMatch[0].replace(/```json\\n|\\n```/g, '');\n    } else {\n      const jsonStart = (content || '').indexOf('{');\n      const jsonEnd = (content || '').lastIndexOf('}');\n      if (jsonStart !== -1 && jsonEnd !== -1) {\n        jsonText = (content || '').substring(jsonStart, jsonEnd + 1);\n      } else {\n        throw new Error('No se encontró JSON en la respuesta');\n      }\n    }\n\n    return JSON.parse(jsonText);\n  }\n\n  async generarSugerencia(seccion, contenidoActual = '') {\n    if (!this.isAvailable) {\n      return null;\n    }\n\n    const prompts = {\n      objetivo: `Genera un objetivo profesional para un procedimiento administrativo. \\nEl objetivo debe ser: Específico, Medible, Alcanzable, Relevante y con Tiempo definido (SMART).`,\n      alcance: `Define el alcance apropiado para un procedimiento empresarial. \\nIncluye: Áreas/departamentos cubiertos, exclusiones claras, límites geográficos o funcionales.`,\n      responsabilidades: `Lista los roles y responsabilidades típicas para un procedimiento empresarial. \\nFormato: 1. [Rol]: [Responsabilidad específica]`,\n      normativa: `Menciona las normativas, políticas internas y regulaciones externas relevantes. \\nIncluye: Leyes aplicables, políticas de la empresa, estándares de calidad.`\n    };\n\n    const promptBase = prompts[seccion] || `Completa esta sección de un documento de procedimientos empresariales.`;\n\n    try {\n      const prompt = `${promptBase}\\n\\nContexto actual (puede estar vacío): ${contenidoActual}`;\n      const content = await this.sendPrompt(prompt, { temperature: 0.5, max_tokens: 500 });\n      return content;\n    } catch (error) {\n      console.error('Error en generación de sugerencia:', error);\n      return null;\n    }\n  }\n\n  async mejorarTextoProcedimiento(texto) {\n    if (!this.isAvailable || !texto.trim()) {\n      return texto;\n    }\n\n    try {\n      const prompt = `Eres un editor experto en procedimientos empresariales. Mejora el texto siguiendo estas reglas:\\n1. Claridad: Cada oración describe un solo paso\\n2. Estructura: Usa lenguaje directo (sujeto + verbo + objeto)\\n3. Responsables: Identifica claramente quién hace cada acción\\n4. Formato: Incluye decisiones (¿...?) y alternativas (Si/No)\\n5. Concisión: Elimina redundancias pero mantén precisión\\n\\nMejora este texto de procedimiento para hacerlo más claro y estructurado:\\n\\n${texto}`;\n      const content = await this.sendPrompt(prompt, { temperature: 0.4, max_tokens: 1500 });\n      return content || texto;\n    } catch (error) {\n      console.error('Error en mejora de texto:', error);\n      return texto;\n    }\n  }\n\n  // Nuevo método: Sugerir mejoras en tiempo real\n  async sugerirMejorasRapidas(texto) {\n    if (!this.isAvailable || !texto.trim()) {\n      return [];\n    }\n\n    try {\n      const prompt = `Analiza el texto y sugiere 2-3 mejoras rápidas. Responde en formato JSON: {\"mejoras\": [\"sugerencia 1\", \"sugerencia 2\"]}\\n\\nTexto a mejorar: ${texto}`;\n      const content = await this.sendPrompt(prompt, { temperature: 0.3, max_tokens: 300 });\n      const jsonMatch = (content || '').match(/{[\\s\\S]*}/);\n      if (jsonMatch) {\n        return JSON.parse(jsonMatch[0]).mejoras || [];\n      }\n      return [];\n    } catch (error) {\n      console.error('Error en sugerencias rápidas:', error);\n      return [];\n    }\n  }\n}\n\n// Instancia exportada\nexport const aiService = new AIService();"],"mappings":"AAAA;AACA;AACA;AACA,MAAMA,MAAM,GAAIC,WAAW,IAAK;EAC9B,IAAI;IACF,KAAK,MAAMC,CAAC,IAAID,WAAW,EAAE;MAC3B,IAAI,OAAOE,OAAO,KAAK,WAAW,IAAIA,OAAO,CAACC,GAAG,IAAID,OAAO,CAACC,GAAG,CAACF,CAAC,CAAC,EAAE,OAAOC,OAAO,CAACC,GAAG,CAACF,CAAC,CAAC;IAC5F;IACA,IAAI;MACF,IAAIG,MAAM,CAACC,IAAI,IAAID,MAAM,CAACC,IAAI,CAACF,GAAG,EAAE;QAClC,KAAK,MAAMF,CAAC,IAAID,WAAW,EAAE;UAC3B,IAAII,MAAM,CAACC,IAAI,CAACF,GAAG,CAACF,CAAC,CAAC,EAAE,OAAOG,MAAM,CAACC,IAAI,CAACF,GAAG,CAACF,CAAC,CAAC;QACnD;MACF;IACF,CAAC,CAAC,OAAOK,CAAC,EAAE;MACV;IAAA;EAEJ,CAAC,CAAC,OAAOA,CAAC,EAAE;IACV;EAAA;EAEF,OAAO,EAAE;AACX,CAAC;AAED,MAAMC,WAAW,GAAGR,MAAM,CAAC,CAAC,aAAa,EAAE,kBAAkB,CAAC,CAAC,IAAI,QAAQ;AAC3E,MAAMS,UAAU,GAAGT,MAAM,CAAC,CAAC,gBAAgB,EAAE,wBAAwB,EAAE,qBAAqB,CAAC,CAAC;AAC9F,MAAMU,UAAU,GAAGV,MAAM,CAAC,CAAC,gBAAgB,EAAE,qBAAqB,CAAC,CAAC,IAAI,4CAA4C;AAEpH,MAAMW,QAAQ,GAAGX,MAAM,CAAC,CAAC,cAAc,EAAE,mBAAmB,CAAC,CAAC;AAC9D,MAAMY,QAAQ,GAAGZ,MAAM,CAAC,CAAC,cAAc,EAAE,mBAAmB,CAAC,CAAC,IAAI,EAAE;AACpE,MAAMa,UAAU,GAAGb,MAAM,CAAC,CAAC,YAAY,EAAE,iBAAiB,CAAC,CAAC,IAAI,EAAE;AAElE,OAAO,MAAMc,SAAS,CAAC;EACrBC,WAAWA,CAAA,EAAG;IACZ,IAAI,CAACC,QAAQ,GAAG,CAACR,WAAW,IAAI,QAAQ,EAAES,WAAW,CAAC,CAAC;IACvD,IAAI,CAACC,SAAS,GAAGT,UAAU;IAC3B,IAAI,CAACU,SAAS,GAAGT,UAAU;IAC3B,IAAI,CAACU,OAAO,GAAGT,QAAQ;IACvB,IAAI,CAACU,OAAO,GAAGT,QAAQ;IACvB,IAAI,CAACU,SAAS,GAAGT,UAAU;IAE3B,IAAI,CAACU,WAAW,GAAI,IAAI,CAACP,QAAQ,KAAK,QAAQ,IAAI,CAAC,CAAC,IAAI,CAACE,SAAS,IAAM,IAAI,CAACF,QAAQ,KAAK,MAAM,IAAI,CAAC,CAAC,IAAI,CAACI,OAAO,IAAI,CAAC,CAAC,IAAI,CAACC,OAAQ;EACvI;;EAEA;EACA,MAAMG,UAAUA,CAACC,MAAM,EAAEC,OAAO,GAAG,CAAC,CAAC,EAAE;IACrC,IAAI,CAAC,IAAI,CAACH,WAAW,EAAE;MACrB,MAAM,IAAII,KAAK,CAAC,wFAAwF,CAAC;IAC3G;;IAEA;IACA,IAAI,IAAI,CAACX,QAAQ,KAAK,MAAM,EAAE;MAC5B,MAAMY,IAAI,GAAG;QAAEC,KAAK,EAAEJ;MAAO,CAAC;MAC9B,IAAI,IAAI,CAACH,SAAS,EAAEM,IAAI,CAACE,KAAK,GAAG,IAAI,CAACR,SAAS;MAE/C,MAAMS,IAAI,GAAG,MAAMC,KAAK,CAAC,IAAI,CAACX,OAAO,EAAE;QACrCY,MAAM,EAAE,MAAM;QACdC,OAAO,EAAE;UACP,cAAc,EAAE,kBAAkB;UAClCC,aAAa,EAAE,UAAU,IAAI,CAACf,OAAO;QACvC,CAAC;QACDQ,IAAI,EAAEQ,IAAI,CAACC,SAAS,CAACT,IAAI;MAC3B,CAAC,CAAC;MAEF,IAAI,CAACG,IAAI,CAACO,EAAE,EAAE;QACZ,MAAMC,GAAG,GAAG,MAAMR,IAAI,CAACS,IAAI,CAAC,CAAC;QAC7B,MAAM,IAAIb,KAAK,CAAC,mBAAmBI,IAAI,CAACU,MAAM,MAAMF,GAAG,EAAE,CAAC;MAC5D;MAEA,MAAMG,IAAI,GAAG,MAAMX,IAAI,CAACY,IAAI,CAAC,CAAC;MAC9B,OAAOD,IAAI,CAACE,MAAM,GAAG,CAAC,CAAC,EAAEC,OAAO,IAAIH,IAAI,CAACI,WAAW,IAAIJ,IAAI,CAACK,OAAO,GAAG,CAAC,CAAC,EAAEP,IAAI,IAAIE,IAAI,CAACK,OAAO,GAAG,CAAC,CAAC,EAAEC,OAAO,EAAEH,OAAO,IAAIH,IAAI,CAACO,MAAM,IAAIb,IAAI,CAACC,SAAS,CAACK,IAAI,CAAC;IAC/J;;IAEA;IACA,MAAMQ,QAAQ,GAAG,CACf;MAAEC,IAAI,EAAE,QAAQ;MAAEN,OAAO,EAAE;IAAkH,CAAC,EAC9I;MAAEM,IAAI,EAAE,MAAM;MAAEN,OAAO,EAAEpB;IAAO,CAAC,CAClC;IAED,MAAMM,IAAI,GAAG,MAAMC,KAAK,CAAC,IAAI,CAACb,SAAS,EAAE;MACvCc,MAAM,EAAE,MAAM;MACdC,OAAO,EAAE;QACP,cAAc,EAAE,kBAAkB;QAClCC,aAAa,EAAE,UAAU,IAAI,CAACjB,SAAS;MACzC,CAAC;MACDU,IAAI,EAAEQ,IAAI,CAACC,SAAS,CAAC;QAAEP,KAAK,EAAEJ,OAAO,CAACI,KAAK,IAAI,eAAe;QAAEoB,QAAQ;QAAEE,WAAW,EAAE1B,OAAO,CAAC0B,WAAW,IAAI,GAAG;QAAEC,UAAU,EAAE3B,OAAO,CAAC2B,UAAU,IAAI;MAAK,CAAC;IAC7J,CAAC,CAAC;IAEF,IAAI,CAACtB,IAAI,CAACO,EAAE,EAAE;MACZ,MAAMgB,SAAS,GAAG,MAAMvB,IAAI,CAACY,IAAI,CAAC,CAAC,CAACY,KAAK,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC;MACrD,MAAM,IAAI5B,KAAK,CAAC,qBAAqBI,IAAI,CAACU,MAAM,MAAMa,SAAS,CAACE,KAAK,EAAER,OAAO,IAAI,mBAAmB,EAAE,CAAC;IAC1G;IAEA,MAAMN,IAAI,GAAG,MAAMX,IAAI,CAACY,IAAI,CAAC,CAAC;IAC9B,OAAOD,IAAI,CAACK,OAAO,GAAG,CAAC,CAAC,EAAEC,OAAO,EAAEH,OAAO,IAAIH,IAAI,CAACK,OAAO,GAAG,CAAC,CAAC,EAAEP,IAAI,IAAIJ,IAAI,CAACC,SAAS,CAACK,IAAI,CAAC;EAC/F;EAEA,MAAMe,oBAAoBA,CAACC,KAAK,EAAE;IAChC,IAAI,CAAC,IAAI,CAACnC,WAAW,EAAE;MACrB,MAAM,IAAII,KAAK,CAAC,8EAA8E,CAAC;IACjG;IAEA,MAAMF,MAAM,GAAG;AACnB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAEiC,KAAK,EAAE;IAEL,MAAMb,OAAO,GAAG,MAAM,IAAI,CAACrB,UAAU,CAACC,MAAM,EAAE;MAAE2B,WAAW,EAAE,GAAG;MAAEC,UAAU,EAAE;IAAK,CAAC,CAAC;;IAErF;IACA,MAAMM,SAAS,GAAG,CAACd,OAAO,IAAI,EAAE,EAAEe,KAAK,CAAC,0BAA0B,CAAC,IAAI,CAACf,OAAO,IAAI,EAAE,EAAEe,KAAK,CAAC,WAAW,CAAC;IACzG,IAAIC,QAAQ;IAEZ,IAAIF,SAAS,EAAE;MACbE,QAAQ,GAAGF,SAAS,CAAC,CAAC,CAAC,CAACG,OAAO,CAAC,kBAAkB,EAAE,EAAE,CAAC;IACzD,CAAC,MAAM;MACL,MAAMC,SAAS,GAAG,CAAClB,OAAO,IAAI,EAAE,EAAEmB,OAAO,CAAC,GAAG,CAAC;MAC9C,MAAMC,OAAO,GAAG,CAACpB,OAAO,IAAI,EAAE,EAAEqB,WAAW,CAAC,GAAG,CAAC;MAChD,IAAIH,SAAS,KAAK,CAAC,CAAC,IAAIE,OAAO,KAAK,CAAC,CAAC,EAAE;QACtCJ,QAAQ,GAAG,CAAChB,OAAO,IAAI,EAAE,EAAEsB,SAAS,CAACJ,SAAS,EAAEE,OAAO,GAAG,CAAC,CAAC;MAC9D,CAAC,MAAM;QACL,MAAM,IAAItC,KAAK,CAAC,qCAAqC,CAAC;MACxD;IACF;IAEA,OAAOS,IAAI,CAACgC,KAAK,CAACP,QAAQ,CAAC;EAC7B;EAEA,MAAMQ,iBAAiBA,CAACC,OAAO,EAAEC,eAAe,GAAG,EAAE,EAAE;IACrD,IAAI,CAAC,IAAI,CAAChD,WAAW,EAAE;MACrB,OAAO,IAAI;IACb;IAEA,MAAMiD,OAAO,GAAG;MACdC,QAAQ,EAAE,wKAAwK;MAClLC,OAAO,EAAE,iKAAiK;MAC1KC,iBAAiB,EAAE,kIAAkI;MACrJC,SAAS,EAAE;IACb,CAAC;IAED,MAAMC,UAAU,GAAGL,OAAO,CAACF,OAAO,CAAC,IAAI,wEAAwE;IAE/G,IAAI;MACF,MAAM7C,MAAM,GAAG,GAAGoD,UAAU,4CAA4CN,eAAe,EAAE;MACzF,MAAM1B,OAAO,GAAG,MAAM,IAAI,CAACrB,UAAU,CAACC,MAAM,EAAE;QAAE2B,WAAW,EAAE,GAAG;QAAEC,UAAU,EAAE;MAAI,CAAC,CAAC;MACpF,OAAOR,OAAO;IAChB,CAAC,CAAC,OAAOW,KAAK,EAAE;MACdsB,OAAO,CAACtB,KAAK,CAAC,oCAAoC,EAAEA,KAAK,CAAC;MAC1D,OAAO,IAAI;IACb;EACF;EAEA,MAAMuB,yBAAyBA,CAACrB,KAAK,EAAE;IACrC,IAAI,CAAC,IAAI,CAACnC,WAAW,IAAI,CAACmC,KAAK,CAACsB,IAAI,CAAC,CAAC,EAAE;MACtC,OAAOtB,KAAK;IACd;IAEA,IAAI;MACF,MAAMjC,MAAM,GAAG,2dAA2diC,KAAK,EAAE;MACjf,MAAMb,OAAO,GAAG,MAAM,IAAI,CAACrB,UAAU,CAACC,MAAM,EAAE;QAAE2B,WAAW,EAAE,GAAG;QAAEC,UAAU,EAAE;MAAK,CAAC,CAAC;MACrF,OAAOR,OAAO,IAAIa,KAAK;IACzB,CAAC,CAAC,OAAOF,KAAK,EAAE;MACdsB,OAAO,CAACtB,KAAK,CAAC,2BAA2B,EAAEA,KAAK,CAAC;MACjD,OAAOE,KAAK;IACd;EACF;;EAEA;EACA,MAAMuB,qBAAqBA,CAACvB,KAAK,EAAE;IACjC,IAAI,CAAC,IAAI,CAACnC,WAAW,IAAI,CAACmC,KAAK,CAACsB,IAAI,CAAC,CAAC,EAAE;MACtC,OAAO,EAAE;IACX;IAEA,IAAI;MACF,MAAMvD,MAAM,GAAG,+IAA+IiC,KAAK,EAAE;MACrK,MAAMb,OAAO,GAAG,MAAM,IAAI,CAACrB,UAAU,CAACC,MAAM,EAAE;QAAE2B,WAAW,EAAE,GAAG;QAAEC,UAAU,EAAE;MAAI,CAAC,CAAC;MACpF,MAAMM,SAAS,GAAG,CAACd,OAAO,IAAI,EAAE,EAAEe,KAAK,CAAC,WAAW,CAAC;MACpD,IAAID,SAAS,EAAE;QACb,OAAOvB,IAAI,CAACgC,KAAK,CAACT,SAAS,CAAC,CAAC,CAAC,CAAC,CAACuB,OAAO,IAAI,EAAE;MAC/C;MACA,OAAO,EAAE;IACX,CAAC,CAAC,OAAO1B,KAAK,EAAE;MACdsB,OAAO,CAACtB,KAAK,CAAC,+BAA+B,EAAEA,KAAK,CAAC;MACrD,OAAO,EAAE;IACX;EACF;AACF;;AAEA;AACA,OAAO,MAAM2B,SAAS,GAAG,IAAIrE,SAAS,CAAC,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}