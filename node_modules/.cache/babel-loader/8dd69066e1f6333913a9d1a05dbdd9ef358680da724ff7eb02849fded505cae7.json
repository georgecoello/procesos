{"ast":null,"code":"import \"core-js/modules/es.iterator.constructor.js\";\nimport \"core-js/modules/es.iterator.flat-map.js\";\nimport \"core-js/modules/es.iterator.for-each.js\";\n// src/Editor.ts\nimport { Editor as CoreEditor } from \"@tiptap/core\";\nimport { customRef, markRaw } from \"vue\";\nfunction useDebouncedRef(value) {\n  return customRef((track, trigger) => {\n    return {\n      get() {\n        track();\n        return value;\n      },\n      set(newValue) {\n        value = newValue;\n        requestAnimationFrame(() => {\n          requestAnimationFrame(() => {\n            trigger();\n          });\n        });\n      }\n    };\n  });\n}\nvar Editor = class extends CoreEditor {\n  constructor(options = {}) {\n    super(options);\n    this.contentComponent = null;\n    this.appContext = null;\n    this.reactiveState = useDebouncedRef(this.view.state);\n    this.reactiveExtensionStorage = useDebouncedRef(this.extensionStorage);\n    this.on(\"beforeTransaction\", ({\n      nextState\n    }) => {\n      this.reactiveState.value = nextState;\n      this.reactiveExtensionStorage.value = this.extensionStorage;\n    });\n    return markRaw(this);\n  }\n  get state() {\n    return this.reactiveState ? this.reactiveState.value : this.view.state;\n  }\n  get storage() {\n    return this.reactiveExtensionStorage ? this.reactiveExtensionStorage.value : super.storage;\n  }\n  /**\n   * Register a ProseMirror plugin.\n   */\n  registerPlugin(plugin, handlePlugins) {\n    const nextState = super.registerPlugin(plugin, handlePlugins);\n    if (this.reactiveState) {\n      this.reactiveState.value = nextState;\n    }\n    return nextState;\n  }\n  /**\n   * Unregister a ProseMirror plugin.\n   */\n  unregisterPlugin(nameOrPluginKey) {\n    const nextState = super.unregisterPlugin(nameOrPluginKey);\n    if (this.reactiveState && nextState) {\n      this.reactiveState.value = nextState;\n    }\n    return nextState;\n  }\n};\n\n// src/EditorContent.ts\nimport { defineComponent, getCurrentInstance, h, nextTick, onBeforeUnmount, ref, unref, watchEffect } from \"vue\";\nvar EditorContent = defineComponent({\n  name: \"EditorContent\",\n  props: {\n    editor: {\n      default: null,\n      type: Object\n    }\n  },\n  setup(props) {\n    const rootEl = ref();\n    const instance = getCurrentInstance();\n    watchEffect(() => {\n      const editor = props.editor;\n      if (editor && editor.options.element && rootEl.value) {\n        nextTick(() => {\n          var _a;\n          if (!rootEl.value || !((_a = editor.view.dom) == null ? void 0 : _a.firstChild)) {\n            return;\n          }\n          const element = unref(rootEl.value);\n          rootEl.value.append(editor.view.dom);\n          editor.contentComponent = instance.ctx._;\n          if (instance) {\n            editor.appContext = {\n              ...instance.appContext,\n              // Vue internally uses prototype chain to forward/shadow injects across the entire component chain\n              // so don't use object spread operator or 'Object.assign' and just set `provides` as is on editor's appContext\n              // @ts-expect-error forward instance's 'provides' into appContext\n              provides: instance.provides\n            };\n          }\n          editor.setOptions({\n            element\n          });\n          editor.createNodeViews();\n        });\n      }\n    });\n    onBeforeUnmount(() => {\n      const editor = props.editor;\n      if (!editor) {\n        return;\n      }\n      editor.contentComponent = null;\n      editor.appContext = null;\n    });\n    return {\n      rootEl\n    };\n  },\n  render() {\n    return h(\"div\", {\n      ref: el => {\n        this.rootEl = el;\n      }\n    });\n  }\n});\n\n// src/NodeViewContent.ts\nimport { defineComponent as defineComponent2, h as h2 } from \"vue\";\nvar NodeViewContent = defineComponent2({\n  name: \"NodeViewContent\",\n  props: {\n    as: {\n      type: String,\n      default: \"div\"\n    }\n  },\n  render() {\n    return h2(this.as, {\n      style: {\n        whiteSpace: \"pre-wrap\"\n      },\n      \"data-node-view-content\": \"\"\n    });\n  }\n});\n\n// src/NodeViewWrapper.ts\nimport { defineComponent as defineComponent3, h as h3 } from \"vue\";\nvar NodeViewWrapper = defineComponent3({\n  name: \"NodeViewWrapper\",\n  props: {\n    as: {\n      type: String,\n      default: \"div\"\n    }\n  },\n  inject: [\"onDragStart\", \"decorationClasses\"],\n  render() {\n    var _a, _b;\n    return h3(this.as, {\n      // @ts-ignore\n      class: this.decorationClasses,\n      style: {\n        whiteSpace: \"normal\"\n      },\n      \"data-node-view-wrapper\": \"\",\n      // @ts-ignore (https://github.com/vuejs/vue-next/issues/3031)\n      onDragstart: this.onDragStart\n    }, (_b = (_a = this.$slots).default) == null ? void 0 : _b.call(_a));\n  }\n});\n\n// src/useEditor.ts\nimport { onBeforeUnmount as onBeforeUnmount2, onMounted, shallowRef } from \"vue\";\nvar useEditor = (options = {}) => {\n  const editor = shallowRef();\n  onMounted(() => {\n    editor.value = new Editor(options);\n  });\n  onBeforeUnmount2(() => {\n    var _a, _b, _c;\n    const nodes = (_a = editor.value) == null ? void 0 : _a.view.dom;\n    const newEl = nodes == null ? void 0 : nodes.cloneNode(true);\n    (_b = nodes == null ? void 0 : nodes.parentNode) == null ? void 0 : _b.replaceChild(newEl, nodes);\n    (_c = editor.value) == null ? void 0 : _c.destroy();\n  });\n  return editor;\n};\n\n// src/VueMarkViewRenderer.ts\nimport { MarkView } from \"@tiptap/core\";\nimport { defineComponent as defineComponent4, h as h5, toRaw } from \"vue\";\n\n// src/VueRenderer.ts\nimport { h as h4, markRaw as markRaw2, reactive, render } from \"vue\";\nvar VueRenderer = class {\n  constructor(component, {\n    props = {},\n    editor\n  }) {\n    this.editor = editor;\n    this.component = markRaw2(component);\n    this.el = document.createElement(\"div\");\n    this.props = reactive(props);\n    this.renderedComponent = this.renderComponent();\n  }\n  get element() {\n    return this.renderedComponent.el;\n  }\n  get ref() {\n    var _a, _b, _c, _d;\n    if ((_b = (_a = this.renderedComponent.vNode) == null ? void 0 : _a.component) == null ? void 0 : _b.exposed) {\n      return this.renderedComponent.vNode.component.exposed;\n    }\n    return (_d = (_c = this.renderedComponent.vNode) == null ? void 0 : _c.component) == null ? void 0 : _d.proxy;\n  }\n  renderComponent() {\n    let vNode = h4(this.component, this.props);\n    if (this.editor.appContext) {\n      vNode.appContext = this.editor.appContext;\n    }\n    if (typeof document !== \"undefined\" && this.el) {\n      render(vNode, this.el);\n    }\n    const destroy = () => {\n      if (this.el) {\n        render(null, this.el);\n      }\n      this.el = null;\n      vNode = null;\n    };\n    return {\n      vNode,\n      destroy,\n      el: this.el ? this.el.firstElementChild : null\n    };\n  }\n  updateProps(props = {}) {\n    Object.entries(props).forEach(([key, value]) => {\n      this.props[key] = value;\n    });\n    this.renderComponent();\n  }\n  destroy() {\n    this.renderedComponent.destroy();\n  }\n};\n\n// src/VueMarkViewRenderer.ts\nvar markViewProps = {\n  editor: {\n    type: Object,\n    required: true\n  },\n  mark: {\n    type: Object,\n    required: true\n  },\n  extension: {\n    type: Object,\n    required: true\n  },\n  inline: {\n    type: Boolean,\n    required: true\n  },\n  view: {\n    type: Object,\n    required: true\n  },\n  updateAttributes: {\n    type: Function,\n    required: true\n  },\n  HTMLAttributes: {\n    type: Object,\n    required: true\n  }\n};\nvar MarkViewContent = defineComponent4({\n  name: \"MarkViewContent\",\n  props: {\n    as: {\n      type: String,\n      default: \"span\"\n    }\n  },\n  render() {\n    return h5(this.as, {\n      style: {\n        whiteSpace: \"inherit\"\n      },\n      \"data-mark-view-content\": \"\"\n    });\n  }\n});\nvar VueMarkView = class extends MarkView {\n  constructor(component, props, options) {\n    super(component, props, options);\n    const componentProps = {\n      ...props,\n      updateAttributes: this.updateAttributes.bind(this)\n    };\n    const extendedComponent = defineComponent4({\n      extends: {\n        ...component\n      },\n      props: Object.keys(componentProps),\n      template: this.component.template,\n      setup: reactiveProps => {\n        var _a;\n        return (_a = component.setup) == null ? void 0 : _a.call(component, reactiveProps, {\n          expose: () => void 0\n        });\n      },\n      // Add support for scoped styles\n      __scopeId: component.__scopeId,\n      __cssModules: component.__cssModules,\n      __name: component.__name,\n      __file: component.__file\n    });\n    this.renderer = new VueRenderer(extendedComponent, {\n      editor: this.editor,\n      props: componentProps\n    });\n  }\n  get dom() {\n    return this.renderer.element;\n  }\n  get contentDOM() {\n    return this.dom.querySelector(\"[data-mark-view-content]\");\n  }\n  updateAttributes(attrs) {\n    const unproxiedMark = toRaw(this.mark);\n    super.updateAttributes(attrs, unproxiedMark);\n  }\n  destroy() {\n    this.renderer.destroy();\n  }\n};\nfunction VueMarkViewRenderer(component, options = {}) {\n  return props => {\n    if (!props.editor.contentComponent) {\n      return {};\n    }\n    return new VueMarkView(component, props, options);\n  };\n}\n\n// src/VueNodeViewRenderer.ts\nimport { NodeView } from \"@tiptap/core\";\nimport { defineComponent as defineComponent5, provide, ref as ref2 } from \"vue\";\nvar nodeViewProps = {\n  editor: {\n    type: Object,\n    required: true\n  },\n  node: {\n    type: Object,\n    required: true\n  },\n  decorations: {\n    type: Object,\n    required: true\n  },\n  selected: {\n    type: Boolean,\n    required: true\n  },\n  extension: {\n    type: Object,\n    required: true\n  },\n  getPos: {\n    type: Function,\n    required: true\n  },\n  updateAttributes: {\n    type: Function,\n    required: true\n  },\n  deleteNode: {\n    type: Function,\n    required: true\n  },\n  view: {\n    type: Object,\n    required: true\n  },\n  innerDecorations: {\n    type: Object,\n    required: true\n  },\n  HTMLAttributes: {\n    type: Object,\n    required: true\n  }\n};\nvar VueNodeView = class extends NodeView {\n  mount() {\n    const props = {\n      editor: this.editor,\n      node: this.node,\n      decorations: this.decorations,\n      innerDecorations: this.innerDecorations,\n      view: this.view,\n      selected: false,\n      extension: this.extension,\n      HTMLAttributes: this.HTMLAttributes,\n      getPos: () => this.getPos(),\n      updateAttributes: (attributes = {}) => this.updateAttributes(attributes),\n      deleteNode: () => this.deleteNode()\n    };\n    const onDragStart = this.onDragStart.bind(this);\n    this.decorationClasses = ref2(this.getDecorationClasses());\n    const extendedComponent = defineComponent5({\n      extends: {\n        ...this.component\n      },\n      props: Object.keys(props),\n      template: this.component.template,\n      setup: reactiveProps => {\n        var _a, _b;\n        provide(\"onDragStart\", onDragStart);\n        provide(\"decorationClasses\", this.decorationClasses);\n        return (_b = (_a = this.component).setup) == null ? void 0 : _b.call(_a, reactiveProps, {\n          expose: () => void 0\n        });\n      },\n      // add support for scoped styles\n      // @ts-ignore\n      // eslint-disable-next-line\n      __scopeId: this.component.__scopeId,\n      // add support for CSS Modules\n      // @ts-ignore\n      // eslint-disable-next-line\n      __cssModules: this.component.__cssModules,\n      // add support for vue devtools\n      // @ts-ignore\n      // eslint-disable-next-line\n      __name: this.component.__name,\n      // @ts-ignore\n      // eslint-disable-next-line\n      __file: this.component.__file\n    });\n    this.handleSelectionUpdate = this.handleSelectionUpdate.bind(this);\n    this.editor.on(\"selectionUpdate\", this.handleSelectionUpdate);\n    this.renderer = new VueRenderer(extendedComponent, {\n      editor: this.editor,\n      props\n    });\n  }\n  /**\n   * Return the DOM element.\n   * This is the element that will be used to display the node view.\n   */\n  get dom() {\n    if (!this.renderer.element || !this.renderer.element.hasAttribute(\"data-node-view-wrapper\")) {\n      throw Error(\"Please use the NodeViewWrapper component for your node view.\");\n    }\n    return this.renderer.element;\n  }\n  /**\n   * Return the content DOM element.\n   * This is the element that will be used to display the rich-text content of the node.\n   */\n  get contentDOM() {\n    if (this.node.isLeaf) {\n      return null;\n    }\n    return this.dom.querySelector(\"[data-node-view-content]\");\n  }\n  /**\n   * On editor selection update, check if the node is selected.\n   * If it is, call `selectNode`, otherwise call `deselectNode`.\n   */\n  handleSelectionUpdate() {\n    const {\n      from,\n      to\n    } = this.editor.state.selection;\n    const pos = this.getPos();\n    if (typeof pos !== \"number\") {\n      return;\n    }\n    if (from <= pos && to >= pos + this.node.nodeSize) {\n      if (this.renderer.props.selected) {\n        return;\n      }\n      this.selectNode();\n    } else {\n      if (!this.renderer.props.selected) {\n        return;\n      }\n      this.deselectNode();\n    }\n  }\n  /**\n   * On update, update the React component.\n   * To prevent unnecessary updates, the `update` option can be used.\n   */\n  update(node, decorations, innerDecorations) {\n    const rerenderComponent = props => {\n      this.decorationClasses.value = this.getDecorationClasses();\n      this.renderer.updateProps(props);\n    };\n    if (typeof this.options.update === \"function\") {\n      const oldNode = this.node;\n      const oldDecorations = this.decorations;\n      const oldInnerDecorations = this.innerDecorations;\n      this.node = node;\n      this.decorations = decorations;\n      this.innerDecorations = innerDecorations;\n      return this.options.update({\n        oldNode,\n        oldDecorations,\n        newNode: node,\n        newDecorations: decorations,\n        oldInnerDecorations,\n        innerDecorations,\n        updateProps: () => rerenderComponent({\n          node,\n          decorations,\n          innerDecorations\n        })\n      });\n    }\n    if (node.type !== this.node.type) {\n      return false;\n    }\n    if (node === this.node && this.decorations === decorations && this.innerDecorations === innerDecorations) {\n      return true;\n    }\n    this.node = node;\n    this.decorations = decorations;\n    this.innerDecorations = innerDecorations;\n    rerenderComponent({\n      node,\n      decorations,\n      innerDecorations\n    });\n    return true;\n  }\n  /**\n   * Select the node.\n   * Add the `selected` prop and the `ProseMirror-selectednode` class.\n   */\n  selectNode() {\n    this.renderer.updateProps({\n      selected: true\n    });\n    if (this.renderer.element) {\n      this.renderer.element.classList.add(\"ProseMirror-selectednode\");\n    }\n  }\n  /**\n   * Deselect the node.\n   * Remove the `selected` prop and the `ProseMirror-selectednode` class.\n   */\n  deselectNode() {\n    this.renderer.updateProps({\n      selected: false\n    });\n    if (this.renderer.element) {\n      this.renderer.element.classList.remove(\"ProseMirror-selectednode\");\n    }\n  }\n  getDecorationClasses() {\n    return this.decorations.flatMap(item => item.type.attrs.class).join(\" \");\n  }\n  destroy() {\n    this.renderer.destroy();\n    this.editor.off(\"selectionUpdate\", this.handleSelectionUpdate);\n  }\n};\nfunction VueNodeViewRenderer(component, options) {\n  return props => {\n    if (!props.editor.contentComponent) {\n      return {};\n    }\n    const normalizedComponent = typeof component === \"function\" && \"__vccOpts\" in component ? component.__vccOpts : component;\n    return new VueNodeView(normalizedComponent, props, options);\n  };\n}\n\n// src/index.ts\nexport * from \"@tiptap/core\";\nexport { Editor, EditorContent, MarkViewContent, NodeViewContent, NodeViewWrapper, VueMarkView, VueMarkViewRenderer, VueNodeViewRenderer, VueRenderer, markViewProps, nodeViewProps, useEditor };","map":{"version":3,"names":["Editor","CoreEditor","customRef","markRaw","useDebouncedRef","value","track","trigger","get","set","newValue","requestAnimationFrame","constructor","options","contentComponent","appContext","reactiveState","view","state","reactiveExtensionStorage","extensionStorage","on","nextState","storage","registerPlugin","plugin","handlePlugins","unregisterPlugin","nameOrPluginKey","defineComponent","getCurrentInstance","h","nextTick","onBeforeUnmount","ref","unref","watchEffect","EditorContent","name","props","editor","default","type","Object","setup","rootEl","instance","element","_a","dom","firstChild","append","ctx","_","provides","setOptions","createNodeViews","render","el","defineComponent2","h2","NodeViewContent","as","String","style","whiteSpace","defineComponent3","h3","NodeViewWrapper","inject","_b","class","decorationClasses","onDragstart","onDragStart","$slots","call","onBeforeUnmount2","onMounted","shallowRef","useEditor","_c","nodes","newEl","cloneNode","parentNode","replaceChild","destroy","MarkView","defineComponent4","h5","toRaw","h4","markRaw2","reactive","VueRenderer","component","document","createElement","renderedComponent","renderComponent","_d","vNode","exposed","proxy","firstElementChild","updateProps","entries","forEach","key","markViewProps","required","mark","extension","inline","Boolean","updateAttributes","Function","HTMLAttributes","MarkViewContent","VueMarkView","componentProps","bind","extendedComponent","extends","keys","template","reactiveProps","expose","__scopeId","__cssModules","__name","__file","renderer","contentDOM","querySelector","attrs","unproxiedMark","VueMarkViewRenderer","NodeView","defineComponent5","provide","ref2","nodeViewProps","node","decorations","selected","getPos","deleteNode","innerDecorations","VueNodeView","mount","attributes","getDecorationClasses","handleSelectionUpdate","hasAttribute","Error","isLeaf","from","to","selection","pos","nodeSize","selectNode","deselectNode","update","rerenderComponent","oldNode","oldDecorations","oldInnerDecorations","newNode","newDecorations","classList","add","remove","flatMap","item","join","off","VueNodeViewRenderer","normalizedComponent","__vccOpts"],"sources":["../src/Editor.ts","../src/EditorContent.ts","../src/NodeViewContent.ts","../src/NodeViewWrapper.ts","../src/useEditor.ts","../src/VueMarkViewRenderer.ts","../src/VueRenderer.ts","../src/VueNodeViewRenderer.ts","../src/index.ts"],"sourcesContent":["/* eslint-disable react-hooks/rules-of-hooks */\nimport type { EditorOptions, Storage } from '@tiptap/core'\nimport { Editor as CoreEditor } from '@tiptap/core'\nimport type { EditorState, Plugin, PluginKey } from '@tiptap/pm/state'\nimport type { AppContext, ComponentInternalInstance, ComponentPublicInstance, Ref } from 'vue'\nimport { customRef, markRaw } from 'vue'\n\nfunction useDebouncedRef<T>(value: T) {\n  return customRef<T>((track, trigger) => {\n    return {\n      get() {\n        track()\n        return value\n      },\n      set(newValue) {\n        // update state\n        value = newValue\n\n        // update view as soon as possible\n        requestAnimationFrame(() => {\n          requestAnimationFrame(() => {\n            trigger()\n          })\n        })\n      },\n    }\n  })\n}\n\nexport type ContentComponent = ComponentInternalInstance & {\n  ctx: ComponentPublicInstance\n}\n\nexport class Editor extends CoreEditor {\n  private reactiveState: Ref<EditorState>\n\n  private reactiveExtensionStorage: Ref<Storage>\n\n  public contentComponent: ContentComponent | null = null\n\n  public appContext: AppContext | null = null\n\n  constructor(options: Partial<EditorOptions> = {}) {\n    super(options)\n\n    this.reactiveState = useDebouncedRef(this.view.state)\n    this.reactiveExtensionStorage = useDebouncedRef(this.extensionStorage)\n\n    this.on('beforeTransaction', ({ nextState }) => {\n      this.reactiveState.value = nextState\n      this.reactiveExtensionStorage.value = this.extensionStorage\n    })\n\n    return markRaw(this) // eslint-disable-line\n  }\n\n  get state() {\n    return this.reactiveState ? this.reactiveState.value : this.view.state\n  }\n\n  get storage() {\n    return this.reactiveExtensionStorage ? this.reactiveExtensionStorage.value : super.storage\n  }\n\n  /**\n   * Register a ProseMirror plugin.\n   */\n  public registerPlugin(\n    plugin: Plugin,\n    handlePlugins?: (newPlugin: Plugin, plugins: Plugin[]) => Plugin[],\n  ): EditorState {\n    const nextState = super.registerPlugin(plugin, handlePlugins)\n\n    if (this.reactiveState) {\n      this.reactiveState.value = nextState\n    }\n\n    return nextState\n  }\n\n  /**\n   * Unregister a ProseMirror plugin.\n   */\n  public unregisterPlugin(nameOrPluginKey: string | PluginKey): EditorState | undefined {\n    const nextState = super.unregisterPlugin(nameOrPluginKey)\n\n    if (this.reactiveState && nextState) {\n      this.reactiveState.value = nextState\n    }\n\n    return nextState\n  }\n}\n","import type { PropType, Ref } from 'vue'\nimport { defineComponent, getCurrentInstance, h, nextTick, onBeforeUnmount, ref, unref, watchEffect } from 'vue'\n\nimport type { Editor } from './Editor.js'\n\nexport const EditorContent = defineComponent({\n  name: 'EditorContent',\n\n  props: {\n    editor: {\n      default: null,\n      type: Object as PropType<Editor>,\n    },\n  },\n\n  setup(props) {\n    const rootEl: Ref<Element | undefined> = ref()\n    const instance = getCurrentInstance()\n\n    watchEffect(() => {\n      const editor = props.editor\n\n      if (editor && editor.options.element && rootEl.value) {\n        nextTick(() => {\n          if (!rootEl.value || !editor.view.dom?.firstChild) {\n            return\n          }\n\n          // TODO using the new editor.mount method might allow us to remove this\n          const element = unref(rootEl.value)\n\n          rootEl.value.append(editor.view.dom)\n\n          // @ts-ignore\n          editor.contentComponent = instance.ctx._\n\n          if (instance) {\n            editor.appContext = {\n              ...instance.appContext,\n              // Vue internally uses prototype chain to forward/shadow injects across the entire component chain\n              // so don't use object spread operator or 'Object.assign' and just set `provides` as is on editor's appContext\n              // @ts-expect-error forward instance's 'provides' into appContext\n              provides: instance.provides,\n            }\n          }\n\n          editor.setOptions({\n            element,\n          })\n\n          editor.createNodeViews()\n        })\n      }\n    })\n\n    onBeforeUnmount(() => {\n      const editor = props.editor\n\n      if (!editor) {\n        return\n      }\n\n      editor.contentComponent = null\n      editor.appContext = null\n    })\n\n    return { rootEl }\n  },\n\n  render() {\n    return h('div', {\n      ref: (el: any) => {\n        this.rootEl = el\n      },\n    })\n  },\n})\n","import { defineComponent, h } from 'vue'\n\nexport const NodeViewContent = defineComponent({\n  name: 'NodeViewContent',\n\n  props: {\n    as: {\n      type: String,\n      default: 'div',\n    },\n  },\n\n  render() {\n    return h(this.as, {\n      style: {\n        whiteSpace: 'pre-wrap',\n      },\n      'data-node-view-content': '',\n    })\n  },\n})\n","import { defineComponent, h } from 'vue'\n\nexport const NodeViewWrapper = defineComponent({\n  name: 'NodeViewWrapper',\n\n  props: {\n    as: {\n      type: String,\n      default: 'div',\n    },\n  },\n\n  inject: ['onDragStart', 'decorationClasses'],\n\n  render() {\n    return h(\n      this.as,\n      {\n        // @ts-ignore\n        class: this.decorationClasses,\n        style: {\n          whiteSpace: 'normal',\n        },\n        'data-node-view-wrapper': '',\n        // @ts-ignore (https://github.com/vuejs/vue-next/issues/3031)\n        onDragstart: this.onDragStart,\n      },\n      this.$slots.default?.(),\n    )\n  },\n})\n","import type { EditorOptions } from '@tiptap/core'\nimport { onBeforeUnmount, onMounted, shallowRef } from 'vue'\n\nimport { Editor } from './Editor.js'\n\nexport const useEditor = (options: Partial<EditorOptions> = {}) => {\n  const editor = shallowRef<Editor>()\n\n  onMounted(() => {\n    editor.value = new Editor(options)\n  })\n\n  onBeforeUnmount(() => {\n    // Cloning root node (and its children) to avoid content being lost by destroy\n    const nodes = editor.value?.view.dom\n    const newEl = nodes?.cloneNode(true) as HTMLElement\n\n    nodes?.parentNode?.replaceChild(newEl, nodes)\n\n    editor.value?.destroy()\n  })\n\n  return editor\n}\n","/* eslint-disable no-underscore-dangle */\nimport type { MarkViewProps, MarkViewRenderer, MarkViewRendererOptions } from '@tiptap/core'\nimport { MarkView } from '@tiptap/core'\nimport type { Component, PropType } from 'vue'\nimport { defineComponent, h, toRaw } from 'vue'\n\nimport type { Editor } from './Editor.js'\nimport { VueRenderer } from './VueRenderer.js'\n\nexport interface VueMarkViewRendererOptions extends MarkViewRendererOptions {\n  as?: string\n  className?: string\n  attrs?: { [key: string]: string }\n}\n\nexport const markViewProps = {\n  editor: {\n    type: Object as PropType<MarkViewProps['editor']>,\n    required: true as const,\n  },\n  mark: {\n    type: Object as PropType<MarkViewProps['mark']>,\n    required: true as const,\n  },\n  extension: {\n    type: Object as PropType<MarkViewProps['extension']>,\n    required: true as const,\n  },\n  inline: {\n    type: Boolean as PropType<MarkViewProps['inline']>,\n    required: true as const,\n  },\n  view: {\n    type: Object as PropType<MarkViewProps['view']>,\n    required: true as const,\n  },\n  updateAttributes: {\n    type: Function as PropType<MarkViewProps['updateAttributes']>,\n    required: true as const,\n  },\n  HTMLAttributes: {\n    type: Object as PropType<MarkViewProps['HTMLAttributes']>,\n    required: true as const,\n  },\n}\n\nexport const MarkViewContent = defineComponent({\n  name: 'MarkViewContent',\n\n  props: {\n    as: {\n      type: String,\n      default: 'span',\n    },\n  },\n\n  render() {\n    return h(this.as, {\n      style: {\n        whiteSpace: 'inherit',\n      },\n      'data-mark-view-content': '',\n    })\n  },\n})\n\nexport class VueMarkView extends MarkView<Component, VueMarkViewRendererOptions> {\n  renderer: VueRenderer\n\n  constructor(component: Component, props: MarkViewProps, options?: Partial<VueMarkViewRendererOptions>) {\n    super(component, props, options)\n\n    const componentProps = { ...props, updateAttributes: this.updateAttributes.bind(this) } satisfies MarkViewProps\n\n    // Create extended component with provide\n    const extendedComponent = defineComponent({\n      extends: { ...component },\n      props: Object.keys(componentProps),\n      template: (this.component as any).template,\n      setup: reactiveProps => {\n        return (component as any).setup?.(reactiveProps, {\n          expose: () => undefined,\n        })\n      },\n      // Add support for scoped styles\n      __scopeId: (component as any).__scopeId,\n      __cssModules: (component as any).__cssModules,\n      __name: (component as any).__name,\n      __file: (component as any).__file,\n    })\n    this.renderer = new VueRenderer(extendedComponent, {\n      editor: this.editor,\n      props: componentProps,\n    })\n  }\n\n  get dom() {\n    return this.renderer.element as HTMLElement\n  }\n\n  get contentDOM() {\n    return this.dom.querySelector('[data-mark-view-content]') as HTMLElement | null\n  }\n\n  updateAttributes(attrs: Record<string, any>): void {\n    // since this.mark is now an proxy, we need to get the actual mark from it\n    const unproxiedMark = toRaw(this.mark)\n    super.updateAttributes(attrs, unproxiedMark)\n  }\n\n  destroy() {\n    this.renderer.destroy()\n  }\n}\n\nexport function VueMarkViewRenderer(\n  component: Component,\n  options: Partial<VueMarkViewRendererOptions> = {},\n): MarkViewRenderer {\n  return props => {\n    // try to get the parent component\n    // this is important for vue devtools to show the component hierarchy correctly\n    // maybe it’s `undefined` because <editor-content> isn’t rendered yet\n    if (!(props.editor as Editor).contentComponent) {\n      return {} as unknown as MarkView<any, any>\n    }\n\n    return new VueMarkView(component, props, options)\n  }\n}\n","import type { Editor } from '@tiptap/core'\nimport type { Component, DefineComponent } from 'vue'\nimport { h, markRaw, reactive, render } from 'vue'\n\nimport type { Editor as ExtendedEditor } from './Editor.js'\n\nexport interface VueRendererOptions {\n  editor: Editor\n  props?: Record<string, any>\n}\n\ntype ExtendedVNode = ReturnType<typeof h> | null\n\ninterface RenderedComponent {\n  vNode: ExtendedVNode\n  destroy: () => void\n  el: Element | null\n}\n\n/**\n * This class is used to render Vue components inside the editor.\n */\nexport class VueRenderer {\n  renderedComponent!: RenderedComponent\n\n  editor: ExtendedEditor\n\n  component: Component\n\n  el: Element | null\n\n  props: Record<string, any>\n\n  constructor(component: Component, { props = {}, editor }: VueRendererOptions) {\n    this.editor = editor as ExtendedEditor\n    this.component = markRaw(component)\n    this.el = document.createElement('div')\n    this.props = reactive(props)\n    this.renderedComponent = this.renderComponent()\n  }\n\n  get element(): Element | null {\n    return this.renderedComponent.el\n  }\n\n  get ref(): any {\n    // Composition API\n    if (this.renderedComponent.vNode?.component?.exposed) {\n      return this.renderedComponent.vNode.component.exposed\n    }\n    // Option API\n    return this.renderedComponent.vNode?.component?.proxy\n  }\n\n  renderComponent() {\n    let vNode: ExtendedVNode = h(this.component as DefineComponent, this.props)\n\n    if (this.editor.appContext) {\n      vNode.appContext = this.editor.appContext\n    }\n    if (typeof document !== 'undefined' && this.el) {\n      render(vNode, this.el)\n    }\n\n    const destroy = () => {\n      if (this.el) {\n        render(null, this.el)\n      }\n      this.el = null\n      vNode = null\n    }\n\n    return { vNode, destroy, el: this.el ? this.el.firstElementChild : null }\n  }\n\n  updateProps(props: Record<string, any> = {}): void {\n    Object.entries(props).forEach(([key, value]) => {\n      this.props[key] = value\n    })\n    this.renderComponent()\n  }\n\n  destroy(): void {\n    this.renderedComponent.destroy()\n  }\n}\n","/* eslint-disable no-underscore-dangle */\nimport type { DecorationWithType, NodeViewProps, NodeViewRenderer, NodeViewRendererOptions } from '@tiptap/core'\nimport { NodeView } from '@tiptap/core'\nimport type { Node as ProseMirrorNode } from '@tiptap/pm/model'\nimport type { Decoration, DecorationSource, NodeView as ProseMirrorNodeView } from '@tiptap/pm/view'\nimport type { Component, PropType, Ref } from 'vue'\nimport { defineComponent, provide, ref } from 'vue'\n\nimport type { Editor } from './Editor.js'\nimport { VueRenderer } from './VueRenderer.js'\n\nexport const nodeViewProps = {\n  editor: {\n    type: Object as PropType<NodeViewProps['editor']>,\n    required: true as const,\n  },\n  node: {\n    type: Object as PropType<NodeViewProps['node']>,\n    required: true as const,\n  },\n  decorations: {\n    type: Object as PropType<NodeViewProps['decorations']>,\n    required: true as const,\n  },\n  selected: {\n    type: Boolean as PropType<NodeViewProps['selected']>,\n    required: true as const,\n  },\n  extension: {\n    type: Object as PropType<NodeViewProps['extension']>,\n    required: true as const,\n  },\n  getPos: {\n    type: Function as PropType<NodeViewProps['getPos']>,\n    required: true as const,\n  },\n  updateAttributes: {\n    type: Function as PropType<NodeViewProps['updateAttributes']>,\n    required: true as const,\n  },\n  deleteNode: {\n    type: Function as PropType<NodeViewProps['deleteNode']>,\n    required: true as const,\n  },\n  view: {\n    type: Object as PropType<NodeViewProps['view']>,\n    required: true as const,\n  },\n  innerDecorations: {\n    type: Object as PropType<NodeViewProps['innerDecorations']>,\n    required: true as const,\n  },\n  HTMLAttributes: {\n    type: Object as PropType<NodeViewProps['HTMLAttributes']>,\n    required: true as const,\n  },\n}\n\nexport interface VueNodeViewRendererOptions extends NodeViewRendererOptions {\n  update:\n    | ((props: {\n        oldNode: ProseMirrorNode\n        oldDecorations: readonly Decoration[]\n        oldInnerDecorations: DecorationSource\n        newNode: ProseMirrorNode\n        newDecorations: readonly Decoration[]\n        innerDecorations: DecorationSource\n        updateProps: () => void\n      }) => boolean)\n    | null\n}\n\nclass VueNodeView extends NodeView<Component, Editor, VueNodeViewRendererOptions> {\n  renderer!: VueRenderer\n\n  decorationClasses!: Ref<string>\n\n  mount() {\n    const props = {\n      editor: this.editor,\n      node: this.node,\n      decorations: this.decorations as DecorationWithType[],\n      innerDecorations: this.innerDecorations,\n      view: this.view,\n      selected: false,\n      extension: this.extension,\n      HTMLAttributes: this.HTMLAttributes,\n      getPos: () => this.getPos(),\n      updateAttributes: (attributes = {}) => this.updateAttributes(attributes),\n      deleteNode: () => this.deleteNode(),\n    } satisfies NodeViewProps\n\n    const onDragStart = this.onDragStart.bind(this)\n\n    this.decorationClasses = ref(this.getDecorationClasses())\n\n    const extendedComponent = defineComponent({\n      extends: { ...this.component },\n      props: Object.keys(props),\n      template: (this.component as any).template,\n      setup: reactiveProps => {\n        provide('onDragStart', onDragStart)\n        provide('decorationClasses', this.decorationClasses)\n\n        return (this.component as any).setup?.(reactiveProps, {\n          expose: () => undefined,\n        })\n      },\n      // add support for scoped styles\n      // @ts-ignore\n      // eslint-disable-next-line\n      __scopeId: this.component.__scopeId,\n      // add support for CSS Modules\n      // @ts-ignore\n      // eslint-disable-next-line\n      __cssModules: this.component.__cssModules,\n      // add support for vue devtools\n      // @ts-ignore\n      // eslint-disable-next-line\n      __name: this.component.__name,\n      // @ts-ignore\n      // eslint-disable-next-line\n      __file: this.component.__file,\n    })\n\n    this.handleSelectionUpdate = this.handleSelectionUpdate.bind(this)\n    this.editor.on('selectionUpdate', this.handleSelectionUpdate)\n\n    this.renderer = new VueRenderer(extendedComponent, {\n      editor: this.editor,\n      props,\n    })\n  }\n\n  /**\n   * Return the DOM element.\n   * This is the element that will be used to display the node view.\n   */\n  get dom() {\n    if (!this.renderer.element || !this.renderer.element.hasAttribute('data-node-view-wrapper')) {\n      throw Error('Please use the NodeViewWrapper component for your node view.')\n    }\n\n    return this.renderer.element as HTMLElement\n  }\n\n  /**\n   * Return the content DOM element.\n   * This is the element that will be used to display the rich-text content of the node.\n   */\n  get contentDOM() {\n    if (this.node.isLeaf) {\n      return null\n    }\n\n    return this.dom.querySelector('[data-node-view-content]') as HTMLElement | null\n  }\n\n  /**\n   * On editor selection update, check if the node is selected.\n   * If it is, call `selectNode`, otherwise call `deselectNode`.\n   */\n  handleSelectionUpdate() {\n    const { from, to } = this.editor.state.selection\n    const pos = this.getPos()\n\n    if (typeof pos !== 'number') {\n      return\n    }\n\n    if (from <= pos && to >= pos + this.node.nodeSize) {\n      if (this.renderer.props.selected) {\n        return\n      }\n\n      this.selectNode()\n    } else {\n      if (!this.renderer.props.selected) {\n        return\n      }\n\n      this.deselectNode()\n    }\n  }\n\n  /**\n   * On update, update the React component.\n   * To prevent unnecessary updates, the `update` option can be used.\n   */\n  update(node: ProseMirrorNode, decorations: readonly Decoration[], innerDecorations: DecorationSource): boolean {\n    const rerenderComponent = (props?: Record<string, any>) => {\n      this.decorationClasses.value = this.getDecorationClasses()\n      this.renderer.updateProps(props)\n    }\n\n    if (typeof this.options.update === 'function') {\n      const oldNode = this.node\n      const oldDecorations = this.decorations\n      const oldInnerDecorations = this.innerDecorations\n\n      this.node = node\n      this.decorations = decorations\n      this.innerDecorations = innerDecorations\n\n      return this.options.update({\n        oldNode,\n        oldDecorations,\n        newNode: node,\n        newDecorations: decorations,\n        oldInnerDecorations,\n        innerDecorations,\n        updateProps: () => rerenderComponent({ node, decorations, innerDecorations }),\n      })\n    }\n\n    if (node.type !== this.node.type) {\n      return false\n    }\n\n    if (node === this.node && this.decorations === decorations && this.innerDecorations === innerDecorations) {\n      return true\n    }\n\n    this.node = node\n    this.decorations = decorations\n    this.innerDecorations = innerDecorations\n\n    rerenderComponent({ node, decorations, innerDecorations })\n\n    return true\n  }\n\n  /**\n   * Select the node.\n   * Add the `selected` prop and the `ProseMirror-selectednode` class.\n   */\n  selectNode() {\n    this.renderer.updateProps({\n      selected: true,\n    })\n    if (this.renderer.element) {\n      this.renderer.element.classList.add('ProseMirror-selectednode')\n    }\n  }\n\n  /**\n   * Deselect the node.\n   * Remove the `selected` prop and the `ProseMirror-selectednode` class.\n   */\n  deselectNode() {\n    this.renderer.updateProps({\n      selected: false,\n    })\n    if (this.renderer.element) {\n      this.renderer.element.classList.remove('ProseMirror-selectednode')\n    }\n  }\n\n  getDecorationClasses() {\n    return (\n      this.decorations\n        // @ts-ignore\n        .flatMap(item => item.type.attrs.class)\n        .join(' ')\n    )\n  }\n\n  destroy() {\n    this.renderer.destroy()\n    this.editor.off('selectionUpdate', this.handleSelectionUpdate)\n  }\n}\n\nexport function VueNodeViewRenderer(\n  component: Component<NodeViewProps>,\n  options?: Partial<VueNodeViewRendererOptions>,\n): NodeViewRenderer {\n  return props => {\n    // try to get the parent component\n    // this is important for vue devtools to show the component hierarchy correctly\n    // maybe it’s `undefined` because <editor-content> isn’t rendered yet\n    if (!(props.editor as Editor).contentComponent) {\n      return {} as unknown as ProseMirrorNodeView\n    }\n    // check for class-component and normalize if neccessary\n    const normalizedComponent =\n      typeof component === 'function' && '__vccOpts' in component ? (component.__vccOpts as Component) : component\n\n    return new VueNodeView(normalizedComponent, props, options)\n  }\n}\n","export { Editor } from './Editor.js'\nexport * from './EditorContent.js'\nexport * from './NodeViewContent.js'\nexport * from './NodeViewWrapper.js'\nexport * from './useEditor.js'\nexport * from './VueMarkViewRenderer.js'\nexport * from './VueNodeViewRenderer.js'\nexport * from './VueRenderer.js'\nexport * from '@tiptap/core'\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}