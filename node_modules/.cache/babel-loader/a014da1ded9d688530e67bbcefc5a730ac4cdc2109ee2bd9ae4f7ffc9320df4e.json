{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport \"core-js/modules/es.iterator.constructor.js\";\nimport \"core-js/modules/es.iterator.every.js\";\nimport \"core-js/modules/es.iterator.filter.js\";\nimport \"core-js/modules/es.iterator.for-each.js\";\nimport \"core-js/modules/es.iterator.map.js\";\nimport \"core-js/modules/web.url-search-params.delete.js\";\nimport \"core-js/modules/web.url-search-params.has.js\";\nimport \"core-js/modules/web.url-search-params.size.js\";\n/* eslint-disable */\nimport { Document, Packer, Paragraph, TextRun, HeadingLevel, Table, TableRow, TableCell, WidthType, AlignmentType, ShadingType, Header, LevelFormat, BorderStyle, SimpleField } from 'docx';\n\n/**\n * Genera y descarga un .docx usando la librería 'docx'.\n * Con estilos mejorados similares a la imagen de referencia\n */\nexport async function generateWordDocument(documentData = {}, procedureData = []) {\n  try {\n    const formattedDate = formatDate(documentData.headerConfig?.fecha);\n\n    // Crear el documento\n    const doc = new Document({\n      coreProperties: {\n        title: documentData.headerConfig?.policyName || 'PROCEDIMIENTO',\n        subject: 'Documento de procedimientos',\n        creator: 'Sistema',\n        description: 'Procedimiento generado automáticamente',\n        language: 'es-HN',\n        keywords: ['procedimiento', 'políticas', 'Honduras']\n      },\n      settings: {\n        language: {\n          value: 'es-HN'\n        }\n      },\n      features: {\n        updateFields: true\n      },\n      styles: {\n        paragraphStyles: [{\n          id: 'Title',\n          name: 'Título Principal',\n          basedOn: 'Normal',\n          next: 'Normal',\n          quickFormat: true,\n          run: {\n            size: 28,\n            bold: true,\n            color: '1F4E79',\n            font: 'Times New Roman'\n          },\n          paragraph: {\n            alignment: AlignmentType.CENTER,\n            spacing: {\n              before: 400,\n              after: 300\n            },\n            border: {\n              bottom: {\n                color: \"1F4E79\",\n                space: 1,\n                style: BorderStyle.SINGLE,\n                size: 8\n              }\n            }\n          }\n        }, {\n          id: 'Heading1',\n          name: 'Título 1',\n          basedOn: 'Normal',\n          next: 'Normal',\n          quickFormat: true,\n          run: {\n            size: 24,\n            bold: true,\n            color: '2C3E50',\n            font: 'Times New Roman'\n          },\n          paragraph: {\n            spacing: {\n              before: 400,\n              after: 200\n            },\n            border: {\n              bottom: {\n                color: \"D4D4D4\",\n                space: 1,\n                style: BorderStyle.SINGLE,\n                size: 2\n              }\n            }\n          }\n        }, {\n          id: 'Heading2',\n          name: 'Título 2',\n          basedOn: 'Normal',\n          next: 'Normal',\n          quickFormat: true,\n          run: {\n            size: 22,\n            bold: true,\n            color: '2C3E50',\n            font: 'Times New Roman'\n          },\n          paragraph: {\n            spacing: {\n              before: 300,\n              after: 150\n            },\n            border: {\n              bottom: {\n                color: \"E0E0E0\",\n                space: 1,\n                style: BorderStyle.SINGLE,\n                size: 1\n              }\n            }\n          }\n        }, {\n          id: 'Heading3',\n          name: 'Título 3',\n          basedOn: 'Normal',\n          next: 'Normal',\n          quickFormat: true,\n          run: {\n            size: 20,\n            bold: true,\n            color: '34495E',\n            font: 'Times New Roman'\n          },\n          paragraph: {\n            spacing: {\n              before: 200,\n              after: 100\n            }\n          }\n        }, {\n          id: 'Normal',\n          name: 'Normal',\n          basedOn: 'Normal',\n          next: 'Normal',\n          run: {\n            size: 22,\n            font: 'Times New Roman'\n          },\n          paragraph: {\n            spacing: {\n              after: 120\n            }\n          }\n        }]\n      },\n      numbering: {\n        config: [{\n          reference: 'bullet-numbering',\n          levels: [{\n            level: 0,\n            format: LevelFormat.BULLET,\n            text: '•',\n            alignment: AlignmentType.LEFT,\n            style: {\n              paragraph: {\n                indent: {\n                  left: 720,\n                  hanging: 360\n                }\n              }\n            }\n          }]\n        }, {\n          reference: 'decimal-numbering',\n          levels: [{\n            level: 0,\n            format: LevelFormat.DECIMAL,\n            text: '%1.',\n            alignment: AlignmentType.LEFT,\n            style: {\n              paragraph: {\n                indent: {\n                  left: 720,\n                  hanging: 360\n                }\n              }\n            }\n          }]\n        }, {\n          reference: 'letter-numbering',\n          levels: [{\n            level: 0,\n            format: LevelFormat.LOWER_LETTER,\n            text: '%1)',\n            alignment: AlignmentType.LEFT,\n            style: {\n              paragraph: {\n                indent: {\n                  left: 720,\n                  hanging: 360\n                }\n              }\n            }\n          }]\n        }]\n      },\n      sections: [{\n        properties: {\n          page: {\n            margin: {\n              top: 1440,\n              right: 1440,\n              bottom: 1440,\n              left: 1440\n            }\n          }\n        },\n        headers: {\n          default: new Header({\n            children: [createHeaderTable(documentData, formattedDate)]\n          })\n        },\n        children: [\n        // 1. Objetivo o Propósito\n        new Paragraph({\n          children: [new TextRun({\n            text: '1. OBJETIVO O PROPÓSITO',\n            bold: true,\n            size: 24,\n            font: 'Times New Roman',\n            color: '2C3E50'\n          })],\n          heading: HeadingLevel.HEADING_1,\n          spacing: {\n            before: 400,\n            after: 200\n          }\n        }), ...parseHtmlToParagraphs(documentData.objetivo || 'Contenido pendiente de completar.'),\n        // 2. Alcance\n        new Paragraph({\n          children: [new TextRun({\n            text: '2. ALCANCE',\n            bold: true,\n            size: 24,\n            font: 'Times New Roman',\n            color: '2C3E50'\n          })],\n          heading: HeadingLevel.HEADING_1,\n          spacing: {\n            before: 400,\n            after: 200\n          }\n        }), ...parseHtmlToParagraphs(documentData.alcance || 'Contenido pendiente de completar.'),\n        // 3. Responsabilidades\n        new Paragraph({\n          children: [new TextRun({\n            text: '3. RESPONSABILIDADES',\n            bold: true,\n            size: 24,\n            font: 'Times New Roman',\n            color: '2C3E50'\n          })],\n          heading: HeadingLevel.HEADING_1,\n          spacing: {\n            before: 400,\n            after: 200\n          }\n        }), ...parseHtmlToParagraphs(documentData.responsabilidades || 'Contenido pendiente de completar.'),\n        // 4. Normativa\n        new Paragraph({\n          children: [new TextRun({\n            text: '4. NORMATIVA',\n            bold: true,\n            size: 24,\n            font: 'Times New Roman',\n            color: '2C3E50'\n          })],\n          heading: HeadingLevel.HEADING_1,\n          spacing: {\n            before: 400,\n            after: 200\n          }\n        }), ...parseHtmlToParagraphs(documentData.normativa || 'Contenido pendiente de completar.'),\n        // 5. Procedimiento\n        new Paragraph({\n          children: [new TextRun({\n            text: '5. PROCEDIMIENTO',\n            bold: true,\n            size: 24,\n            font: 'Times New Roman',\n            color: '2C3E50'\n          })],\n          heading: HeadingLevel.HEADING_1,\n          spacing: {\n            before: 400,\n            after: 200\n          }\n        }), createProcedureTable(procedureData),\n        // 6. Anexos\n        new Paragraph({\n          children: [new TextRun({\n            text: '6. ANEXOS',\n            bold: true,\n            size: 24,\n            font: 'Times New Roman',\n            color: '2C3E50'\n          })],\n          heading: HeadingLevel.HEADING_1,\n          spacing: {\n            before: 400,\n            after: 200\n          }\n        }), ...parseHtmlToParagraphs(documentData.anexos || 'Contenido pendiente de completar.'),\n        // 7. Términos y Referencias\n        new Paragraph({\n          children: [new TextRun({\n            text: '7. TÉRMINOS Y REFERENCIAS',\n            bold: true,\n            size: 24,\n            font: 'Times New Roman',\n            color: '2C3E50'\n          })],\n          heading: HeadingLevel.HEADING_1,\n          spacing: {\n            before: 400,\n            after: 200\n          }\n        }), ...parseHtmlToParagraphs(documentData.terminos || 'Contenido pendiente de completar.')]\n      }]\n    });\n    const blob = await Packer.toBlob(doc);\n    const fileName = `${documentData.headerConfig?.policyName || 'Procedimiento'}.docx`;\n    if (window.navigator && window.navigator.msSaveOrOpenBlob) {\n      window.navigator.msSaveOrOpenBlob(blob, fileName);\n    } else {\n      const url = URL.createObjectURL(blob);\n      const link = document.createElement('a');\n      link.href = url;\n      link.download = fileName;\n      link.style.display = 'none';\n      document.body.appendChild(link);\n      link.click();\n      setTimeout(() => {\n        document.body.removeChild(link);\n        URL.revokeObjectURL(url);\n      }, 150);\n    }\n    return true;\n  } catch (error) {\n    console.error('Error generando documento Word:', error);\n    throw new Error(`Error al generar el documento: ${error.message}`);\n  }\n}\n\n// Función para crear la tabla del header con diseño mejorado y paginación dinámica\nfunction createHeaderTable(documentData, formattedDate) {\n  return new Table({\n    width: {\n      size: 100,\n      type: WidthType.PERCENTAGE\n    },\n    columnWidths: [2275, 2275, 2275, 2275],\n    borders: {\n      top: {\n        style: BorderStyle.SINGLE,\n        size: 4,\n        color: \"1F4E79\"\n      },\n      left: {\n        style: BorderStyle.SINGLE,\n        size: 4,\n        color: \"1F4E79\"\n      },\n      bottom: {\n        style: BorderStyle.SINGLE,\n        size: 4,\n        color: \"1F4E79\"\n      },\n      right: {\n        style: BorderStyle.SINGLE,\n        size: 4,\n        color: \"1F4E79\"\n      },\n      insideHorizontal: {\n        style: BorderStyle.SINGLE,\n        size: 4,\n        color: \"1F4E79\"\n      },\n      insideVertical: {\n        style: BorderStyle.SINGLE,\n        size: 4,\n        color: \"1F4E79\"\n      }\n    },\n    rows: [\n    // Primera fila: Logo, Manual, Páginas\n    new TableRow({\n      children: [\n      // Logo\n      new TableCell({\n        shading: {\n          fill: '1F4E79',\n          type: ShadingType.CLEAR\n        },\n        children: [new Paragraph({\n          alignment: AlignmentType.CENTER,\n          children: [new TextRun({\n            text: \"LOGO\",\n            bold: true,\n            size: 20,\n            font: 'Times New Roman',\n            color: 'FFFFFF'\n          })]\n        })]\n      }),\n      // Manual de Políticas y Procedimientos\n      new TableCell({\n        shading: {\n          fill: '1F4E79',\n          type: ShadingType.CLEAR\n        },\n        children: [new Paragraph({\n          alignment: AlignmentType.CENTER,\n          children: [new TextRun({\n            text: documentData.headerConfig?.manualName || 'MANUAL DE POLÍTICAS Y PROCEDIMIENTOS',\n            bold: true,\n            size: 20,\n            font: 'Times New Roman',\n            color: 'FFFFFF'\n          })]\n        })]\n      }),\n      // Páginas (ocupa 2 columnas) - USANDO CAMPOS DINÁMICOS\n      new TableCell({\n        columnSpan: 2,\n        shading: {\n          fill: '1F4E79',\n          type: ShadingType.CLEAR\n        },\n        children: [new Paragraph({\n          alignment: AlignmentType.RIGHT,\n          children: [new TextRun({\n            text: \"PÁGINA \",\n            bold: true,\n            size: 20,\n            font: 'Times New Roman',\n            color: 'FFFFFF'\n          }),\n          // Campo para número de página actual\n          new SimpleField(\"PAGE\", \"\"), new TextRun({\n            text: \" DE \",\n            bold: true,\n            size: 20,\n            font: 'Times New Roman',\n            color: 'FFFFFF'\n          }),\n          // Campo para número total de páginas\n          new SimpleField(\"NUMPAGES\", \"\")]\n        })]\n      })]\n    }),\n    // Segunda fila: Nombre del Procedimiento y Código\n    new TableRow({\n      children: [\n      // POLÍTICA O PROCEDIMIENTO DE (ocupa 2 columnas)\n      new TableCell({\n        columnSpan: 2,\n        children: [new Paragraph({\n          children: [new TextRun({\n            text: documentData.headerConfig?.policyName || 'PROCEDIMIENTO',\n            bold: true,\n            size: 22,\n            font: 'Times New Roman',\n            color: '1F4E79',\n            allCaps: true\n          })]\n        })]\n      }),\n      // CÓDIGO (ocupa 2 columnas)\n      new TableCell({\n        columnSpan: 2,\n        children: [new Paragraph({\n          alignment: AlignmentType.RIGHT,\n          children: [new TextRun({\n            text: `CÓDIGO: ${documentData.headerConfig?.codigo || 'XX-P-XXX-#'}`,\n            bold: true,\n            size: 20,\n            font: 'Times New Roman',\n            color: '1F4E79'\n          })]\n        })]\n      })]\n    }),\n    // Tercera fila: Área, Unidad, Revisión, Fecha\n    new TableRow({\n      children: [\n      // Área\n      new TableCell({\n        children: [new Paragraph({\n          children: [new TextRun({\n            text: `Área: ${documentData.headerConfig?.area || 'ÁREA RESPONSABLE'}`,\n            size: 18,\n            font: 'Times New Roman',\n            bold: true,\n            language: 'es-HN'\n          })]\n        })]\n      }),\n      // Unidad\n      new TableCell({\n        children: [new Paragraph({\n          children: [new TextRun({\n            text: `Unidad: ${documentData.headerConfig?.unidad || 'UNIDAD ESPECÍFICA'}`,\n            size: 18,\n            font: 'Times New Roman',\n            bold: true,\n            language: 'es-HN'\n          })]\n        })]\n      }),\n      // Revisión\n      new TableCell({\n        children: [new Paragraph({\n          alignment: AlignmentType.CENTER,\n          children: [new TextRun({\n            text: `Revisión: ${documentData.headerConfig?.revision || '(1)'}`,\n            size: 18,\n            font: 'Times New Roman',\n            bold: true\n          })]\n        })]\n      }),\n      // Fecha\n      new TableCell({\n        children: [new Paragraph({\n          alignment: AlignmentType.RIGHT,\n          children: [new TextRun({\n            text: `Fecha: ${formattedDate}`,\n            bold: true,\n            size: 18,\n            font: 'Times New Roman'\n          })]\n        })]\n      })]\n    })]\n  });\n}\n\n/* ---------------- Helpers ---------------- */\n\nfunction formatDate(dateInput) {\n  if (!dateInput) {\n    const today = new Date();\n    const year = today.getFullYear();\n    const month = String(today.getMonth() + 1).padStart(2, '0');\n    const day = String(today.getDate()).padStart(2, '0');\n    return `${day}-${month}-${year}`;\n  }\n  const d = new Date(dateInput);\n  const day = String(d.getDate()).padStart(2, '0');\n  const month = String(d.getMonth() + 1).padStart(2, '0');\n  const year = d.getFullYear();\n  return `${day}-${month}-${year}`;\n}\nfunction safeText(value) {\n  if (value == null) return '';\n  return String(value).replace(/\\s+/g, ' ').trim();\n}\n\n/**\n * Parsea HTML simple a Paragraphs de docx\n * Ahora soporta títulos h1, h2, h3 correctamente\n */\nfunction parseHtmlToParagraphs(html = '') {\n  const paragraphs = [];\n  if (!html) return paragraphs;\n  try {\n    // Si no hay HTML tags, procesar como texto plano\n    if (!html.includes('<') && !html.includes('>')) {\n      const lines = String(html).split(/\\n+/).map(s => safeText(s)).filter(Boolean);\n      lines.forEach(line => {\n        // Detectar si es un título por el formato (solo si no hay tags HTML)\n        if (line.startsWith('# ')) {\n          paragraphs.push(new Paragraph({\n            children: [new TextRun({\n              text: line.substring(2),\n              size: 28,\n              font: 'Times New Roman',\n              bold: true,\n              color: '1F4E79'\n            })],\n            heading: HeadingLevel.HEADING_1,\n            spacing: {\n              before: 400,\n              after: 200\n            },\n            border: {\n              bottom: {\n                color: \"1F4E79\",\n                space: 1,\n                style: BorderStyle.SINGLE,\n                size: 8\n              }\n            }\n          }));\n        } else if (line.startsWith('## ')) {\n          paragraphs.push(new Paragraph({\n            children: [new TextRun({\n              text: line.substring(3),\n              size: 24,\n              font: 'Times New Roman',\n              bold: true,\n              color: '2C3E50'\n            })],\n            heading: HeadingLevel.HEADING_2,\n            spacing: {\n              before: 300,\n              after: 150\n            },\n            border: {\n              bottom: {\n                color: \"D4D4D4\",\n                space: 1,\n                style: BorderStyle.SINGLE,\n                size: 2\n              }\n            }\n          }));\n        } else if (line.startsWith('### ')) {\n          paragraphs.push(new Paragraph({\n            children: [new TextRun({\n              text: line.substring(4),\n              size: 20,\n              font: 'Times New Roman',\n              bold: true,\n              color: '34495E'\n            })],\n            heading: HeadingLevel.HEADING_3,\n            spacing: {\n              before: 200,\n              after: 100\n            }\n          }));\n        } else {\n          paragraphs.push(new Paragraph({\n            children: [new TextRun({\n              text: line,\n              size: 22,\n              font: 'Times New Roman'\n            })],\n            spacing: {\n              after: 120\n            }\n          }));\n        }\n      });\n      return paragraphs;\n    }\n    const parser = new DOMParser();\n    const doc = parser.parseFromString(`<div>${html}</div>`, 'text/html');\n    const root = doc.body.firstElementChild || doc.body;\n    const processNode = (node, depth = 0) => {\n      if (node.nodeType === Node.TEXT_NODE) {\n        const text = safeText(node.textContent);\n        if (text && text.trim() !== '') {\n          paragraphs.push(new Paragraph({\n            children: [new TextRun({\n              text,\n              size: 22,\n              font: 'Times New Roman'\n            })],\n            spacing: {\n              after: 120\n            }\n          }));\n        }\n        return;\n      }\n      if (node.nodeType !== Node.ELEMENT_NODE) return;\n      const tag = node.tagName.toLowerCase();\n\n      // Manejar títulos\n      if (tag === 'h1' || tag === 'h2' || tag === 'h3') {\n        const text = safeText(node.textContent);\n        if (!text) return;\n        const level = parseInt(tag.substring(1));\n        if (level === 1) {\n          paragraphs.push(new Paragraph({\n            children: [new TextRun({\n              text: text,\n              size: 28,\n              font: 'Times New Roman',\n              bold: true,\n              color: '1F4E79'\n            })],\n            heading: HeadingLevel.HEADING_1,\n            spacing: {\n              before: 400,\n              after: 200\n            },\n            border: {\n              bottom: {\n                color: \"1F4E79\",\n                space: 1,\n                style: BorderStyle.SINGLE,\n                size: 8\n              }\n            }\n          }));\n        } else if (level === 2) {\n          paragraphs.push(new Paragraph({\n            children: [new TextRun({\n              text: text,\n              size: 24,\n              font: 'Times New Roman',\n              bold: true,\n              color: '2C3E50'\n            })],\n            heading: HeadingLevel.HEADING_2,\n            spacing: {\n              before: 300,\n              after: 150\n            },\n            border: {\n              bottom: {\n                color: \"D4D4D4\",\n                space: 1,\n                style: BorderStyle.SINGLE,\n                size: 2\n              }\n            }\n          }));\n        } else if (level === 3) {\n          paragraphs.push(new Paragraph({\n            children: [new TextRun({\n              text: text,\n              size: 20,\n              font: 'Times New Roman',\n              bold: true,\n              color: '34495E'\n            })],\n            heading: HeadingLevel.HEADING_3,\n            spacing: {\n              before: 200,\n              after: 100\n            }\n          }));\n        }\n      }\n      // Manejar párrafos\n      else if (tag === 'p') {\n        const text = safeText(node.textContent);\n        if (text) {\n          // Verificar si el párrafo tiene estilos en línea\n          const isBold = node.innerHTML.includes('<strong>') || node.innerHTML.includes('<b>');\n          const isItalic = node.innerHTML.includes('<em>') || node.innerHTML.includes('<i>');\n          const isUnderline = node.innerHTML.includes('<u>');\n          const textRuns = [];\n\n          // Procesar contenido del párrafo con estilos\n          const processTextContent = element => {\n            if (element.nodeType === Node.TEXT_NODE) {\n              const text = safeText(element.textContent);\n              if (text) {\n                textRuns.push(new TextRun({\n                  text,\n                  size: 22,\n                  font: 'Times New Roman'\n                }));\n              }\n            } else if (element.nodeType === Node.ELEMENT_NODE) {\n              const elemTag = element.tagName.toLowerCase();\n              const innerText = safeText(element.textContent);\n              if (elemTag === 'strong' || elemTag === 'b') {\n                textRuns.push(new TextRun({\n                  text: innerText,\n                  size: 22,\n                  font: 'Times New Roman',\n                  bold: true\n                }));\n              } else if (elemTag === 'em' || elemTag === 'i') {\n                textRuns.push(new TextRun({\n                  text: innerText,\n                  size: 22,\n                  font: 'Times New Roman',\n                  italics: true\n                }));\n              } else if (elemTag === 'u') {\n                textRuns.push(new TextRun({\n                  text: innerText,\n                  size: 22,\n                  font: 'Times New Roman',\n                  underline: {}\n                }));\n              } else if (elemTag === 'br') {\n                // Los saltos de línea se manejan automáticamente\n              } else {\n                // Para otros elementos, procesar recursivamente\n                Array.from(element.childNodes).forEach(processTextContent);\n              }\n            }\n          };\n          Array.from(node.childNodes).forEach(processTextContent);\n          paragraphs.push(new Paragraph({\n            children: textRuns.length > 0 ? textRuns : [new TextRun({\n              text,\n              size: 22,\n              font: 'Times New Roman'\n            })],\n            spacing: {\n              after: 120\n            }\n          }));\n        }\n      }\n      // Manejar listas\n      else if (tag === 'ul' || tag === 'ol') {\n        const isOrdered = tag === 'ol';\n        const outer = node.outerHTML || '';\n        const isLetter = /data-type\\s*=\\s*[\"']letter[\"']/i.test(outer);\n        const numberingRef = isLetter ? 'letter-numbering' : isOrdered ? 'decimal-numbering' : 'bullet-numbering';\n        node.querySelectorAll('li').forEach(li => {\n          const liText = safeText(li.textContent);\n          if (!liText) return;\n\n          // Procesar estilos dentro de los items de lista\n          const textRuns = [];\n          const processListItemContent = element => {\n            if (element.nodeType === Node.TEXT_NODE) {\n              const text = safeText(element.textContent);\n              if (text) {\n                textRuns.push(new TextRun({\n                  text,\n                  size: 22,\n                  font: 'Times New Roman'\n                }));\n              }\n            } else if (element.nodeType === Node.ELEMENT_NODE) {\n              const elemTag = element.tagName.toLowerCase();\n              const innerText = safeText(element.textContent);\n              if (elemTag === 'strong' || elemTag === 'b') {\n                textRuns.push(new TextRun({\n                  text: innerText,\n                  size: 22,\n                  font: 'Times New Roman',\n                  bold: true\n                }));\n              } else if (elemTag === 'em' || elemTag === 'i') {\n                textRuns.push(new TextRun({\n                  text: innerText,\n                  size: 22,\n                  font: 'Times New Roman',\n                  italics: true\n                }));\n              } else if (elemTag === 'u') {\n                textRuns.push(new TextRun({\n                  text: innerText,\n                  size: 22,\n                  font: 'Times New Roman',\n                  underline: {}\n                }));\n              } else {\n                // Para otros elementos, procesar recursivamente\n                Array.from(element.childNodes).forEach(processListItemContent);\n              }\n            }\n          };\n          Array.from(li.childNodes).forEach(processListItemContent);\n          paragraphs.push(new Paragraph({\n            children: textRuns.length > 0 ? textRuns : [new TextRun({\n              text: liText,\n              size: 22,\n              font: 'Times New Roman'\n            })],\n            numbering: {\n              reference: numberingRef,\n              level: 0\n            },\n            spacing: {\n              after: 80\n            }\n          }));\n        });\n      }\n      // Manejar saltos de línea\n      else if (tag === 'br') {\n        paragraphs.push(new Paragraph({\n          text: ''\n        }));\n      }\n      // Manejar divs y otros contenedores (procesar recursivamente)\n      else if (tag === 'div' || tag === 'span' || tag === 'section' || tag === 'article') {\n        Array.from(node.childNodes).forEach(child => processNode(child, depth + 1));\n      }\n      // Para otros elementos, extraer el texto\n      else {\n        const text = safeText(node.textContent);\n        if (text) {\n          paragraphs.push(new Paragraph({\n            children: [new TextRun({\n              text,\n              size: 22,\n              font: 'Times New Roman'\n            })],\n            spacing: {\n              after: 120\n            }\n          }));\n        }\n      }\n    };\n    Array.from(root.childNodes).forEach(node => processNode(node));\n  } catch (e) {\n    console.error('Error parsing HTML:', e);\n    // Fallback: limpiar HTML y procesar como texto plano\n    const cleaned = String(html).replace(/<br\\s*\\/?>/gi, '\\n').replace(/<[^>]+>/g, '').replace(/&nbsp;/g, ' ').replace(/&lt;/g, '<').replace(/&gt;/g, '>').replace(/&amp;/g, '&').trim();\n    if (cleaned) {\n      cleaned.split(/\\n+/).map(s => safeText(s)).filter(Boolean).forEach(t => {\n        paragraphs.push(new Paragraph({\n          children: [new TextRun({\n            text: t,\n            size: 22,\n            font: 'Times New Roman'\n          })],\n          spacing: {\n            after: 120\n          }\n        }));\n      });\n    }\n  }\n  if (paragraphs.length === 0) paragraphs.push(new Paragraph({\n    text: ''\n  }));\n  return paragraphs;\n}\n\n/**\n * Crea una tabla para el procedimiento con diseño mejorado\n */\nfunction createProcedureTable(data = []) {\n  if (!data || data.length === 0) {\n    return new Paragraph({\n      children: [new TextRun({\n        text: 'No se ha definido el procedimiento.',\n        size: 22,\n        font: 'Times New Roman'\n      })],\n      spacing: {\n        after: 120\n      }\n    });\n  }\n  const headerRow = new TableRow({\n    children: [new TableCell({\n      width: {\n        size: 1500,\n        type: WidthType.DXA\n      },\n      shading: {\n        fill: '1F4E79',\n        type: ShadingType.CLEAR\n      },\n      margins: {\n        top: 100,\n        bottom: 100,\n        left: 100,\n        right: 100\n      },\n      children: [new Paragraph({\n        children: [new TextRun({\n          text: '(#)',\n          bold: true,\n          color: 'FFFFFF',\n          size: 20,\n          font: 'Times New Roman'\n        })],\n        alignment: AlignmentType.CENTER,\n        spacing: {\n          before: 100,\n          after: 100\n        }\n      })]\n    }), new TableCell({\n      width: {\n        size: 2500,\n        type: WidthType.DXA\n      },\n      shading: {\n        fill: '1F4E79',\n        type: ShadingType.CLEAR\n      },\n      margins: {\n        top: 100,\n        bottom: 100,\n        left: 100,\n        right: 100\n      },\n      children: [new Paragraph({\n        children: [new TextRun({\n          text: '(QUIÉN)',\n          bold: true,\n          color: 'FFFFFF',\n          size: 20,\n          font: 'Times New Roman'\n        })],\n        alignment: AlignmentType.CENTER,\n        spacing: {\n          before: 100,\n          after: 100\n        }\n      })]\n    }), new TableCell({\n      width: {\n        size: 6500,\n        type: WidthType.DXA\n      },\n      shading: {\n        fill: '1F4E79',\n        type: ShadingType.CLEAR\n      },\n      margins: {\n        top: 100,\n        bottom: 100,\n        left: 100,\n        right: 100\n      },\n      children: [new Paragraph({\n        children: [new TextRun({\n          text: '(ACTIVIDAD)',\n          bold: true,\n          color: 'FFFFFF',\n          size: 20,\n          font: 'Times New Roman'\n        })],\n        alignment: AlignmentType.CENTER,\n        spacing: {\n          before: 100,\n          after: 100\n        }\n      })]\n    })]\n  });\n  const rows = [headerRow];\n  data.forEach((row, index) => {\n    let number = safeText(row.number || '');\n    if (number) {\n      if (!number.includes('.') && !isNaN(number)) number = `5.${number}`;else if (!number.startsWith('5.')) {\n        const segs = number.split('.');\n        if (segs.every(s => /^\\d+$/.test(s.trim()))) number = `5.${number}`;\n      }\n    }\n    const who = safeText(row.who || '');\n    const activity = safeText(row.activity || '');\n    const level = safeText(row.level || '');\n    const bg = getBackgroundColor(level);\n    rows.push(new TableRow({\n      children: [new TableCell({\n        margins: {\n          top: 100,\n          bottom: 100,\n          left: 100,\n          right: 100\n        },\n        children: [new Paragraph({\n          children: [new TextRun({\n            text: number,\n            size: 20,\n            font: 'Times New Roman',\n            bold: true\n          })],\n          alignment: AlignmentType.CENTER,\n          spacing: {\n            before: 100,\n            after: 100\n          }\n        })],\n        shading: bg ? {\n          fill: bg,\n          type: ShadingType.CLEAR\n        } : undefined\n      }), new TableCell({\n        margins: {\n          top: 100,\n          bottom: 100,\n          left: 100,\n          right: 100\n        },\n        children: [new Paragraph({\n          children: [new TextRun({\n            text: who,\n            size: 20,\n            font: 'Times New Roman',\n            bold: true\n          })],\n          alignment: AlignmentType.CENTER,\n          spacing: {\n            before: 100,\n            after: 100\n          }\n        })],\n        shading: bg ? {\n          fill: bg,\n          type: ShadingType.CLEAR\n        } : undefined\n      }), new TableCell({\n        margins: {\n          top: 100,\n          bottom: 100,\n          left: 100,\n          right: 100\n        },\n        children: [new Paragraph({\n          children: [new TextRun({\n            text: activity,\n            size: 20,\n            font: 'Times New Roman'\n          })],\n          spacing: {\n            before: 100,\n            after: 100\n          }\n        })],\n        shading: bg ? {\n          fill: bg,\n          type: ShadingType.CLEAR\n        } : undefined\n      })]\n    }));\n  });\n  return new Table({\n    rows,\n    width: {\n      size: 100,\n      type: WidthType.PERCENTAGE\n    },\n    borders: {\n      top: {\n        style: BorderStyle.SINGLE,\n        size: 2,\n        color: '1F4E79'\n      },\n      bottom: {\n        style: BorderStyle.SINGLE,\n        size: 2,\n        color: '1F4E79'\n      },\n      left: {\n        style: BorderStyle.SINGLE,\n        size: 2,\n        color: '1F4E79'\n      },\n      right: {\n        style: BorderStyle.SINGLE,\n        size: 2,\n        color: '1F4E79'\n      },\n      insideHorizontal: {\n        style: BorderStyle.SINGLE,\n        size: 1,\n        color: 'CCCCCC'\n      },\n      insideVertical: {\n        style: BorderStyle.SINGLE,\n        size: 1,\n        color: 'CCCCCC'\n      }\n    }\n  });\n}\nfunction getBackgroundColor(level) {\n  const colors = {\n    sub: 'E8F5E8',\n    section: 'E3F2FD',\n    question: 'FFF3CD',\n    alternative: 'D1ECF1',\n    end: 'D4EDDA'\n  };\n  return colors[level] || '';\n}","map":{"version":3,"names":["Document","Packer","Paragraph","TextRun","HeadingLevel","Table","TableRow","TableCell","WidthType","AlignmentType","ShadingType","Header","LevelFormat","BorderStyle","SimpleField","generateWordDocument","documentData","procedureData","formattedDate","formatDate","headerConfig","fecha","doc","coreProperties","title","policyName","subject","creator","description","language","keywords","settings","value","features","updateFields","styles","paragraphStyles","id","name","basedOn","next","quickFormat","run","size","bold","color","font","paragraph","alignment","CENTER","spacing","before","after","border","bottom","space","style","SINGLE","numbering","config","reference","levels","level","format","BULLET","text","LEFT","indent","left","hanging","DECIMAL","LOWER_LETTER","sections","properties","page","margin","top","right","headers","default","children","createHeaderTable","heading","HEADING_1","parseHtmlToParagraphs","objetivo","alcance","responsabilidades","normativa","createProcedureTable","anexos","terminos","blob","toBlob","fileName","window","navigator","msSaveOrOpenBlob","url","URL","createObjectURL","link","document","createElement","href","download","display","body","appendChild","click","setTimeout","removeChild","revokeObjectURL","error","console","Error","message","width","type","PERCENTAGE","columnWidths","borders","insideHorizontal","insideVertical","rows","shading","fill","CLEAR","manualName","columnSpan","RIGHT","allCaps","codigo","area","unidad","revision","dateInput","today","Date","year","getFullYear","month","String","getMonth","padStart","day","getDate","d","safeText","replace","trim","html","paragraphs","includes","lines","split","map","s","filter","Boolean","forEach","line","startsWith","push","substring","HEADING_2","HEADING_3","parser","DOMParser","parseFromString","root","firstElementChild","processNode","node","depth","nodeType","Node","TEXT_NODE","textContent","ELEMENT_NODE","tag","tagName","toLowerCase","parseInt","isBold","innerHTML","isItalic","isUnderline","textRuns","processTextContent","element","elemTag","innerText","italics","underline","Array","from","childNodes","length","isOrdered","outer","outerHTML","isLetter","test","numberingRef","querySelectorAll","li","liText","processListItemContent","child","e","cleaned","t","data","headerRow","DXA","margins","row","index","number","isNaN","segs","every","who","activity","bg","getBackgroundColor","undefined","colors","sub","section","question","alternative","end"],"sources":["/home/jorge/Escritorio/Jorge-PC/procesos/procesos/src/utils/docGenerator.js"],"sourcesContent":["/* eslint-disable */\nimport { Document, Packer, Paragraph, TextRun, HeadingLevel, Table, TableRow, TableCell, WidthType, AlignmentType, ShadingType, Header, LevelFormat, BorderStyle, SimpleField } from 'docx';\n\n/**\n * Genera y descarga un .docx usando la librería 'docx'.\n * Con estilos mejorados similares a la imagen de referencia\n */\nexport async function generateWordDocument(documentData = {}, procedureData = []) {\n  try {\n    const formattedDate = formatDate(documentData.headerConfig?.fecha);\n\n    // Crear el documento\n    const doc = new Document({\n      coreProperties: {\n        title: documentData.headerConfig?.policyName || 'PROCEDIMIENTO',\n        subject: 'Documento de procedimientos',\n        creator: 'Sistema',\n        description: 'Procedimiento generado automáticamente',\n        language: 'es-HN',\n        keywords: ['procedimiento', 'políticas', 'Honduras'],\n      },\n      settings: {\n        language: {\n          value: 'es-HN',\n        },\n      },\n      features: {\n        updateFields: true,\n      },\n      styles: {\n        paragraphStyles: [\n          {\n            id: 'Title',\n            name: 'Título Principal',\n            basedOn: 'Normal',\n            next: 'Normal',\n            quickFormat: true,\n            run: {\n              size: 28,\n              bold: true,\n              color: '1F4E79',\n              font: 'Times New Roman'\n            },\n            paragraph: {\n              alignment: AlignmentType.CENTER,\n              spacing: { before: 400, after: 300 },\n              border: {\n                bottom: {\n                  color: \"1F4E79\",\n                  space: 1,\n                  style: BorderStyle.SINGLE,\n                  size: 8\n                }\n              }\n            }\n          },\n          {\n            id: 'Heading1',\n            name: 'Título 1',\n            basedOn: 'Normal',\n            next: 'Normal',\n            quickFormat: true,\n            run: {\n              size: 24,\n              bold: true,\n              color: '2C3E50',\n              font: 'Times New Roman'\n            },\n            paragraph: {\n              spacing: { before: 400, after: 200 },\n              border: {\n                bottom: {\n                  color: \"D4D4D4\",\n                  space: 1,\n                  style: BorderStyle.SINGLE,\n                  size: 2\n                }\n              }\n            }\n          },\n          {\n            id: 'Heading2',\n            name: 'Título 2',\n            basedOn: 'Normal',\n            next: 'Normal',\n            quickFormat: true,\n            run: {\n              size: 22,\n              bold: true,\n              color: '2C3E50',\n              font: 'Times New Roman'\n            },\n            paragraph: {\n              spacing: { before: 300, after: 150 },\n              border: {\n                bottom: {\n                  color: \"E0E0E0\",\n                  space: 1,\n                  style: BorderStyle.SINGLE,\n                  size: 1\n                }\n              }\n            }\n          },\n          {\n            id: 'Heading3',\n            name: 'Título 3',\n            basedOn: 'Normal',\n            next: 'Normal',\n            quickFormat: true,\n            run: {\n              size: 20,\n              bold: true,\n              color: '34495E',\n              font: 'Times New Roman'\n            },\n            paragraph: {\n              spacing: { before: 200, after: 100 }\n            }\n          },\n          {\n            id: 'Normal',\n            name: 'Normal',\n            basedOn: 'Normal',\n            next: 'Normal',\n            run: {\n              size: 22,\n              font: 'Times New Roman'\n            },\n            paragraph: {\n              spacing: { after: 120 }\n            }\n          }\n        ]\n      },\n      numbering: {\n        config: [\n          {\n            reference: 'bullet-numbering',\n            levels: [\n              { \n                level: 0, \n                format: LevelFormat.BULLET, \n                text: '•', \n                alignment: AlignmentType.LEFT,\n                style: {\n                  paragraph: {\n                    indent: { left: 720, hanging: 360 }\n                  }\n                }\n              },\n            ],\n          },\n          {\n            reference: 'decimal-numbering',\n            levels: [\n              { \n                level: 0, \n                format: LevelFormat.DECIMAL, \n                text: '%1.', \n                alignment: AlignmentType.LEFT,\n                style: {\n                  paragraph: {\n                    indent: { left: 720, hanging: 360 }\n                  }\n                }\n              },\n            ],\n          },\n          {\n            reference: 'letter-numbering',\n            levels: [\n              { \n                level: 0, \n                format: LevelFormat.LOWER_LETTER, \n                text: '%1)', \n                alignment: AlignmentType.LEFT,\n                style: {\n                  paragraph: {\n                    indent: { left: 720, hanging: 360 }\n                  }\n                }\n              },\n            ],\n          },\n        ],\n      },\n      sections: [{\n        properties: {\n          page: {\n            margin: {\n              top: 1440,\n              right: 1440,\n              bottom: 1440,\n              left: 1440,\n            },\n          },\n        },\n        headers: {\n          default: new Header({\n            children: [createHeaderTable(documentData, formattedDate)]\n          }),\n        },\n        children: [\n          // 1. Objetivo o Propósito\n          new Paragraph({\n            children: [\n              new TextRun({\n                text: '1. OBJETIVO O PROPÓSITO',\n                bold: true,\n                size: 24,\n                font: 'Times New Roman',\n                color: '2C3E50'\n              })\n            ],\n            heading: HeadingLevel.HEADING_1,\n            spacing: { before: 400, after: 200 }\n          }),\n          ...parseHtmlToParagraphs(documentData.objetivo || 'Contenido pendiente de completar.'),\n\n          // 2. Alcance\n          new Paragraph({\n            children: [\n              new TextRun({\n                text: '2. ALCANCE',\n                bold: true,\n                size: 24,\n                font: 'Times New Roman',\n                color: '2C3E50'\n              })\n            ],\n            heading: HeadingLevel.HEADING_1,\n            spacing: { before: 400, after: 200 }\n          }),\n          ...parseHtmlToParagraphs(documentData.alcance || 'Contenido pendiente de completar.'),\n\n          // 3. Responsabilidades\n          new Paragraph({\n            children: [\n              new TextRun({\n                text: '3. RESPONSABILIDADES',\n                bold: true,\n                size: 24,\n                font: 'Times New Roman',\n                color: '2C3E50'\n              })\n            ],\n            heading: HeadingLevel.HEADING_1,\n            spacing: { before: 400, after: 200 }\n          }),\n          ...parseHtmlToParagraphs(documentData.responsabilidades || 'Contenido pendiente de completar.'),\n\n          // 4. Normativa\n          new Paragraph({\n            children: [\n              new TextRun({\n                text: '4. NORMATIVA',\n                bold: true,\n                size: 24,\n                font: 'Times New Roman',\n                color: '2C3E50'\n              })\n            ],\n            heading: HeadingLevel.HEADING_1,\n            spacing: { before: 400, after: 200 }\n          }),\n          ...parseHtmlToParagraphs(documentData.normativa || 'Contenido pendiente de completar.'),\n\n          // 5. Procedimiento\n          new Paragraph({\n            children: [\n              new TextRun({\n                text: '5. PROCEDIMIENTO',\n                bold: true,\n                size: 24,\n                font: 'Times New Roman',\n                color: '2C3E50'\n              })\n            ],\n            heading: HeadingLevel.HEADING_1,\n            spacing: { before: 400, after: 200 }\n          }),\n          createProcedureTable(procedureData),\n\n          // 6. Anexos\n          new Paragraph({\n            children: [\n              new TextRun({\n                text: '6. ANEXOS',\n                bold: true,\n                size: 24,\n                font: 'Times New Roman',\n                color: '2C3E50'\n              })\n            ],\n            heading: HeadingLevel.HEADING_1,\n            spacing: { before: 400, after: 200 }\n          }),\n          ...parseHtmlToParagraphs(documentData.anexos || 'Contenido pendiente de completar.'),\n\n          // 7. Términos y Referencias\n          new Paragraph({\n            children: [\n              new TextRun({\n                text: '7. TÉRMINOS Y REFERENCIAS',\n                bold: true,\n                size: 24,\n                font: 'Times New Roman',\n                color: '2C3E50'\n              })\n            ],\n            heading: HeadingLevel.HEADING_1,\n            spacing: { before: 400, after: 200 }\n          }),\n          ...parseHtmlToParagraphs(documentData.terminos || 'Contenido pendiente de completar.'),\n        ]\n      }]\n    });\n\n    const blob = await Packer.toBlob(doc);\n    const fileName = `${documentData.headerConfig?.policyName || 'Procedimiento'}.docx`;\n\n    if (window.navigator && window.navigator.msSaveOrOpenBlob) {\n      window.navigator.msSaveOrOpenBlob(blob, fileName);\n    } else {\n      const url = URL.createObjectURL(blob);\n      const link = document.createElement('a');\n      link.href = url;\n      link.download = fileName;\n      link.style.display = 'none';\n      document.body.appendChild(link);\n      link.click();\n      setTimeout(() => {\n        document.body.removeChild(link);\n        URL.revokeObjectURL(url);\n      }, 150);\n    }\n\n    return true;\n  } catch (error) {\n    console.error('Error generando documento Word:', error);\n    throw new Error(`Error al generar el documento: ${error.message}`);\n  }\n}\n\n// Función para crear la tabla del header con diseño mejorado y paginación dinámica\nfunction createHeaderTable(documentData, formattedDate) {\n  return new Table({\n    width: {\n      size: 100,\n      type: WidthType.PERCENTAGE,\n    },\n    columnWidths: [2275, 2275, 2275, 2275],\n    borders: {\n      top: { style: BorderStyle.SINGLE, size: 4, color: \"1F4E79\" },\n      left: { style: BorderStyle.SINGLE, size: 4, color: \"1F4E79\" },\n      bottom: { style: BorderStyle.SINGLE, size: 4, color: \"1F4E79\" },\n      right: { style: BorderStyle.SINGLE, size: 4, color: \"1F4E79\" },\n      insideHorizontal: { style: BorderStyle.SINGLE, size: 4, color: \"1F4E79\" },\n      insideVertical: { style: BorderStyle.SINGLE, size: 4, color: \"1F4E79\" },\n    },\n    rows: [\n      // Primera fila: Logo, Manual, Páginas\n      new TableRow({\n        children: [\n          // Logo\n          new TableCell({\n            shading: { fill: '1F4E79', type: ShadingType.CLEAR },\n            children: [new Paragraph({\n              alignment: AlignmentType.CENTER,\n              children: [new TextRun({\n                text: \"LOGO\",\n                bold: true,\n                size: 20,\n                font: 'Times New Roman',\n                color: 'FFFFFF'\n              })]\n            })]\n          }),\n          // Manual de Políticas y Procedimientos\n          new TableCell({\n            shading: { fill: '1F4E79', type: ShadingType.CLEAR },\n            children: [new Paragraph({\n              alignment: AlignmentType.CENTER,\n              children: [new TextRun({\n                text: documentData.headerConfig?.manualName || 'MANUAL DE POLÍTICAS Y PROCEDIMIENTOS',\n                bold: true,\n                size: 20,\n                font: 'Times New Roman',\n                color: 'FFFFFF'\n              })]\n            })]\n          }),\n          // Páginas (ocupa 2 columnas) - USANDO CAMPOS DINÁMICOS\n          new TableCell({\n            columnSpan: 2,\n            shading: { fill: '1F4E79', type: ShadingType.CLEAR },\n            children: [new Paragraph({\n              alignment: AlignmentType.RIGHT,\n              children: [\n                new TextRun({ \n                  text: \"PÁGINA \",\n                  bold: true, \n                  size: 20, \n                  font: 'Times New Roman',\n                  color: 'FFFFFF'\n                }),\n                // Campo para número de página actual\n                new SimpleField(\"PAGE\", \"\"),\n                new TextRun({ \n                  text: \" DE \",\n                  bold: true, \n                  size: 20, \n                  font: 'Times New Roman',\n                  color: 'FFFFFF'\n                }),\n                // Campo para número total de páginas\n                new SimpleField(\"NUMPAGES\", \"\")\n              ]\n            })]\n          }),\n        ],\n      }),\n      // Segunda fila: Nombre del Procedimiento y Código\n      new TableRow({\n        children: [\n          // POLÍTICA O PROCEDIMIENTO DE (ocupa 2 columnas)\n          new TableCell({\n            columnSpan: 2,\n            children: [new Paragraph({\n              children: [new TextRun({\n                text: documentData.headerConfig?.policyName || 'PROCEDIMIENTO',\n                bold: true,\n                size: 22,\n                font: 'Times New Roman',\n                color: '1F4E79',\n                allCaps: true,\n              })]\n            })]\n          }),\n          // CÓDIGO (ocupa 2 columnas)\n          new TableCell({\n            columnSpan: 2,\n            children: [new Paragraph({\n              alignment: AlignmentType.RIGHT,\n              children: [new TextRun({\n                text: `CÓDIGO: ${documentData.headerConfig?.codigo || 'XX-P-XXX-#'}`,\n                bold: true,\n                size: 20,\n                font: 'Times New Roman',\n                color: '1F4E79'\n              })]\n            })]\n          }),\n        ],\n      }),\n      // Tercera fila: Área, Unidad, Revisión, Fecha\n      new TableRow({\n        children: [\n          // Área\n          new TableCell({\n            children: [new Paragraph({\n              children: [new TextRun({\n                text: `Área: ${documentData.headerConfig?.area || 'ÁREA RESPONSABLE'}`,\n                size: 18,\n                font: 'Times New Roman',\n                bold: true,\n                language: 'es-HN'\n              })]\n            })]\n          }),\n          // Unidad\n          new TableCell({\n            children: [new Paragraph({\n              children: [new TextRun({\n                text: `Unidad: ${documentData.headerConfig?.unidad || 'UNIDAD ESPECÍFICA'}`,\n                size: 18,\n                font: 'Times New Roman',\n                bold: true,\n                language: 'es-HN'\n              })]\n            })]\n          }),\n          // Revisión\n          new TableCell({\n            children: [new Paragraph({\n              alignment: AlignmentType.CENTER,\n              children: [new TextRun({\n                text: `Revisión: ${documentData.headerConfig?.revision || '(1)'}`,\n                size: 18,\n                font: 'Times New Roman',\n                bold: true,\n              })]\n            })]\n          }),\n          // Fecha\n          new TableCell({\n            children: [new Paragraph({\n              alignment: AlignmentType.RIGHT,\n              children: [new TextRun({\n                text: `Fecha: ${formattedDate}`,\n                bold: true,\n                size: 18,\n                font: 'Times New Roman'\n              })]\n            })]\n          }),\n        ],\n      }),\n    ],\n  });\n}\n\n/* ---------------- Helpers ---------------- */\n\nfunction formatDate(dateInput) {\n  if (!dateInput) {\n    const today = new Date();\n    const year = today.getFullYear();\n    const month = String(today.getMonth() + 1).padStart(2, '0');\n    const day = String(today.getDate()).padStart(2, '0');\n    return `${day}-${month}-${year}`;\n  }\n  \n  const d = new Date(dateInput);\n  const day = String(d.getDate()).padStart(2, '0');\n  const month = String(d.getMonth() + 1).padStart(2, '0');\n  const year = d.getFullYear();\n  return `${day}-${month}-${year}`;\n}\n\nfunction safeText(value) {\n  if (value == null) return '';\n  return String(value).replace(/\\s+/g, ' ').trim();\n}\n\n/**\n * Parsea HTML simple a Paragraphs de docx\n * Ahora soporta títulos h1, h2, h3 correctamente\n */\nfunction parseHtmlToParagraphs(html = '') {\n  const paragraphs = [];\n  if (!html) return paragraphs;\n\n  try {\n    // Si no hay HTML tags, procesar como texto plano\n    if (!html.includes('<') && !html.includes('>')) {\n      const lines = String(html).split(/\\n+/).map(s => safeText(s)).filter(Boolean);\n      lines.forEach(line => {\n        // Detectar si es un título por el formato (solo si no hay tags HTML)\n        if (line.startsWith('# ')) {\n          paragraphs.push(new Paragraph({\n            children: [new TextRun({ \n              text: line.substring(2), \n              size: 28, \n              font: 'Times New Roman',\n              bold: true,\n              color: '1F4E79'\n            })],\n            heading: HeadingLevel.HEADING_1,\n            spacing: { before: 400, after: 200 },\n            border: {\n              bottom: {\n                color: \"1F4E79\",\n                space: 1,\n                style: BorderStyle.SINGLE,\n                size: 8\n              }\n            }\n          }));\n        } else if (line.startsWith('## ')) {\n          paragraphs.push(new Paragraph({\n            children: [new TextRun({ \n              text: line.substring(3), \n              size: 24, \n              font: 'Times New Roman',\n              bold: true,\n              color: '2C3E50'\n            })],\n            heading: HeadingLevel.HEADING_2,\n            spacing: { before: 300, after: 150 },\n            border: {\n              bottom: {\n                color: \"D4D4D4\",\n                space: 1,\n                style: BorderStyle.SINGLE,\n                size: 2\n              }\n            }\n          }));\n        } else if (line.startsWith('### ')) {\n          paragraphs.push(new Paragraph({\n            children: [new TextRun({ \n              text: line.substring(4), \n              size: 20, \n                  font: 'Times New Roman',\n              bold: true,\n              color: '34495E'\n            })],\n            heading: HeadingLevel.HEADING_3,\n            spacing: { before: 200, after: 100 }\n          }));\n        } else {\n          paragraphs.push(new Paragraph({\n            children: [new TextRun({ text: line, size: 22, font: 'Times New Roman' })],\n            spacing: { after: 120 }\n          }));\n        }\n      });\n      return paragraphs;\n    }\n\n    const parser = new DOMParser();\n    const doc = parser.parseFromString(`<div>${html}</div>`, 'text/html');\n    const root = doc.body.firstElementChild || doc.body;\n\n    const processNode = (node, depth = 0) => {\n      if (node.nodeType === Node.TEXT_NODE) {\n        const text = safeText(node.textContent);\n        if (text && text.trim() !== '') {\n          paragraphs.push(new Paragraph({\n            children: [new TextRun({ text, size: 22, font: 'Times New Roman' })],\n            spacing: { after: 120 }\n          }));\n        }\n        return;\n      }\n\n      if (node.nodeType !== Node.ELEMENT_NODE) return;\n\n      const tag = node.tagName.toLowerCase();\n\n      // Manejar títulos\n      if (tag === 'h1' || tag === 'h2' || tag === 'h3') {\n        const text = safeText(node.textContent);\n        if (!text) return;\n        \n        const level = parseInt(tag.substring(1));\n        \n        if (level === 1) {\n          paragraphs.push(new Paragraph({\n            children: [new TextRun({ \n              text: text, \n              size: 28, \n              font: 'Times New Roman',\n              bold: true,\n              color: '1F4E79'\n            })],\n            heading: HeadingLevel.HEADING_1,\n            spacing: { before: 400, after: 200 },\n            border: {\n              bottom: {\n                color: \"1F4E79\",\n                space: 1,\n                style: BorderStyle.SINGLE,\n                size: 8\n              }\n            }\n          }));\n        } else if (level === 2) {\n          paragraphs.push(new Paragraph({\n            children: [new TextRun({ \n              text: text, \n              size: 24, \n              font: 'Times New Roman',\n              bold: true,\n              color: '2C3E50'\n            })],\n            heading: HeadingLevel.HEADING_2,\n            spacing: { before: 300, after: 150 },\n            border: {\n              bottom: {\n                color: \"D4D4D4\",\n                space: 1,\n                style: BorderStyle.SINGLE,\n                size: 2\n              }\n            }\n          }));\n        } else if (level === 3) {\n          paragraphs.push(new Paragraph({\n            children: [new TextRun({ \n              text: text, \n              size: 20, \n              font: 'Times New Roman',\n              bold: true,\n              color: '34495E'\n            })],\n            heading: HeadingLevel.HEADING_3,\n            spacing: { before: 200, after: 100 }\n          }));\n        }\n      }\n      // Manejar párrafos\n      else if (tag === 'p') {\n        const text = safeText(node.textContent);\n        if (text) {\n          // Verificar si el párrafo tiene estilos en línea\n          const isBold = node.innerHTML.includes('<strong>') || node.innerHTML.includes('<b>');\n          const isItalic = node.innerHTML.includes('<em>') || node.innerHTML.includes('<i>');\n          const isUnderline = node.innerHTML.includes('<u>');\n          \n          const textRuns = [];\n          \n          // Procesar contenido del párrafo con estilos\n          const processTextContent = (element) => {\n            if (element.nodeType === Node.TEXT_NODE) {\n              const text = safeText(element.textContent);\n              if (text) {\n                textRuns.push(new TextRun({ \n                  text, \n                  size: 22, \n                  font: 'Times New Roman'\n                }));\n              }\n            } else if (element.nodeType === Node.ELEMENT_NODE) {\n              const elemTag = element.tagName.toLowerCase();\n              const innerText = safeText(element.textContent);\n              \n              if (elemTag === 'strong' || elemTag === 'b') {\n                textRuns.push(new TextRun({ \n                  text: innerText, \n                  size: 22, \n                  font: 'Times New Roman',\n                  bold: true\n                }));\n              } else if (elemTag === 'em' || elemTag === 'i') {\n                textRuns.push(new TextRun({ \n                  text: innerText, \n                  size: 22, \n                  font: 'Times New Roman',\n                  italics: true\n                }));\n              } else if (elemTag === 'u') {\n                textRuns.push(new TextRun({ \n                  text: innerText, \n                  size: 22, \n                  font: 'Times New Roman',\n                  underline: {}\n                }));\n              } else if (elemTag === 'br') {\n                // Los saltos de línea se manejan automáticamente\n              } else {\n                // Para otros elementos, procesar recursivamente\n                Array.from(element.childNodes).forEach(processTextContent);\n              }\n            }\n          };\n          \n          Array.from(node.childNodes).forEach(processTextContent);\n          \n          paragraphs.push(new Paragraph({\n            children: textRuns.length > 0 ? textRuns : [new TextRun({ text, size: 22, font: 'Times New Roman' })],\n            spacing: { after: 120 }\n          }));\n        }\n      }\n      // Manejar listas\n      else if (tag === 'ul' || tag === 'ol') {\n        const isOrdered = tag === 'ol';\n        const outer = node.outerHTML || '';\n        const isLetter = /data-type\\s*=\\s*[\"']letter[\"']/i.test(outer);\n        const numberingRef = isLetter ? 'letter-numbering' : (isOrdered ? 'decimal-numbering' : 'bullet-numbering');\n\n        node.querySelectorAll('li').forEach(li => {\n          const liText = safeText(li.textContent);\n          if (!liText) return;\n          \n          // Procesar estilos dentro de los items de lista\n          const textRuns = [];\n          const processListItemContent = (element) => {\n            if (element.nodeType === Node.TEXT_NODE) {\n              const text = safeText(element.textContent);\n              if (text) {\n                textRuns.push(new TextRun({ \n                  text, \n                  size: 22, \n                  font: 'Times New Roman'\n                }));\n              }\n            } else if (element.nodeType === Node.ELEMENT_NODE) {\n              const elemTag = element.tagName.toLowerCase();\n              const innerText = safeText(element.textContent);\n              \n              if (elemTag === 'strong' || elemTag === 'b') {\n                textRuns.push(new TextRun({ \n                  text: innerText, \n                  size: 22, \n                  font: 'Times New Roman',\n                  bold: true\n                }));\n              } else if (elemTag === 'em' || elemTag === 'i') {\n                textRuns.push(new TextRun({ \n                  text: innerText, \n                  size: 22, \n                  font: 'Times New Roman',\n                  italics: true\n                }));\n              } else if (elemTag === 'u') {\n                textRuns.push(new TextRun({ \n                  text: innerText, \n                  size: 22, \n                  font: 'Times New Roman',\n                  underline: {}\n                }));\n              } else {\n                // Para otros elementos, procesar recursivamente\n                Array.from(element.childNodes).forEach(processListItemContent);\n              }\n            }\n          };\n          \n          Array.from(li.childNodes).forEach(processListItemContent);\n          \n          paragraphs.push(new Paragraph({\n            children: textRuns.length > 0 ? textRuns : [new TextRun({ text: liText, size: 22, font: 'Times New Roman' })],\n            numbering: { reference: numberingRef, level: 0 },\n            spacing: { after: 80 },\n          }));\n        });\n      }\n      // Manejar saltos de línea\n      else if (tag === 'br') {\n        paragraphs.push(new Paragraph({ text: '' }));\n      }\n      // Manejar divs y otros contenedores (procesar recursivamente)\n      else if (tag === 'div' || tag === 'span' || tag === 'section' || tag === 'article') {\n        Array.from(node.childNodes).forEach(child => processNode(child, depth + 1));\n      }\n      // Para otros elementos, extraer el texto\n      else {\n        const text = safeText(node.textContent);\n        if (text) {\n          paragraphs.push(new Paragraph({\n            children: [new TextRun({ text, size: 22, font: 'Times New Roman' })],\n            spacing: { after: 120 }\n          }));\n        }\n      }\n    };\n\n    Array.from(root.childNodes).forEach(node => processNode(node));\n\n  } catch (e) {\n    console.error('Error parsing HTML:', e);\n    // Fallback: limpiar HTML y procesar como texto plano\n    const cleaned = String(html)\n      .replace(/<br\\s*\\/?>/gi, '\\n')\n      .replace(/<[^>]+>/g, '')\n      .replace(/&nbsp;/g, ' ')\n      .replace(/&lt;/g, '<')\n      .replace(/&gt;/g, '>')\n      .replace(/&amp;/g, '&')\n      .trim();\n    \n    if (cleaned) {\n      cleaned.split(/\\n+/).map(s => safeText(s)).filter(Boolean).forEach(t => {\n        paragraphs.push(new Paragraph({\n          children: [new TextRun({ text: t, size: 22, font: 'Times New Roman' })],\n          spacing: { after: 120 }\n        }));\n      });\n    }\n  }\n\n  if (paragraphs.length === 0) paragraphs.push(new Paragraph({ text: '' }));\n  return paragraphs;\n}\n\n/**\n * Crea una tabla para el procedimiento con diseño mejorado\n */\nfunction createProcedureTable(data = []) {\n  if (!data || data.length === 0) {\n    return new Paragraph({ \n      children: [new TextRun({ text: 'No se ha definido el procedimiento.', size: 22, font: 'Times New Roman' })],\n      spacing: { after: 120 } \n    });\n  }\n\n  const headerRow = new TableRow({\n    children: [\n      new TableCell({\n        width: { size: 1500, type: WidthType.DXA },\n        shading: { fill: '1F4E79', type: ShadingType.CLEAR },\n        margins: { top: 100, bottom: 100, left: 100, right: 100 },\n        children: [new Paragraph({\n          children: [new TextRun({ \n            text: '(#)', \n            bold: true, \n            color: 'FFFFFF',\n            size: 20,\n            font: 'Times New Roman'\n          })],\n          alignment: AlignmentType.CENTER,\n          spacing: { before: 100, after: 100 }\n        })],\n      }),\n      new TableCell({\n        width: { size: 2500, type: WidthType.DXA },\n        shading: { fill: '1F4E79', type: ShadingType.CLEAR },\n        margins: { top: 100, bottom: 100, left: 100, right: 100 },\n        children: [new Paragraph({\n          children: [new TextRun({ \n            text: '(QUIÉN)', \n            bold: true, \n            color: 'FFFFFF',\n            size: 20,\n            font: 'Times New Roman'\n          })],\n          alignment: AlignmentType.CENTER,\n          spacing: { before: 100, after: 100 }\n        })],\n      }),\n      new TableCell({\n        width: { size: 6500, type: WidthType.DXA },\n        shading: { fill: '1F4E79', type: ShadingType.CLEAR },\n        margins: { top: 100, bottom: 100, left: 100, right: 100 },\n        children: [new Paragraph({\n          children: [new TextRun({ \n            text: '(ACTIVIDAD)', \n            bold: true, \n            color: 'FFFFFF',\n            size: 20,\n            font: 'Times New Roman'\n          })],\n          alignment: AlignmentType.CENTER,\n          spacing: { before: 100, after: 100 }\n        })],\n      }),\n    ],\n  });\n\n  const rows = [headerRow];\n\n  data.forEach((row, index) => {\n    let number = safeText(row.number || '');\n    if (number) {\n      if (!number.includes('.') && !isNaN(number)) number = `5.${number}`;\n      else if (!number.startsWith('5.')) {\n        const segs = number.split('.');\n        if (segs.every(s => /^\\d+$/.test(s.trim()))) number = `5.${number}`;\n      }\n    }\n\n    const who = safeText(row.who || '');\n    const activity = safeText(row.activity || '');\n    const level = safeText(row.level || '');\n    const bg = getBackgroundColor(level);\n\n    rows.push(new TableRow({\n      children: [\n        new TableCell({\n          margins: { top: 100, bottom: 100, left: 100, right: 100 },\n          children: [new Paragraph({\n            children: [new TextRun({ \n              text: number, \n              size: 20,\n              font: 'Times New Roman',\n              bold: true\n            })],\n            alignment: AlignmentType.CENTER,\n            spacing: { before: 100, after: 100 }\n          })],\n          shading: bg ? { fill: bg, type: ShadingType.CLEAR } : undefined,\n        }),\n        new TableCell({\n          margins: { top: 100, bottom: 100, left: 100, right: 100 },\n          children: [new Paragraph({\n            children: [new TextRun({ \n              text: who, \n              size: 20,\n              font: 'Times New Roman',\n              bold: true\n            })],\n            alignment: AlignmentType.CENTER,\n            spacing: { before: 100, after: 100 }\n          })],\n          shading: bg ? { fill: bg, type: ShadingType.CLEAR } : undefined,\n        }),\n        new TableCell({\n          margins: { top: 100, bottom: 100, left: 100, right: 100 },\n          children: [new Paragraph({\n            children: [new TextRun({ \n              text: activity, \n              size: 20,\n              font: 'Times New Roman'\n            })],\n            spacing: { before: 100, after: 100 }\n          })],\n          shading: bg ? { fill: bg, type: ShadingType.CLEAR } : undefined,\n        }),\n      ],\n    }));\n  });\n\n  return new Table({\n    rows,\n    width: { size: 100, type: WidthType.PERCENTAGE },\n    borders: {\n      top: { style: BorderStyle.SINGLE, size: 2, color: '1F4E79' },\n      bottom: { style: BorderStyle.SINGLE, size: 2, color: '1F4E79' },\n      left: { style: BorderStyle.SINGLE, size: 2, color: '1F4E79' },\n      right: { style: BorderStyle.SINGLE, size: 2, color: '1F4E79' },\n      insideHorizontal: { style: BorderStyle.SINGLE, size: 1, color: 'CCCCCC' },\n      insideVertical: { style: BorderStyle.SINGLE, size: 1, color: 'CCCCCC' },\n    },\n  });\n}\n\nfunction getBackgroundColor(level) {\n  const colors = {\n    sub: 'E8F5E8',\n    section: 'E3F2FD',\n    question: 'FFF3CD',\n    alternative: 'D1ECF1',\n    end: 'D4EDDA',\n  };\n  return colors[level] || '';\n}"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}