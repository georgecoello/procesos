{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport \"core-js/modules/es.iterator.constructor.js\";\nimport \"core-js/modules/es.iterator.filter.js\";\nimport \"core-js/modules/es.iterator.for-each.js\";\nimport \"core-js/modules/es.iterator.map.js\";\nimport { generateWordDocument } from '@/utils/docGenerator';\nimport { Editor, EditorContent } from '@tiptap/vue-3';\nimport StarterKit from '@tiptap/starter-kit';\nimport Heading from '@tiptap/extension-heading';\nimport Underline from '@tiptap/extension-underline';\nimport Strike from '@tiptap/extension-strike';\nimport Placeholder from '@tiptap/extension-placeholder';\nimport HardBreak from '@tiptap/extension-hard-break';\nimport BulletList from '@tiptap/extension-bullet-list';\nimport OrderedList from '@tiptap/extension-ordered-list';\nimport Blockquote from '@tiptap/extension-blockquote';\nimport CodeBlock from '@tiptap/extension-code-block';\nimport TextAlign from '@tiptap/extension-text-align';\n\n// Extensi√≥n personalizada para listas con letras\nconst LetterListExtension = BulletList.extend({\n  addAttributes() {\n    return {\n      'data-type': {\n        default: null,\n        parseHTML: element => element.getAttribute('data-type'),\n        renderHTML: attributes => {\n          return attributes['data-type'] ? {\n            'data-type': attributes['data-type']\n          } : {};\n        }\n      }\n    };\n  }\n});\nexport default {\n  name: 'DocumentView',\n  components: {\n    EditorContent\n  },\n  data() {\n    return {\n      // Modales\n      showResetModal: false,\n      showVersionHistoryModal: false,\n      selectedVersionDetail: null,\n      // Configuraci√≥n del documento\n      headerConfig: {\n        manualName: '',\n        policyName: '',\n        codigo: '',\n        area: '',\n        unidad: '',\n        revision: '',\n        fecha: this.getFormattedDate()\n      },\n      // Secciones del documento\n      sections: [{\n        title: '1. Objetivo o Prop√≥sito',\n        description: 'Establecer el prop√≥sito general del procedimiento.',\n        placeholder: 'Definir el objetivo principal del procedimiento y los resultados esperados...',\n        content: '',\n        editor: null\n      }, {\n        title: '2. Alcance',\n        description: 'Definir los l√≠mites y cobertura del procedimiento.',\n        placeholder: 'Especificar los l√≠mites, √°reas de aplicaci√≥n y exclusiones del procedimiento...',\n        content: '',\n        editor: null\n      }, {\n        title: '3. Responsabilidades',\n        description: 'Listar los roles y responsabilidades de cada participante.',\n        placeholder: '1. Responsable Principal\\n2. Coordinador\\n3. Ejecutor...',\n        content: '',\n        editor: null\n      }, {\n        title: '4. Normativa',\n        description: 'Establecer las normas, pol√≠ticas y criterios aplicables.',\n        placeholder: 'I. [MARCO NORMATIVO]\\nEstablecer las normas y pol√≠ticas que rigen el procedimiento...',\n        content: '',\n        editor: null\n      }],\n      remainingSections: [{\n        title: '6. Anexos',\n        description: 'Listar los formatos, documentos y anexos relacionados.',\n        placeholder: 'Formato de registro\\nDocumentos de referencia...',\n        content: '',\n        editor: null\n      }, {\n        title: '7. T√©rminos y Referencias',\n        description: 'Definir t√©rminos t√©cnicos y referencias documentales.',\n        placeholder: 'T√©rmino 1: Definici√≥n\\nT√©rmino 2: Explicaci√≥n...',\n        content: '',\n        editor: null\n      }],\n      // Procedimiento\n      generatedTable: [],\n      procedimientoEditor: null,\n      // Sistema de control de versiones\n      documentVersions: [],\n      currentVersionIndex: 0,\n      maxVersions: 10,\n      versionHistory: [],\n      documentId: null,\n      hasUnsavedChanges: false,\n      lastSavedTime: null,\n      autoSaveEnabled: true,\n      autoSaveInterval: null,\n      autoSaveFrequency: 30000,\n      // 30 segundos\n\n      // UI y estado\n      statusMessage: '',\n      statusType: '',\n      isGenerating: false\n    };\n  },\n  computed: {\n    procedureTable() {\n      return this.generatedTable;\n    },\n    // Estad√≠sticas del documento\n    documentStats() {\n      return {\n        wordCount: this.calculateTotalWordCount(),\n        completion: this.calculateDocumentCompletion(),\n        sections: this.sections.length + this.remainingSections.length,\n        procedureSteps: this.generatedTable.length,\n        lastVersion: this.documentVersions[0] ? this.formatDate(this.documentVersions[0].timestamp) : 'Nunca'\n      };\n    }\n  },\n  mounted() {\n    this.$nextTick(() => {\n      this.initializeEditors();\n      this.initializeVersionSystem();\n    });\n\n    // Configurar autoguardado autom√°tico\n    this.setupAutoVersioning();\n\n    // Detectar cierre de ventana\n    window.addEventListener('beforeunload', this.handleBeforeUnload);\n  },\n  beforeUnmount() {\n    this.destroyEditors();\n    this.stopAutoSave();\n    window.removeEventListener('beforeunload', this.handleBeforeUnload);\n  },\n  methods: {\n    // ============ SISTEMA DE CONTROL DE VERSIONES ============\n\n    /**\n     * Inicializa el sistema de versiones\n     */\n    initializeVersionSystem() {\n      // Generar ID √∫nico para el documento\n      this.documentId = `doc_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`;\n\n      // Cargar versiones existentes del localStorage\n      this.loadVersionsFromStorage();\n\n      // Si no hay versiones, crear una inicial\n      if (this.documentVersions.length === 0) {\n        this.captureVersion('Versi√≥n inicial del documento');\n      } else {\n        this.lastSavedTime = this.documentVersions[0]?.timestamp;\n      }\n\n      // Configurar detecci√≥n de cambios\n      this.setupChangeDetection();\n      console.log('‚úÖ Sistema de versiones inicializado');\n    },\n    /**\n     * Captura una nueva versi√≥n del documento\n     */\n    captureVersion(description = 'Cambios sin descripci√≥n') {\n      try {\n        const versionData = this.createVersionSnapshot(description);\n\n        // Agregar a la lista de versiones\n        this.documentVersions.unshift(versionData);\n\n        // Mantener solo el n√∫mero m√°ximo de versiones\n        if (this.documentVersions.length > this.maxVersions) {\n          this.documentVersions.pop();\n        }\n\n        // Actualizar √≠ndice de versi√≥n actual\n        this.currentVersionIndex = 0;\n\n        // Actualizar tiempo de √∫ltimo guardado\n        this.lastSavedTime = versionData.timestamp;\n\n        // Agregar al historial\n        this.versionHistory.unshift({\n          action: 'version_saved',\n          versionId: versionData.id,\n          description: description,\n          timestamp: new Date().toISOString(),\n          user: 'usuario_actual'\n        });\n\n        // Guardar en localStorage\n        this.saveVersionsToStorage();\n\n        // Resetear flag de cambios no guardados\n        this.hasUnsavedChanges = false;\n        console.log(`üìù Versi√≥n guardada: ${description}`);\n        return versionData.id;\n      } catch (error) {\n        console.error('‚ùå Error capturando versi√≥n:', error);\n        return null;\n      }\n    },\n    /**\n     * Crea un snapshot del estado actual\n     */\n    createVersionSnapshot(description) {\n      // Calcular estad√≠sticas\n      const wordCount = this.calculateTotalWordCount();\n      const completion = this.calculateDocumentCompletion();\n      return {\n        id: `v${Date.now()}_${Math.random().toString(36).substr(2, 9)}`,\n        timestamp: new Date().toISOString(),\n        description: description,\n        data: {\n          // Configuraci√≥n del encabezado\n          headerConfig: JSON.parse(JSON.stringify(this.headerConfig)),\n          // Contenido de secciones principales\n          sections: this.sections.map(section => ({\n            title: section.title,\n            content: section.editor ? section.editor.getHTML() : '',\n            text: section.editor ? section.editor.getText() : ''\n          })),\n          // Secciones restantes\n          remainingSections: this.remainingSections.map(section => ({\n            title: section.title,\n            content: section.editor ? section.editor.getHTML() : '',\n            text: section.editor ? section.editor.getText() : ''\n          })),\n          // Procedimiento\n          procedimiento: {\n            content: this.procedimientoEditor ? this.procedimientoEditor.getHTML() : '',\n            text: this.procedimientoEditor ? this.procedimientoEditor.getText() : '',\n            table: JSON.parse(JSON.stringify(this.generatedTable))\n          }\n        },\n        preview: this.generateVersionPreview(wordCount, completion)\n      };\n    },\n    /**\n     * Genera una vista previa de la versi√≥n\n     */\n    generateVersionPreview(wordCount, completion) {\n      // Obtener texto de la primera secci√≥n para el snippet\n      let snippet = '';\n      if (this.sections.length > 0 && this.sections[0].editor) {\n        const text = this.sections[0].editor.getText();\n        snippet = text.substring(0, 150) + (text.length > 150 ? '...' : '');\n      }\n      return {\n        title: this.headerConfig.policyName || 'Documento sin t√≠tulo',\n        snippet: snippet || 'Sin contenido',\n        words: wordCount,\n        completion: completion,\n        sections: this.sections.length + this.remainingSections.length,\n        procedureSteps: this.generatedTable.length\n      };\n    },\n    /**\n     * Restaura una versi√≥n espec√≠fica\n     */\n    restoreVersion(versionId) {\n      const versionIndex = this.documentVersions.findIndex(v => v.id === versionId);\n      if (versionIndex === -1) {\n        this.showStatus('‚ùå Versi√≥n no encontrada', 'error');\n        return false;\n      }\n      const version = this.documentVersions[versionIndex];\n\n      // Confirmar antes de restaurar\n      if (!confirm(`¬øRestaurar versi√≥n del ${this.formatDate(version.timestamp)}?\\n\\n\"${version.description}\"`)) {\n        return false;\n      }\n      try {\n        // Restaurar configuraci√≥n del encabezado\n        this.headerConfig = JSON.parse(JSON.stringify(version.data.headerConfig));\n\n        // Restaurar secciones principales\n        this.sections.forEach((section, index) => {\n          if (version.data.sections[index] && section.editor) {\n            section.editor.commands.setContent(version.data.sections[index].content);\n          }\n        });\n\n        // Restaurar secciones restantes\n        this.remainingSections.forEach((section, index) => {\n          if (version.data.remainingSections[index] && section.editor) {\n            section.editor.commands.setContent(version.data.remainingSections[index].content);\n          }\n        });\n\n        // Restaurar procedimiento\n        if (this.procedimientoEditor && version.data.procedimiento) {\n          this.procedimientoEditor.commands.setContent(version.data.procedimiento.content);\n          this.generatedTable = JSON.parse(JSON.stringify(version.data.procedimiento.table));\n        }\n\n        // Actualizar √≠ndice actual\n        this.currentVersionIndex = versionIndex;\n\n        // Registrar en historial\n        this.versionHistory.unshift({\n          action: 'version_restored',\n          versionId: versionId,\n          timestamp: new Date().toISOString(),\n          user: 'usuario_actual'\n        });\n        this.saveVersionsToStorage();\n\n        // Cerrar modales\n        this.showVersionHistoryModal = false;\n        this.selectedVersionDetail = null;\n        this.showStatus(`‚úÖ Versi√≥n restaurada: ${version.description}`, 'success');\n        return true;\n      } catch (error) {\n        console.error('‚ùå Error restaurando versi√≥n:', error);\n        this.showStatus('‚ùå Error al restaurar la versi√≥n', 'error');\n        return false;\n      }\n    },\n    /**\n     * Elimina una versi√≥n\n     */\n    deleteVersion(versionId) {\n      const index = this.documentVersions.findIndex(v => v.id === versionId);\n      if (index === -1) return false;\n      if (!confirm(`¬øEliminar esta versi√≥n permanentemente?\\n\\n\"${this.documentVersions[index].description}\"`)) {\n        return false;\n      }\n\n      // No permitir eliminar la versi√≥n actual si es la √∫nica\n      if (this.documentVersions.length === 1) {\n        this.showStatus('‚ùå No puedes eliminar la √∫nica versi√≥n disponible', 'error');\n        return false;\n      }\n\n      // Ajustar √≠ndice actual si se elimina la versi√≥n actual\n      if (index === this.currentVersionIndex) {\n        this.currentVersionIndex = 0;\n      } else if (index < this.currentVersionIndex) {\n        this.currentVersionIndex--;\n      }\n      this.documentVersions.splice(index, 1);\n      this.saveVersionsToStorage();\n      this.showStatus('üóëÔ∏è Versi√≥n eliminada', 'info');\n      return true;\n    },\n    /**\n     * Guarda las versiones en localStorage\n     */\n    saveVersionsToStorage() {\n      try {\n        const data = {\n          versions: this.documentVersions,\n          history: this.versionHistory,\n          currentIndex: this.currentVersionIndex,\n          documentId: this.documentId,\n          lastUpdated: new Date().toISOString()\n        };\n        localStorage.setItem(`document_versions_${this.documentId}`, JSON.stringify(data));\n        return true;\n      } catch (error) {\n        console.error('‚ùå Error guardando versiones:', error);\n        return false;\n      }\n    },\n    /**\n     * Carga las versiones desde localStorage\n     */\n    loadVersionsFromStorage() {\n      try {\n        const saved = localStorage.getItem(`document_versions_${this.documentId}`);\n        if (saved) {\n          const data = JSON.parse(saved);\n          this.documentVersions = data.versions || [];\n          this.versionHistory = data.history || [];\n          this.currentVersionIndex = data.currentIndex || 0;\n          return true;\n        }\n      } catch (error) {\n        console.error('‚ùå Error cargando versiones:', error);\n      }\n      return false;\n    },\n    /**\n     * Configura autoguardado autom√°tico\n     */\n    setupAutoVersioning() {\n      if (this.autoSaveEnabled) {\n        this.autoSaveInterval = setInterval(() => {\n          if (this.hasUnsavedChanges) {\n            this.captureVersion(`Auto-guardado ${new Date().toLocaleTimeString()}`);\n          }\n        }, this.autoSaveFrequency);\n        console.log('üîÑ Autoguardado configurado cada', this.autoSaveFrequency / 1000, 'segundos');\n      }\n    },\n    /**\n     * Detiene el autoguardado\n     */\n    stopAutoSave() {\n      if (this.autoSaveInterval) {\n        clearInterval(this.autoSaveInterval);\n        this.autoSaveInterval = null;\n        console.log('‚èπÔ∏è Autoguardado detenido');\n      }\n    },\n    /**\n     * Configura detecci√≥n de cambios\n     */\n    setupChangeDetection() {\n      // Monitorear cambios en todos los editores\n      const editors = [...this.sections.map(s => s.editor), ...this.remainingSections.map(s => s.editor), this.procedimientoEditor].filter(Boolean);\n      editors.forEach(editor => {\n        editor.on('update', () => {\n          this.markAsChanged();\n        });\n      });\n    },\n    /**\n     * Marca el documento como modificado\n     */\n    markAsChanged() {\n      if (!this.hasUnsavedChanges) {\n        this.hasUnsavedChanges = true;\n        console.log('üìù Documento marcado como modificado');\n      }\n    },\n    /**\n     * Maneja el evento beforeunload\n     */\n    handleBeforeUnload(event) {\n      if (this.hasUnsavedChanges) {\n        event.preventDefault();\n        event.returnValue = 'Tienes cambios sin guardar. ¬øSeguro que quieres salir?';\n        return event.returnValue;\n      }\n    },\n    // ============ M√âTODOS AUXILIARES ============\n\n    /**\n     * Calcula el total de palabras del documento\n     */\n    calculateTotalWordCount() {\n      let count = 0;\n\n      // Contar palabras de secciones principales\n      this.sections.forEach(section => {\n        if (section.editor) {\n          const text = section.editor.getText();\n          count += text.split(/\\s+/).filter(word => word.length > 0).length;\n        }\n      });\n\n      // Contar palabras de secciones restantes\n      this.remainingSections.forEach(section => {\n        if (section.editor) {\n          const text = section.editor.getText();\n          count += text.split(/\\s+/).filter(word => word.length > 0).length;\n        }\n      });\n\n      // Contar palabras del procedimiento\n      if (this.procedimientoEditor) {\n        const text = this.procedimientoEditor.getText();\n        count += text.split(/\\s+/).filter(word => word.length > 0).length;\n      }\n      return count;\n    },\n    /**\n     * Calcula el porcentaje de completado del documento\n     */\n    calculateDocumentCompletion() {\n      let completedSections = 0;\n      const totalSections = this.sections.length + this.remainingSections.length + 1; // +1 para procedimiento\n\n      // Verificar secciones principales (m√≠nimo 10 caracteres)\n      this.sections.forEach(section => {\n        if (section.editor && section.editor.getText().trim().length > 10) {\n          completedSections++;\n        }\n      });\n\n      // Verificar secciones restantes\n      this.remainingSections.forEach(section => {\n        if (section.editor && section.editor.getText().trim().length > 10) {\n          completedSections++;\n        }\n      });\n\n      // Verificar procedimiento\n      if (this.procedimientoEditor && this.procedimientoEditor.getText().trim().length > 10) {\n        completedSections++;\n      }\n      return Math.round(completedSections / totalSections * 100);\n    },\n    /**\n     * Formatea una fecha\n     */\n    formatDate(dateString) {\n      if (!dateString) return 'Nunca';\n      try {\n        const date = new Date(dateString);\n        return date.toLocaleString('es-ES', {\n          day: '2-digit',\n          month: '2-digit',\n          year: 'numeric',\n          hour: '2-digit',\n          minute: '2-digit'\n        });\n      } catch (error) {\n        return dateString;\n      }\n    },\n    // ============ M√âTODOS DE UI ============\n\n    /**\n     * Abre el modal de historial de versiones\n     */\n    openVersionHistoryModal() {\n      this.showVersionHistoryModal = true;\n      this.selectedVersionDetail = null;\n    },\n    /**\n     * Cierra el modal de historial de versiones\n     */\n    closeVersionHistoryModal() {\n      this.showVersionHistoryModal = false;\n      this.selectedVersionDetail = null;\n    },\n    /**\n     * Muestra los detalles de una versi√≥n\n     */\n    viewVersionDetail(version) {\n      this.selectedVersionDetail = version;\n    },\n    /**\n     * Restaura la versi√≥n seleccionada\n     */\n    restoreSelectedVersion() {\n      if (this.selectedVersionDetail) {\n        this.restoreVersion(this.selectedVersionDetail.id);\n      }\n    },\n    /**\n     * Guarda una versi√≥n manualmente\n     */\n    manualSaveVersion() {\n      const description = prompt('Describe los cambios de esta versi√≥n:', `Guardado manual - ${new Date().toLocaleString()}`);\n      if (description && description.trim()) {\n        const versionId = this.captureVersion(description.trim());\n        if (versionId) {\n          this.showStatus(`‚úÖ Versi√≥n guardada: \"${description}\"`, 'success');\n        }\n      }\n    },\n    // ============ M√âTODOS EXISTENTES DEL EDITOR ============\n    // (Tus m√©todos originales se mantienen igual, solo agregu√© markAsChanged() donde correspond√≠a)\n\n    initializeEditors() {\n      // Configuraci√≥n base para todos los editores\n      const commonExtensionsBase = [StarterKit.configure({\n        hardBreak: {\n          keepMarks: true\n        },\n        bulletList: {\n          HTMLAttributes: {\n            class: 'bullet-list'\n          }\n        },\n        codeBlock: {\n          HTMLAttributes: {\n            class: 'code-block'\n          }\n        }\n      }), Heading.configure({\n        levels: [1, 2, 3],\n        HTMLAttributes: {\n          class: 'tiptap-heading'\n        }\n      }), Underline, Strike, HardBreak.configure({\n        keepMarks: true\n      }), Blockquote.configure({\n        HTMLAttributes: {\n          class: 'blockquote'\n        }\n      }), CodeBlock.configure({\n        languageClassPrefix: 'language-'\n      }), TextAlign.configure({\n        types: ['heading', 'paragraph'],\n        alignments: ['left', 'center', 'right', 'justify'],\n        defaultAlignment: 'left'\n      }), OrderedList.configure({\n        HTMLAttributes: {\n          class: 'ordered-list'\n        }\n      })];\n      const createEditor = placeholder => {\n        const extensions = [...commonExtensionsBase, Placeholder.configure({\n          placeholder: ({\n            node\n          }) => {\n            if (node.type.name === 'heading') return 'T√≠tulo...';\n            if (node.type.name === 'codeBlock') return 'Escribe tu c√≥digo aqu√≠...';\n            if (node.type.name === 'blockquote') return 'Escribe una cita...';\n            return placeholder || 'Escribe tu contenido aqu√≠...';\n          }\n        }), LetterListExtension];\n        return new Editor({\n          content: '',\n          extensions: extensions,\n          onUpdate: () => {\n            // markAsChanged ya se maneja en setupChangeDetection\n          },\n          onCreate: () => {\n            console.log('Editor inicializado');\n          },\n          editorProps: {\n            attributes: {\n              class: 'prose prose-sm sm:prose lg:prose-lg xl:prose-2xl mx-auto focus:outline-none',\n              style: 'min-height: 120px; white-space: pre-line;'\n            },\n            handleKeyDown: (view, event) => {\n              // Atajos de teclado...\n              // Ctrl+B - Negrita\n              if (event.ctrlKey && event.key === 'b') {\n                event.preventDefault();\n                view.dispatch(view.state.tr.setMark(view.state.selection.from, view.state.selection.to, view.state.schema.marks.bold));\n                this.markAsChanged();\n                return true;\n              }\n\n              // Ctrl+I - Cursiva\n              if (event.ctrlKey && event.key === 'i') {\n                event.preventDefault();\n                view.dispatch(view.state.tr.setMark(view.state.selection.from, view.state.selection.to, view.state.schema.marks.italic));\n                this.markAsChanged();\n                return true;\n              }\n\n              // Ctrl+U - Subrayado\n              if (event.ctrlKey && event.key === 'u') {\n                event.preventDefault();\n                view.dispatch(view.state.tr.setMark(view.state.selection.from, view.state.selection.to, view.state.schema.marks.underline));\n                this.markAsChanged();\n                return true;\n              }\n\n              // Ctrl+Shift+S - Tachado\n              if (event.ctrlKey && event.shiftKey && event.key === 's') {\n                event.preventDefault();\n                view.dispatch(view.state.tr.setMark(view.state.selection.from, view.state.selection.to, view.state.schema.marks.strike));\n                this.markAsChanged();\n                return true;\n              }\n\n              // Ctrl+Z - Deshacer\n              if (event.ctrlKey && event.key === 'z') {\n                event.preventDefault();\n                view.dispatch(view.state.tr.undo());\n                this.markAsChanged();\n                return true;\n              }\n\n              // Ctrl+Y - Rehacer\n              if (event.ctrlKey && event.key === 'y') {\n                event.preventDefault();\n                view.dispatch(view.state.tr.redo());\n                this.markAsChanged();\n                return true;\n              }\n              return false;\n            }\n          }\n        });\n      };\n\n      // Inicializar secciones principales\n      this.sections.forEach((section, index) => {\n        const editor = createEditor(section.placeholder);\n        editor.on('update', () => {\n          this.sections[index].content = editor.getHTML();\n        });\n        section.editor = editor;\n      });\n\n      // Inicializar secciones restantes\n      this.remainingSections.forEach((section, index) => {\n        const editor = createEditor(section.placeholder);\n        editor.on('update', () => {\n          this.remainingSections[index].content = editor.getHTML();\n        });\n        section.editor = editor;\n      });\n\n      // Inicializar editor de procedimiento\n      this.procedimientoEditor = createEditor('Describe el procedimiento completo aqu√≠ en lenguaje natural...');\n      this.procedimientoEditor.on('update', () => {\n        // Actualizar contenido del procedimiento si es necesario\n      });\n    },\n    // M√©todo para aplicar estilos desde el select\n    applyStyle(editor, style) {\n      if (!editor) return;\n      switch (style) {\n        case 'paragraph':\n          editor.chain().focus().setParagraph().run();\n          break;\n        case 'h1':\n          editor.chain().focus().toggleHeading({\n            level: 1\n          }).run();\n          break;\n        case 'h2':\n          editor.chain().focus().toggleHeading({\n            level: 2\n          }).run();\n          break;\n        case 'h3':\n          editor.chain().focus().toggleHeading({\n            level: 3\n          }).run();\n          break;\n        case 'blockquote':\n          editor.chain().focus().toggleBlockquote().run();\n          break;\n        case 'code':\n          editor.chain().focus().toggleCodeBlock().run();\n          break;\n      }\n      this.markAsChanged();\n    },\n    // M√©todo para obtener el estilo actual del cursor\n    getCurrentStyle(editor) {\n      if (!editor) return 'paragraph';\n      if (editor.isActive('heading', {\n        level: 1\n      })) return 'h1';\n      if (editor.isActive('heading', {\n        level: 2\n      })) return 'h2';\n      if (editor.isActive('heading', {\n        level: 3\n      })) return 'h3';\n      if (editor.isActive('blockquote')) return 'blockquote';\n      if (editor.isActive('codeBlock')) return 'code';\n      return 'paragraph';\n    },\n    // M√©todo para alternar lista con letras\n    toggleLetterList(editor) {\n      if (!editor) return;\n      if (editor.isActive('bulletList', {\n        'data-type': 'letter'\n      })) {\n        editor.chain().focus().updateAttributes('bulletList', {\n          'data-type': null\n        }).run();\n      } else if (editor.isActive('bulletList')) {\n        editor.chain().focus().updateAttributes('bulletList', {\n          'data-type': 'letter'\n        }).run();\n      } else {\n        editor.chain().focus().toggleBulletList().updateAttributes('bulletList', {\n          'data-type': 'letter'\n        }).run();\n      }\n      this.markAsChanged();\n    },\n    // M√©todo central para togglear vi√±etas normales\n    toggleBulletList(editor) {\n      if (!editor) return;\n      if (editor.isActive('bulletList', {\n        'data-type': 'letter'\n      })) {\n        editor.chain().focus().updateAttributes('bulletList', {\n          'data-type': null\n        }).run();\n      } else {\n        editor.chain().focus().toggleBulletList().run();\n      }\n      this.markAsChanged();\n    },\n    destroyEditors() {\n      this.sections.forEach(section => {\n        if (section.editor) {\n          section.editor.destroy();\n          section.editor = null;\n        }\n      });\n      this.remainingSections.forEach(section => {\n        if (section.editor) {\n          section.editor.destroy();\n          section.editor = null;\n        }\n      });\n      if (this.procedimientoEditor) {\n        this.procedimientoEditor.destroy();\n        this.procedimientoEditor = null;\n      }\n    },\n    clearSection(section) {\n      if (section.editor) {\n        section.editor.commands.clearContent();\n        this.markAsChanged();\n        this.showStatus('Secci√≥n limpiada', 'info');\n      }\n    },\n    clearProcedimiento() {\n      if (this.procedimientoEditor) {\n        this.procedimientoEditor.commands.clearContent();\n        this.generatedTable = [];\n        this.markAsChanged();\n        this.showStatus('Procedimiento limpiado', 'info');\n      }\n    },\n    getFormattedDate() {\n      const today = new Date();\n      const year = today.getFullYear();\n      const month = String(today.getMonth() + 1).padStart(2, '0');\n      const day = String(today.getDate()).padStart(2, '0');\n      return `${year}-${month}-${day}`;\n    },\n    loadExampleProcedimiento() {\n      if (!this.procedimientoEditor) return;\n      const exampleText = `El administrador revisa la lista de proveedores a pagar\nEl administrador env√≠a la lista al gerente general para revisi√≥n\nEl gerente general revisa la lista de proveedores\n¬øLa lista est√° correcta?\nSi est√° correcta, el gerente general realiza el pago a los proveedores\na) Verifica disponibilidad de fondos\nb) Prepara √≥rdenes de pago\nc) Registra en el sistema contable\nSi no est√° correcta, el gerente general devuelve la lista al administrador\nEl administrador verifica y corrige la informaci√≥n de los proveedores\n5.1.1 Consulta base de datos de proveedores\n5.1.2 Actualiza informaci√≥n faltante\n5.1.3 Valida documentos de respaldo\nEl administrador actualiza la lista con la informaci√≥n corregida\nEl proceso se repite desde el env√≠o al gerente general\nFin del proceso`;\n      const formattedContent = exampleText.split('\\n').map(line => {\n        if (line.trim() === '') return '<p></p>';\n        if (/^[a-z]\\)/.test(line.trim())) {\n          return `<ul data-type=\"letter\"><li>${line.replace(/^[a-z]\\)\\s*/, '')}</li></ul>`;\n        }\n        if (/^\\d+\\.\\d+\\.\\d+/.test(line.trim())) {\n          return `<ul><li>${line}</li></ul>`;\n        }\n        return `<p>${line}</p>`;\n      }).join('');\n      this.procedimientoEditor.commands.setContent(formattedContent);\n      this.markAsChanged();\n      this.showStatus('üìù Ejemplo con subsecciones cargado. Haz clic en \"Generar Tabla Autom√°ticamente\" para ver el resultado.', 'info');\n    },\n    parseProcedimiento() {\n      if (!this.procedimientoEditor) return;\n      const textContent = this.procedimientoEditor.getText();\n      if (!textContent.trim()) {\n        this.showStatus('‚ùå Por favor ingresa la descripci√≥n del procedimiento', 'error');\n        return;\n      }\n      try {\n        const lines = textContent.split('\\n').filter(line => line.trim() !== '');\n        const table = [];\n        let stepNumber = 1;\n        let subStepNumber = 0;\n        let currentMainStep = null;\n        for (let i = 0; i < lines.length; i++) {\n          const line = lines[i].trim();\n          if (line === '') continue;\n          if (this.isSubsectionStarter(line)) {\n            if (currentMainStep) {\n              subStepNumber++;\n              const fullNumber = `${currentMainStep}.${subStepNumber}`;\n              const responsible = this.extractResponsible(line);\n              const activity = this.extractActivity(line, responsible);\n              table.push({\n                number: fullNumber,\n                who: responsible,\n                activity: activity,\n                level: 'sub'\n              });\n            } else {\n              const responsible = this.extractResponsible(line);\n              const activity = this.extractActivity(line, responsible);\n              table.push({\n                number: `${stepNumber}`,\n                who: responsible,\n                activity: activity\n              });\n              stepNumber++;\n              subStepNumber = 0;\n            }\n          } else if (this.isMainProcessLine(line)) {\n            table.push({\n              number: '',\n              who: '',\n              activity: line,\n              level: 'section'\n            });\n            currentMainStep = null;\n            subStepNumber = 0;\n          } else if (line.startsWith('¬ø')) {\n            table.push({\n              number: '',\n              who: '',\n              activity: line,\n              level: 'question'\n            });\n            currentMainStep = null;\n            subStepNumber = 0;\n          } else if (line.toLowerCase().startsWith('si ') || line.toLowerCase().startsWith('no ') || line.toLowerCase().startsWith('si,') || line.toLowerCase().startsWith('no,')) {\n            table.push({\n              number: '',\n              who: '',\n              activity: line,\n              level: 'alternative'\n            });\n            currentMainStep = null;\n            subStepNumber = 0;\n          } else if (line.toLowerCase().includes('fin del proceso')) {\n            table.push({\n              number: '',\n              who: '',\n              activity: 'Fin del Proceso',\n              level: 'end'\n            });\n            currentMainStep = null;\n            subStepNumber = 0;\n          } else {\n            const responsible = this.extractResponsible(line);\n            const activity = this.extractActivity(line, responsible);\n            if (responsible || activity) {\n              table.push({\n                number: `${stepNumber}`,\n                who: responsible,\n                activity: activity\n              });\n              currentMainStep = stepNumber;\n              stepNumber++;\n              subStepNumber = 0;\n            }\n          }\n        }\n        this.generatedTable = table;\n        this.markAsChanged();\n        this.showStatus('‚úÖ Tabla generada autom√°ticamente desde la descripci√≥n', 'success');\n      } catch (error) {\n        this.showStatus('‚ùå Error al procesar la descripci√≥n: ' + error.message, 'error');\n      }\n    },\n    isSubsectionStarter(line) {\n      const subsectionPatterns = [/^\\d+\\.\\d+\\.\\d+/, /^[a-z]\\)/, /^[ivx]+\\)/, /^‚Ä¢\\s/, /^-\\s/, /^‚Üí\\s/, /^subpaso\\s\\d+/i, /^detalle\\s\\d+/i];\n      return subsectionPatterns.some(pattern => pattern.test(line.toLowerCase()));\n    },\n    isMainProcessLine(line) {\n      return !line.startsWith('¬ø') && !line.toLowerCase().startsWith('si ') && !line.toLowerCase().startsWith('no ') && !line.toLowerCase().startsWith('si,') && !line.toLowerCase().startsWith('no,') && !line.toLowerCase().includes('fin del proceso') && !this.extractResponsible(line) && !this.isSubsectionStarter(line) && line.length > 10;\n    },\n    extractResponsible(line) {\n      const patterns = [/^el (\\w+)/i, /^la (\\w+)/i, /^los (\\w+)/i, /^las (\\w+)/i, /^un (\\w+)/i, /^una (\\w+)/i, /^(\\w+) (revisa|env√≠a|realiza|verifica|corrige|aprueba|autoriza)/i];\n      for (const pattern of patterns) {\n        const match = line.match(pattern);\n        if (match) {\n          return this.capitalizeFirstLetter(match[1] || match[2]);\n        }\n      }\n      return '';\n    },\n    extractActivity(line, responsible) {\n      if (!responsible) return line;\n      const respRaw = String(responsible).trim();\n      const respEscaped = respRaw.replace(/[.*+?^${}()|[\\]\\\\]/g, '\\\\$&');\n      const removePattern = new RegExp(`^(el\\\\s+${respEscaped}|la\\\\s+${respEscaped}|los\\\\s+${respEscaped}|las\\\\s+${respEscaped}|${respEscaped})\\\\s+`, 'i');\n      let activity = line.replace(removePattern, '').trim();\n      if (!activity) return '';\n      return activity.charAt(0).toUpperCase() + activity.slice(1);\n    },\n    capitalizeFirstLetter(string) {\n      return string.charAt(0).toUpperCase() + string.slice(1);\n    },\n    getRowClass(row) {\n      if (row.level === 'section') return 'section-row';\n      if (row.level === 'sub') return 'subsection-row';\n      if (row.level === 'question') return 'question-row';\n      if (row.level === 'alternative') return 'alternative-row';\n      if (row.level === 'end') return 'end-row';\n      if (!row.number && !row.who && !row.activity) return 'empty-row';\n      return 'normal-row';\n    },\n    async generateWordDocument() {\n      // Capturar versi√≥n antes de generar\n      this.captureVersion('Versi√≥n antes de generar Word');\n      this.isGenerating = true;\n      const procedimientoText = this.procedimientoEditor ? this.procedimientoEditor.getText() : '';\n      if (procedimientoText && this.generatedTable.length === 0) {\n        this.parseProcedimiento();\n      }\n      const documentData = {\n        headerConfig: this.headerConfig,\n        objetivo: this.sections[0].editor.getHTML(),\n        alcance: this.sections[1].editor.getHTML(),\n        responsabilidades: this.sections[2].editor.getHTML(),\n        normativa: this.sections[3].editor.getHTML(),\n        anexos: this.remainingSections[0].editor.getHTML(),\n        terminos: this.remainingSections[1].editor.getHTML()\n      };\n      try {\n        await generateWordDocument(documentData, this.generatedTable);\n        this.showStatus('‚úÖ Documento Word generado exitosamente!', 'success');\n      } catch (error) {\n        console.error('Error generating document:', error);\n        this.showStatus('‚ùå Error al generar el documento: ' + error.message, 'error');\n      } finally {\n        this.isGenerating = false;\n      }\n    },\n    resetDocument() {\n      this.showResetModal = true;\n    },\n    closeResetModal() {\n      this.showResetModal = false;\n    },\n    confirmReset() {\n      this.showResetModal = false;\n      this.executeReset();\n\n      // Capturar versi√≥n despu√©s del reset\n      this.captureVersion('Documento reseteado');\n      this.showStatus('üóëÔ∏è Todo el contenido ha sido resetado', 'info');\n    },\n    executeReset() {\n      this.sections.forEach(section => {\n        if (section.editor) {\n          section.editor.commands.clearContent();\n        }\n      });\n      this.remainingSections.forEach(section => {\n        if (section.editor) {\n          section.editor.commands.clearContent();\n        }\n      });\n      if (this.procedimientoEditor) {\n        this.procedimientoEditor.commands.clearContent();\n      }\n      this.generatedTable = [];\n      this.headerConfig = {\n        manualName: '',\n        policyName: '',\n        codigo: '',\n        area: '',\n        unidad: '',\n        revision: '',\n        fecha: this.getFormattedDate()\n      };\n      this.hasUnsavedChanges = true;\n    },\n    showStatus(message, type) {\n      this.statusMessage = message;\n      this.statusType = type;\n      setTimeout(() => {\n        this.statusMessage = '';\n        this.statusType = '';\n      }, 5000);\n    }\n  }\n};","map":{"version":3,"names":["generateWordDocument","Editor","EditorContent","StarterKit","Heading","Underline","Strike","Placeholder","HardBreak","BulletList","OrderedList","Blockquote","CodeBlock","TextAlign","LetterListExtension","extend","addAttributes","default","parseHTML","element","getAttribute","renderHTML","attributes","name","components","data","showResetModal","showVersionHistoryModal","selectedVersionDetail","headerConfig","manualName","policyName","codigo","area","unidad","revision","fecha","getFormattedDate","sections","title","description","placeholder","content","editor","remainingSections","generatedTable","procedimientoEditor","documentVersions","currentVersionIndex","maxVersions","versionHistory","documentId","hasUnsavedChanges","lastSavedTime","autoSaveEnabled","autoSaveInterval","autoSaveFrequency","statusMessage","statusType","isGenerating","computed","procedureTable","documentStats","wordCount","calculateTotalWordCount","completion","calculateDocumentCompletion","length","procedureSteps","lastVersion","formatDate","timestamp","mounted","$nextTick","initializeEditors","initializeVersionSystem","setupAutoVersioning","window","addEventListener","handleBeforeUnload","beforeUnmount","destroyEditors","stopAutoSave","removeEventListener","methods","Date","now","Math","random","toString","substr","loadVersionsFromStorage","captureVersion","setupChangeDetection","console","log","versionData","createVersionSnapshot","unshift","pop","action","versionId","id","toISOString","user","saveVersionsToStorage","error","JSON","parse","stringify","map","section","getHTML","text","getText","procedimiento","table","preview","generateVersionPreview","snippet","substring","words","restoreVersion","versionIndex","findIndex","v","showStatus","version","confirm","forEach","index","commands","setContent","deleteVersion","splice","versions","history","currentIndex","lastUpdated","localStorage","setItem","saved","getItem","setInterval","toLocaleTimeString","clearInterval","editors","s","filter","Boolean","on","markAsChanged","event","preventDefault","returnValue","count","split","word","completedSections","totalSections","trim","round","dateString","date","toLocaleString","day","month","year","hour","minute","openVersionHistoryModal","closeVersionHistoryModal","viewVersionDetail","restoreSelectedVersion","manualSaveVersion","prompt","commonExtensionsBase","configure","hardBreak","keepMarks","bulletList","HTMLAttributes","class","codeBlock","levels","languageClassPrefix","types","alignments","defaultAlignment","createEditor","extensions","node","type","onUpdate","onCreate","editorProps","style","handleKeyDown","view","ctrlKey","key","dispatch","state","tr","setMark","selection","from","to","schema","marks","bold","italic","underline","shiftKey","strike","undo","redo","applyStyle","chain","focus","setParagraph","run","toggleHeading","level","toggleBlockquote","toggleCodeBlock","getCurrentStyle","isActive","toggleLetterList","updateAttributes","toggleBulletList","destroy","clearSection","clearContent","clearProcedimiento","today","getFullYear","String","getMonth","padStart","getDate","loadExampleProcedimiento","exampleText","formattedContent","line","test","replace","join","parseProcedimiento","textContent","lines","stepNumber","subStepNumber","currentMainStep","i","isSubsectionStarter","fullNumber","responsible","extractResponsible","activity","extractActivity","push","number","who","isMainProcessLine","startsWith","toLowerCase","includes","message","subsectionPatterns","some","pattern","patterns","match","capitalizeFirstLetter","respRaw","respEscaped","removePattern","RegExp","charAt","toUpperCase","slice","string","getRowClass","row","procedimientoText","documentData","objetivo","alcance","responsabilidades","normativa","anexos","terminos","resetDocument","closeResetModal","confirmReset","executeReset","setTimeout"],"sources":["/home/jorge/Escritorio/Jorge-PC/procesos/procesos/src/views/DocumentView.vue"],"sourcesContent":["<template>\n  <div class=\"document-view\">\n    <!-- Modal de confirmaci√≥n mejorado -->\n    <div v-if=\"showResetModal\" class=\"modal-overlay\" @click.self=\"closeResetModal\">\n      <div class=\"modal-container\">\n        <div class=\"modal-header\">\n          <h3 class=\"modal-title\">Confirmar Limpieza</h3>\n          <button class=\"modal-close-btn\" @click=\"closeResetModal\">\n            <span>√ó</span>\n          </button>\n        </div>\n        \n        <div class=\"modal-content\">\n          <p class=\"modal-message\">¬øEst√°s seguro de que quieres limpiar todo el documento?</p>\n          <p class=\"modal-warning\">Se perder√°n todos los cambios no guardados.</p>\n        </div>\n        \n        <div class=\"modal-actions\">\n          <button class=\"modal-btn modal-btn-cancel\" @click=\"closeResetModal\">\n            Cancelar\n          </button>\n          <button class=\"modal-btn modal-btn-confirm\" @click=\"confirmReset\">\n            Limpiar Todo\n          </button>\n        </div>\n      </div>\n    </div>\n\n    <!-- Modal de Historial de Versiones -->\n    <div v-if=\"showVersionHistoryModal\" class=\"modal-overlay\" @click.self=\"closeVersionHistoryModal\">\n      <div class=\"modal-container version-history-modal\">\n        <div class=\"modal-header\">\n          <h3 class=\"modal-title\">üïê Historial de Versiones</h3>\n          <button class=\"modal-close-btn\" @click=\"closeVersionHistoryModal\">\n            <span>√ó</span>\n          </button>\n        </div>\n        \n        <div class=\"modal-content\">\n          <!-- Lista de versiones -->\n          <div v-if=\"!selectedVersionDetail\" class=\"versions-list\">\n            <div v-for=\"(version, index) in documentVersions\" \n                 :key=\"version.id\" \n                 class=\"version-item\"\n                 :class=\"{ 'current-version': index === currentVersionIndex }\">\n              \n              <div class=\"version-header\" @click=\"viewVersionDetail(version)\">\n                <div class=\"version-meta\">\n                  <span class=\"version-time\">{{ formatDate(version.timestamp) }}</span>\n                  <span class=\"version-badge\" v-if=\"index === currentVersionIndex\">Actual</span>\n                </div>\n                \n                <div class=\"version-description\">{{ version.description }}</div>\n                \n                <div class=\"version-stats\">\n                  <span class=\"stat\">\n                    üìù {{ version.preview.words }} palabras\n                  </span>\n                  <span class=\"stat\">\n                    üìä {{ version.preview.completion }}% completado\n                  </span>\n                </div>\n              </div>\n              \n              <div class=\"version-actions\">\n                <button @click=\"restoreVersion(version.id)\" \n                        class=\"action-btn restore-btn\"\n                        title=\"Restaurar esta versi√≥n\">\n                  üîÑ Restaurar\n                </button>\n                \n                <button @click=\"deleteVersion(version.id)\" \n                        class=\"action-btn delete-btn\"\n                        title=\"Eliminar versi√≥n\"\n                        v-if=\"documentVersions.length > 1\">\n                  üóëÔ∏è Eliminar\n                </button>\n                \n                <button @click=\"viewVersionDetail(version)\" \n                        class=\"action-btn view-btn\">\n                  üëÅÔ∏è Detalles\n                </button>\n              </div>\n            </div>\n            \n            <div v-if=\"documentVersions.length === 0\" class=\"empty-state\">\n              <p>No hay versiones guardadas todav√≠a.</p>\n              <button @click=\"manualSaveVersion\" class=\"primary-btn\">\n                üíæ Guardar primera versi√≥n\n              </button>\n            </div>\n          </div>\n          \n          <!-- Vista detallada de una versi√≥n -->\n          <div v-else class=\"version-detail\">\n            <button @click=\"selectedVersionDetail = null\" class=\"back-btn\">\n              ‚Üê Volver al listado\n            </button>\n            \n            <h4>Versi√≥n: {{ selectedVersionDetail.description }}</h4>\n            <p class=\"detail-time\">Guardada el: {{ formatDate(selectedVersionDetail.timestamp) }}</p>\n            \n            <div class=\"detail-grid\">\n              <div class=\"detail-section\">\n                <h5>üìã Vista Previa</h5>\n                <p class=\"preview-text\">{{ selectedVersionDetail.preview.snippet }}</p>\n                <p class=\"preview-title\"><strong>T√≠tulo:</strong> {{ selectedVersionDetail.preview.title }}</p>\n              </div>\n              \n              <div class=\"detail-section\">\n                <h5>üìä Estad√≠sticas</h5>\n                <ul class=\"stats-list\">\n                  <li><strong>Palabras:</strong> {{ selectedVersionDetail.preview.words }}</li>\n                  <li><strong>Completado:</strong> {{ selectedVersionDetail.preview.completion }}%</li>\n                  <li><strong>Secciones:</strong> {{ selectedVersionDetail.preview.sections }}</li>\n                  <li><strong>Pasos en procedimiento:</strong> {{ selectedVersionDetail.preview.procedureSteps }}</li>\n                </ul>\n              </div>\n              \n              <div class=\"detail-section full-width\">\n                <h5>üìù Encabezado</h5>\n                <pre class=\"header-preview\">{{ JSON.stringify(selectedVersionDetail.data.headerConfig, null, 2) }}</pre>\n              </div>\n            </div>\n            \n            <div class=\"detail-actions\">\n              <button @click=\"restoreSelectedVersion\" \n                      class=\"primary-btn restore-btn\">\n                üîÑ Restaurar esta versi√≥n\n              </button>\n            </div>\n          </div>\n        </div>\n        \n        <div class=\"modal-actions\">\n          <button @click=\"manualSaveVersion\" class=\"modal-btn modal-btn-secondary\">\n            üíæ Guardar versi√≥n manual\n          </button>\n          <button @click=\"closeVersionHistoryModal\" class=\"modal-btn modal-btn-primary\">\n            Cerrar\n          </button>\n        </div>\n      </div>\n    </div>\n\n    <!-- Barra de control de versiones -->\n    <div class=\"version-control-bar\">\n      <button @click=\"openVersionHistoryModal\" class=\"version-btn\">\n        üïê Historial de versiones\n        <span class=\"badge\" v-if=\"documentVersions.length > 0\">\n          {{ documentVersions.length }}\n        </span>\n      </button>\n      \n      <button @click=\"manualSaveVersion\" class=\"save-version-btn\">\n        üíæ Guardar versi√≥n\n      </button>\n      \n      <div class=\"version-info\" v-if=\"documentVersions.length > 0 && lastSavedTime\">\n        <span class=\"last-save\">\n          √öltima versi√≥n: {{ formatDate(lastSavedTime) }}\n        </span>\n      </div>\n      \n      <div class=\"auto-save-status\" :class=\"{ active: autoSaveEnabled }\">\n        <span class=\"status-dot\"></span>\n        {{ autoSaveEnabled ? 'Autoguardado activo' : 'Autoguardado pausado' }}\n      </div>\n    </div>\n\n    <div class=\"status-message\" v-if=\"statusMessage\" :class=\"statusType\">\n      {{ statusMessage }}\n    </div>\n\n    <div class=\"document-editor\">\n      <!-- Configuraci√≥n del Encabezado -->\n      <div class=\"section header-config\">\n        <h3> Configuraci√≥n del Encabezado del Documento</h3>\n        <div class=\"header-fields\">\n          <div class=\"field-group\">\n            <label>Manual de Pol√≠ticas y Procedimientos:</label>\n            <input v-model=\"headerConfig.manualName\" placeholder=\"Ingrese el nombre del manual\" class=\"header-input\" @input=\"markAsChanged\">\n          </div>\n          <div class=\"field-group\">\n            <label>POL√çTICA O PROCEDIMIENTO DE:</label>\n            <input v-model=\"headerConfig.policyName\" placeholder=\"Ingrese el nombre del procedimiento\" class=\"header-input\" @input=\"markAsChanged\">\n          </div>\n          <div class=\"field-group\">\n            <label>C√ìDIGO:</label>\n            <input v-model=\"headerConfig.codigo\" placeholder=\"Ej: XX-P-XXX-#\" class=\"header-input\" @input=\"markAsChanged\">\n          </div>\n          <div class=\"field-group\">\n            <label>√Årea:</label>\n            <input v-model=\"headerConfig.area\" placeholder=\"Ej: Administraci√≥n\" class=\"header-input\" @input=\"markAsChanged\">\n          </div>\n          <div class=\"field-group\">\n            <label>Unidad:</label>\n            <input v-model=\"headerConfig.unidad\" placeholder=\"Ej: Finanzas\" class=\"header-input\" @input=\"markAsChanged\">\n          </div>\n          <div class=\"field-group\">\n            <label>Revisi√≥n:</label>\n            <input v-model=\"headerConfig.revision\" placeholder=\"Ej: 01\" class=\"header-input\" @input=\"markAsChanged\">\n          </div>\n          <div class=\"field-group\">\n            <label>Fecha:</label>\n            <input v-model=\"headerConfig.fecha\" type=\"date\" class=\"header-input\" @input=\"markAsChanged\">\n          </div>\n        </div>\n      </div>\n\n      <!-- Secciones editables del contenido -->\n      <div class=\"section\" v-for=\"(section, index) in sections\" :key=\"index\">\n        <h3>{{ section.title }}</h3>\n        <div class=\"section-description\">\n          <p>{{ section.description }}</p>\n        </div>\n        \n        <div class=\"rich-text-editor\">\n          <div class=\"toolbar\">\n            <!-- Grupo de formato de texto -->\n            <div class=\"toolbar-group\">\n              <button\n                class=\"toolbar-btn\"\n                :class=\"{ 'active': section.editor?.isActive('bold') }\"\n                @click=\"section.editor?.chain().focus().toggleBold().run(); markAsChanged()\"\n                title=\"Negrita (Ctrl+B)\"\n              >\n                <strong>B</strong>\n              </button>\n              \n              <button\n                class=\"toolbar-btn\"\n                :class=\"{ 'active': section.editor?.isActive('italic') }\"\n                @click=\"section.editor?.chain().focus().toggleItalic().run(); markAsChanged()\"\n                title=\"Cursiva (Ctrl+I)\"\n              >\n                <em>I</em>\n              </button>\n              \n              <button\n                class=\"toolbar-btn\"\n                :class=\"{ 'active': section.editor?.isActive('underline') }\"\n                @click=\"section.editor?.chain().focus().toggleUnderline().run(); markAsChanged()\"\n                title=\"Subrayado (Ctrl+U)\"\n              >\n                <u>U</u>\n              </button>\n              \n              <button\n                class=\"toolbar-btn\"\n                :class=\"{ 'active': section.editor?.isActive('strike') }\"\n                @click=\"section.editor?.chain().focus().toggleStrike().run(); markAsChanged()\"\n                title=\"Tachado (Ctrl+Shift+S)\"\n              >\n                <s>S</s>\n              </button>\n            </div>\n            \n            <div class=\"toolbar-separator\"></div>\n            \n            <!-- Grupo de estilos de p√°rrafo -->\n            <div class=\"toolbar-group\">\n              <select \n                class=\"style-select\"\n                @change=\"applyStyle(section.editor, $event.target.value); markAsChanged()\"\n                :value=\"getCurrentStyle(section.editor)\"\n                title=\"Estilo de p√°rrafo\"\n              >\n                <option value=\"paragraph\">P√°rrafo normal</option>\n                <option value=\"h1\">T√≠tulo 1</option>\n                <option value=\"h2\">T√≠tulo 2</option>\n                <option value=\"h3\">T√≠tulo 3</option>\n                <option value=\"blockquote\">Cita</option>\n                <option value=\"code\">C√≥digo</option>\n              </select>\n              \n              <button\n                class=\"toolbar-btn\"\n                :class=\"{ 'active': section.editor?.isActive('paragraph') && !section.editor?.isActive('heading') && !section.editor?.isActive('blockquote') && !section.editor?.isActive('codeBlock') }\"\n                @click=\"section.editor?.chain().focus().setParagraph().run(); markAsChanged()\"\n                title=\"P√°rrafo normal\"\n              >\n                <span class=\"icon-text\">¬∂</span>\n              </button>\n            </div>\n            \n            <div class=\"toolbar-separator\"></div>\n            \n            <!-- Grupo de alineaci√≥n -->\n            <div class=\"toolbar-group\">\n              <button\n                class=\"toolbar-btn\"\n                :class=\"{ 'active': section.editor?.isActive({ textAlign: 'left' }) }\"\n                @click=\"section.editor?.chain().focus().setTextAlign('left').run(); markAsChanged()\"\n                title=\"Alinear a la izquierda\"\n              >\n                <font-awesome-icon icon=\"align-left\" />\n              </button>\n              \n              <button\n                class=\"toolbar-btn\"\n                :class=\"{ 'active': section.editor?.isActive({ textAlign: 'center' }) }\"\n                @click=\"section.editor?.chain().focus().setTextAlign('center').run(); markAsChanged()\"\n                title=\"Centrar\"\n              >\n                <font-awesome-icon icon=\"align-center\" />\n              </button>\n              \n              <button\n                class=\"toolbar-btn\"\n                :class=\"{ 'active': section.editor?.isActive({ textAlign: 'right' }) }\"\n                @click=\"section.editor?.chain().focus().setTextAlign('right').run(); markAsChanged()\"\n                title=\"Alinear a la derecha\"\n              >\n                <font-awesome-icon icon=\"align-right\" />\n              </button>\n              \n              <button\n                class=\"toolbar-btn\"\n                :class=\"{ 'active': section.editor?.isActive({ textAlign: 'justify' }) }\"\n                @click=\"section.editor?.chain().focus().setTextAlign('justify').run(); markAsChanged()\"\n                title=\"Justificar\"\n              >\n                <font-awesome-icon icon=\"align-justify\" />\n              </button>\n            </div>\n            \n            <div class=\"toolbar-separator\"></div>\n            \n            <!-- Grupo de listas -->\n            <div class=\"toolbar-group\">\n              <button\n                class=\"toolbar-btn\"\n                :class=\"{ 'active': section.editor?.isActive('bulletList') && !section.editor?.isActive('bulletList', { 'data-type': 'letter' }) }\"\n                @click=\"toggleBulletList(section.editor); markAsChanged()\"\n                title=\"Lista con vi√±etas\"\n              >\n                <span>‚Ä¢</span>\n              </button>\n              \n              <button\n                class=\"toolbar-btn\"\n                :class=\"{ 'active': section.editor?.isActive('orderedList') }\"\n                @click=\"section.editor?.chain().focus().toggleOrderedList().run(); markAsChanged()\"\n                title=\"Lista numerada\"\n              >\n                <span>1.</span>\n              </button>\n\n              <button\n                class=\"toolbar-btn\"\n                :class=\"{ 'active': section.editor?.isActive('bulletList', { 'data-type': 'letter' }) }\"\n                @click=\"toggleLetterList(section.editor); markAsChanged()\"\n                title=\"Lista con letras\"\n              >\n                <span>a)</span>\n              </button>\n            </div>\n            \n            <div class=\"toolbar-separator\"></div>\n            \n            <!-- Grupo de herramientas -->\n            <div class=\"toolbar-group\">\n              <button\n                class=\"toolbar-btn\"\n                @click=\"section.editor?.chain().focus().undo().run()\"\n                title=\"Deshacer (Ctrl+Z)\"\n              >\n                ‚Ü∂\n              </button>\n              \n              <button\n                class=\"toolbar-btn\"\n                @click=\"section.editor?.chain().focus().redo().run()\"\n                title=\"Rehacer (Ctrl+Y)\"\n              >\n                ‚Ü∑\n              </button>\n              \n              <button\n                class=\"toolbar-btn\"\n                @click=\"clearSection(section)\"\n                title=\"Limpiar secci√≥n\"\n              >\n                √ó\n              </button>\n            </div>\n          </div>\n          \n          <editor-content \n            :editor=\"section.editor\" \n            class=\"editor-content\"\n            @input=\"markAsChanged\"\n          />\n        </div>\n      </div>\n\n      <!-- Secci√≥n de Procedimiento Mejorada -->\n      <div class=\"section\">\n        <h3>5. Procedimiento</h3>\n        <div class=\"section-description\">\n          <p><strong>Instrucciones para describir el procedimiento:</strong></p>\n          <ul>\n            <li><strong>Escribe en lenguaje natural</strong> c√≥mo se realiza el proceso</li>\n            <li><strong>Menciona los responsables</strong> y sus actividades</li>\n            <li><strong>Incluye decisiones</strong> (si algo est√° correcto o no)</li>\n            <li><strong>Describe alternativas</strong> (qu√© pasa si algo sale bien o mal)</li>\n            <li><strong>El sistema generar√° autom√°ticamente</strong> la numeraci√≥n continua (5.1, 5.2, 5.3...)</li>\n            <li><strong>Para subsecciones usa:</strong> 5.1.1, a), b), ‚Ä¢, -, ‚Üí, subpaso 1, etc.</li>\n            <li><strong>El encabezado aparecer√° en todas las p√°ginas</strong> del documento generado</li>\n          </ul>\n          <p><strong>Ejemplo de c√≥mo escribir con subsecciones:</strong></p>\n          <pre class=\"format-example\">\nEl administrador revisa la lista de proveedores a pagar\nEl administrador env√≠a la lista al gerente general para revisi√≥n\nEl gerente general revisa la lista de proveedores\n¬øLa lista est√° correcta?\nSi est√° correcta, el gerente general realiza el pago a los proveedores\na) Verifica disponibilidad de fondos\nb) Prepara √≥rdenes de pago\nc) Registra en el sistema contable\nSi no est√° correcta, el gerente general devuelve la lista al administrador\nEl administrador verifica y corrige la informaci√≥n de los proveedores\n5.1.1 Consulta base de datos de proveedores\n5.1.2 Actualiza informaci√≥n faltante\n5.1.3 Valida documentos de respaldo\nEl administrador actualiza la lista con la informaci√≥n corregida\nEl proceso se repite desde el env√≠o al gerente general\nFin del proceso\n          </pre>\n        </div>\n        \n        <div class=\"rich-text-editor\">\n          <div class=\"toolbar\">\n            <!-- Grupo de formato de texto -->\n            <div class=\"toolbar-group\">\n              <button\n                class=\"toolbar-btn\"\n                :class=\"{ 'active': procedimientoEditor?.isActive('bold') }\"\n                @click=\"procedimientoEditor?.chain().focus().toggleBold().run(); markAsChanged()\"\n                title=\"Negrita (Ctrl+B)\"\n              >\n                <strong>B</strong>\n              </button>\n              \n              <button\n                class=\"toolbar-btn\"\n                :class=\"{ 'active': procedimientoEditor?.isActive('italic') }\"\n                @click=\"procedimientoEditor?.chain().focus().toggleItalic().run(); markAsChanged()\"\n                title=\"Cursiva (Ctrl+I)\"\n              >\n                <em>I</em>\n              </button>\n              \n              <button\n                class=\"toolbar-btn\"\n                :class=\"{ 'active': procedimientoEditor?.isActive('underline') }\"\n                @click=\"procedimientoEditor?.chain().focus().toggleUnderline().run(); markAsChanged()\"\n                title=\"Subrayado (Ctrl+U)\"\n              >\n                <u>U</u>\n              </button>\n              \n              <button\n                class=\"toolbar-btn\"\n                :class=\"{ 'active': procedimientoEditor?.isActive('strike') }\"\n                @click=\"procedimientoEditor?.chain().focus().toggleStrike().run(); markAsChanged()\"\n                title=\"Tachado (Ctrl+Shift+S)\"\n              >\n                <s>S</s>\n              </button>\n            </div>\n            \n            <div class=\"toolbar-separator\"></div>\n            \n            <!-- Grupo de estilos de p√°rrafo -->\n            <div class=\"toolbar-group\">\n              <select \n                class=\"style-select\"\n                @change=\"applyStyle(procedimientoEditor, $event.target.value); markAsChanged()\"\n                :value=\"getCurrentStyle(procedimientoEditor)\"\n                title=\"Estilo de p√°rrafo\"\n              >\n                <option value=\"paragraph\">P√°rrafo normal</option>\n                <option value=\"h1\">T√≠tulo 1</option>\n                <option value=\"h2\">T√≠tulo 2</option>\n                <option value=\"h3\">T√≠tulo 3</option>\n                <option value=\"blockquote\">Cita</option>\n                <option value=\"code\">C√≥digo</option>\n              </select>\n              \n              <button\n                class=\"toolbar-btn\"\n                :class=\"{ 'active': procedimientoEditor?.isActive('paragraph') && !procedimientoEditor?.isActive('heading') && !procedimientoEditor?.isActive('blockquote') && !procedimientoEditor?.isActive('codeBlock') }\"\n                @click=\"procedimientoEditor?.chain().focus().setParagraph().run(); markAsChanged()\"\n                title=\"P√°rrafo normal\"\n              >\n                <span class=\"icon-text\">¬∂</span>\n              </button>\n            </div>\n            \n            <div class=\"toolbar-separator\"></div>\n            \n            <!-- Grupo de alineaci√≥n -->\n            <div class=\"toolbar-group\">\n              <button\n                class=\"toolbar-btn\"\n                :class=\"{ 'active': procedimientoEditor?.isActive({ textAlign: 'left' }) }\"\n                @click=\"procedimientoEditor?.chain().focus().setTextAlign('left').run(); markAsChanged()\"\n                title=\"Alinear a la izquierda\"\n              >\n                <font-awesome-icon icon=\"align-left\" />\n              </button>\n              \n              <button\n                class=\"toolbar-btn\"\n                :class=\"{ 'active': procedimientoEditor?.isActive({ textAlign: 'center' }) }\"\n                @click=\"procedimientoEditor?.chain().focus().setTextAlign('center').run(); markAsChanged()\"\n                title=\"Centrar\"\n              >\n                <font-awesome-icon icon=\"align-center\" />\n              </button>\n              \n              <button\n                class=\"toolbar-btn\"\n                :class=\"{ 'active': procedimientoEditor?.isActive({ textAlign: 'right' }) }\"\n                @click=\"procedimientoEditor?.chain().focus().setTextAlign('right').run(); markAsChanged()\"\n                title=\"Alinear a la derecha\"\n              >\n                <font-awesome-icon icon=\"align-right\" />\n              </button>\n              \n              <button\n                class=\"toolbar-btn\"\n                :class=\"{ 'active': procedimientoEditor?.isActive({ textAlign: 'justify' }) }\"\n                @click=\"procedimientoEditor?.chain().focus().setTextAlign('justify').run(); markAsChanged()\"\n                title=\"Justificar\"\n              >\n                <font-awesome-icon icon=\"align-justify\" />\n              </button>\n            </div>\n            \n            <div class=\"toolbar-separator\"></div>\n            \n            <!-- Grupo de listas -->\n            <div class=\"toolbar-group\">\n              <button\n                class=\"toolbar-btn\"\n                :class=\"{ 'active': procedimientoEditor?.isActive('bulletList') && !procedimientoEditor?.isActive('bulletList', { 'data-type': 'letter' }) }\"\n                @click=\"toggleBulletList(procedimientoEditor); markAsChanged()\"\n                title=\"Lista con vi√±etas\"\n              >\n                <span>‚Ä¢</span>\n              </button>\n              \n              <button\n                class=\"toolbar-btn\"\n                :class=\"{ 'active': procedimientoEditor?.isActive('orderedList') }\"\n                @click=\"procedimientoEditor?.chain().focus().toggleOrderedList().run(); markAsChanged()\"\n                title=\"Lista numerada\"\n              >\n                <span>1.</span>\n              </button>\n\n              <button\n                class=\"toolbar-btn\"\n                :class=\"{ 'active': procedimientoEditor?.isActive('bulletList', { 'data-type': 'letter' }) }\"\n                @click=\"toggleLetterList(procedimientoEditor); markAsChanged()\"\n                title=\"Lista con letras\"\n              >\n                <span>a)</span>\n              </button>\n            </div>\n            \n            <div class=\"toolbar-separator\"></div>\n            \n            <!-- Grupo de herramientas -->\n            <div class=\"toolbar-group\">\n              <button\n                class=\"toolbar-btn\"\n                @click=\"procedimientoEditor?.chain().focus().undo().run()\"\n                title=\"Deshacer (Ctrl+Z)\"\n              >\n                ‚Ü∂\n              </button>\n              \n              <button\n                class=\"toolbar-btn\"\n                @click=\"procedimientoEditor?.chain().focus().redo().run()\"\n                title=\"Rehacer (Ctrl+Y)\"\n              >\n                ‚Ü∑\n              </button>\n              \n              <button\n                class=\"toolbar-btn\"\n                @click=\"clearProcedimiento\"\n                title=\"Limpiar procedimiento\"\n              >\n                √ó\n              </button>\n            </div>\n          </div>\n          \n          <editor-content \n            :editor=\"procedimientoEditor\" \n            class=\"editor-content\"\n            @input=\"markAsChanged\"\n          />\n        </div>\n        \n        <!-- Vista previa de la tabla generada autom√°ticamente -->\n        <div class=\"table-preview\">\n          <h4>Vista Previa de la Tabla Generada Autom√°ticamente:</h4>\n          <div class=\"preview-container\">\n            <table class=\"preview-table\">\n              <thead>\n                <tr>\n                  <th width=\"15%\">(#)</th>\n                  <th width=\"25%\">(Quien)</th>\n                  <th width=\"60%\">(Actividad)</th>\n                </tr>\n              </thead>\n              <tbody>\n                <tr v-for=\"(row, index) in generatedTable\" :key=\"index\" \n                    :class=\"getRowClass(row)\">\n                  <td>{{ row.number || '&nbsp;' }}</td>\n                  <td>{{ row.who || '&nbsp;' }}</td>\n                  <td>{{ row.activity || '&nbsp;' }}</td>\n                </tr>\n                <tr v-if=\"generatedTable.length === 0\">\n                  <td colspan=\"3\" style=\"text-align: center; color: #6c757d;\">\n                    La tabla se generar√° autom√°ticamente al hacer clic en \"Generar Tabla Autom√°ticamente\"\n                  </td>\n                </tr>\n              </tbody>\n            </table>\n          </div>\n        </div>\n\n        <div class=\"action-buttons\">\n          <button @click=\"parseProcedimiento\" class=\"parse-btn\"> \n            Generar Tabla Autom√°ticamente\n          </button>\n          <button @click=\"loadExampleProcedimiento\" class=\"sample-btn\">\n            Cargar Ejemplo con Subsecciones\n          </button>\n        </div>\n      </div>\n\n      <!-- Secciones restantes -->\n      <div class=\"section\" v-for=\"(section, index) in remainingSections\" :key=\"index + 10\">\n        <h3>{{ section.title }}</h3>\n        <div class=\"section-description\">\n          <p>{{ section.description }}</p>\n        </div>\n        \n        <div class=\"rich-text-editor\">\n          <div class=\"toolbar\">\n            <!-- Grupo de formato de texto -->\n            <div class=\"toolbar-group\">\n              <button\n                class=\"toolbar-btn\"\n                :class=\"{ 'active': section.editor?.isActive('bold') }\"\n                @click=\"section.editor?.chain().focus().toggleBold().run(); markAsChanged()\"\n                title=\"Negrita (Ctrl+B)\"\n              >\n                <strong>B</strong>\n              </button>\n              \n              <button\n                class=\"toolbar-btn\"\n                :class=\"{ 'active': section.editor?.isActive('italic') }\"\n                @click=\"section.editor?.chain().focus().toggleItalic().run(); markAsChanged()\"\n                title=\"Cursiva (Ctrl+I)\"\n              >\n                <em>I</em>\n              </button>\n              \n              <button\n                class=\"toolbar-btn\"\n                :class=\"{ 'active': section.editor?.isActive('underline') }\"\n                @click=\"section.editor?.chain().focus().toggleUnderline().run(); markAsChanged()\"\n                title=\"Subrayado (Ctrl+U)\"\n              >\n                <u>U</u>\n              </button>\n              \n              <button\n                class=\"toolbar-btn\"\n                :class=\"{ 'active': section.editor?.isActive('strike') }\"\n                @click=\"section.editor?.chain().focus().toggleStrike().run(); markAsChanged()\"\n                title=\"Tachado (Ctrl+Shift+S)\"\n              >\n                <s>S</s>\n              </button>\n            </div>\n            \n            <div class=\"toolbar-separator\"></div>\n            \n            <!-- Grupo de estilos de p√°rrafo -->\n            <div class=\"toolbar-group\">\n              <select \n                class=\"style-select\"\n                @change=\"applyStyle(section.editor, $event.target.value); markAsChanged()\"\n                :value=\"getCurrentStyle(section.editor)\"\n                title=\"Estilo de p√°rrafo\"\n              >\n                <option value=\"paragraph\">P√°rrafo normal</option>\n                <option value=\"h1\">T√≠tulo 1</option>\n                <option value=\"h2\">T√≠tulo 2</option>\n                <option value=\"h3\">T√≠tulo 3</option>\n                <option value=\"blockquote\">Cita</option>\n                <option value=\"code\">C√≥digo</option>\n              </select>\n              \n              <button\n                class=\"toolbar-btn\"\n                :class=\"{ 'active': section.editor?.isActive('paragraph') && !section.editor?.isActive('heading') && !section.editor?.isActive('blockquote') && !section.editor?.isActive('codeBlock') }\"\n                @click=\"section.editor?.chain().focus().setParagraph().run(); markAsChanged()\"\n                title=\"P√°rrafo normal\"\n              >\n                <span class=\"icon-text\">¬∂</span>\n              </button>\n            </div>\n            \n            <div class=\"toolbar-separator\"></div>\n            \n            <!-- Grupo de alineaci√≥n -->\n            <div class=\"toolbar-group\">\n              <button\n                class=\"toolbar-btn\"\n                :class=\"{ 'active': section.editor?.isActive({ textAlign: 'left' }) }\"\n                @click=\"section.editor?.chain().focus().setTextAlign('left').run(); markAsChanged()\"\n                title=\"Alinear a la izquierda\"\n              >\n                <font-awesome-icon icon=\"align-left\" />\n              </button>\n              \n              <button\n                class=\"toolbar-btn\"\n                :class=\"{ 'active': section.editor?.isActive({ textAlign: 'center' }) }\"\n                @click=\"section.editor?.chain().focus().setTextAlign('center').run(); markAsChanged()\"\n                title=\"Centrar\"\n              >\n                <font-awesome-icon icon=\"align-center\" />\n              </button>\n              \n              <button\n                class=\"toolbar-btn\"\n                :class=\"{ 'active': section.editor?.isActive({ textAlign: 'right' }) }\"\n                @click=\"section.editor?.chain().focus().setTextAlign('right').run(); markAsChanged()\"\n                title=\"Alinear a la derecha\"\n              >\n                <font-awesome-icon icon=\"align-right\" />\n              </button>\n              \n              <button\n                class=\"toolbar-btn\"\n                :class=\"{ 'active': section.editor?.isActive({ textAlign: 'justify' }) }\"\n                @click=\"section.editor?.chain().focus().setTextAlign('justify').run(); markAsChanged()\"\n                title=\"Justificar\"\n              >\n                <font-awesome-icon icon=\"align-justify\" />\n              </button>\n            </div>\n            \n            <div class=\"toolbar-separator\"></div>\n            \n            <!-- Grupo de listas -->\n            <div class=\"toolbar-group\">\n              <button\n                class=\"toolbar-btn\"\n                :class=\"{ 'active': section.editor?.isActive('bulletList') && !section.editor?.isActive('bulletList', { 'data-type': 'letter' }) }\"\n                @click=\"toggleBulletList(section.editor); markAsChanged()\"\n                title=\"Lista con vi√±etas\"\n              >\n                <span>‚Ä¢</span>\n              </button>\n              \n              <button\n                class=\"toolbar-btn\"\n                :class=\"{ 'active': section.editor?.isActive('orderedList') }\"\n                @click=\"section.editor?.chain().focus().toggleOrderedList().run(); markAsChanged()\"\n                title=\"Lista numerada\"\n              >\n                <span>1.</span>\n              </button>\n\n              <button\n                class=\"toolbar-btn\"\n                :class=\"{ 'active': section.editor?.isActive('bulletList', { 'data-type': 'letter' }) }\"\n                @click=\"toggleLetterList(section.editor); markAsChanged()\"\n                title=\"Lista con letras\"\n              >\n                <span>a)</span>\n              </button>\n            </div>\n            \n            <div class=\"toolbar-separator\"></div>\n            \n            <!-- Grupo de herramientas -->\n            <div class=\"toolbar-group\">\n              <button\n                class=\"toolbar-btn\"\n                @click=\"section.editor?.chain().focus().undo().run()\"\n                title=\"Deshacer (Ctrl+Z)\"\n              >\n                ‚Ü∂\n              </button>\n              \n              <button\n                class=\"toolbar-btn\"\n                @click=\"section.editor?.chain().focus().redo().run()\"\n                title=\"Rehacer (Ctrl+Y)\"\n              >\n                ‚Ü∑\n              </button>\n              \n              <button\n                class=\"toolbar-btn\"\n                @click=\"clearSection(section)\"\n                title=\"Limpiar secci√≥n\"\n              >\n                √ó\n              </button>\n            </div>\n          </div>\n          \n          <editor-content \n            :editor=\"section.editor\" \n            class=\"editor-content\"\n            @input=\"markAsChanged\"\n          />\n        </div>\n      </div>\n      \n      <div class=\"document-controls\">\n        <button @click=\"generateWordDocument\" class=\"generate-btn\" :disabled=\"isGenerating\">\n          <font-awesome-icon icon=\"file-word\" class=\"feature-icon\" />\n          Generar Documento Word\n        </button>\n        <button @click=\"resetDocument\" class=\"reset-btn\">\n          <font-awesome-icon icon=\"trash\" class=\"feature-icon\" />\n          Limpiar Todo\n        </button>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\nimport { generateWordDocument } from '@/utils/docGenerator'\nimport { Editor, EditorContent } from '@tiptap/vue-3'\nimport StarterKit from '@tiptap/starter-kit'\nimport Heading from '@tiptap/extension-heading'\nimport Underline from '@tiptap/extension-underline'\nimport Strike from '@tiptap/extension-strike'\nimport Placeholder from '@tiptap/extension-placeholder'\nimport HardBreak from '@tiptap/extension-hard-break'\nimport BulletList from '@tiptap/extension-bullet-list'\nimport OrderedList from '@tiptap/extension-ordered-list'\nimport Blockquote from '@tiptap/extension-blockquote'\nimport CodeBlock from '@tiptap/extension-code-block'\nimport TextAlign from '@tiptap/extension-text-align'\n\n// Extensi√≥n personalizada para listas con letras\nconst LetterListExtension = BulletList.extend({\n  addAttributes() {\n    return {\n      'data-type': {\n        default: null,\n        parseHTML: element => element.getAttribute('data-type'),\n        renderHTML: attributes => {\n          return attributes['data-type'] ? { 'data-type': attributes['data-type'] } : {}\n        }\n      }\n    }\n  }\n})\n\nexport default {\n  name: 'DocumentView',\n  components: {\n    EditorContent\n  },\n  data() {\n    return {\n      // Modales\n      showResetModal: false,\n      showVersionHistoryModal: false,\n      selectedVersionDetail: null,\n      \n      // Configuraci√≥n del documento\n      headerConfig: {\n        manualName: '',\n        policyName: '',\n        codigo: '',\n        area: '',\n        unidad: '',\n        revision: '',\n        fecha: this.getFormattedDate()\n      },\n      \n      // Secciones del documento\n      sections: [\n        { \n          title: '1. Objetivo o Prop√≥sito', \n          description: 'Establecer el prop√≥sito general del procedimiento.',\n          placeholder: 'Definir el objetivo principal del procedimiento y los resultados esperados...',\n          content: '',\n          editor: null\n        },\n        { \n          title: '2. Alcance', \n          description: 'Definir los l√≠mites y cobertura del procedimiento.',\n          placeholder: 'Especificar los l√≠mites, √°reas de aplicaci√≥n y exclusiones del procedimiento...',\n          content: '',\n          editor: null\n        },\n        { \n          title: '3. Responsabilidades', \n          description: 'Listar los roles y responsabilidades de cada participante.',\n          placeholder: '1. Responsable Principal\\n2. Coordinador\\n3. Ejecutor...',\n          content: '',\n          editor: null\n        },\n        { \n          title: '4. Normativa', \n          description: 'Establecer las normas, pol√≠ticas y criterios aplicables.',\n          placeholder: 'I. [MARCO NORMATIVO]\\nEstablecer las normas y pol√≠ticas que rigen el procedimiento...',\n          content: '',\n          editor: null\n        }\n      ],\n      \n      remainingSections: [\n        { \n          title: '6. Anexos', \n          description: 'Listar los formatos, documentos y anexos relacionados.',\n          placeholder: 'Formato de registro\\nDocumentos de referencia...',\n          content: '',\n          editor: null\n        },\n        { \n          title: '7. T√©rminos y Referencias', \n          description: 'Definir t√©rminos t√©cnicos y referencias documentales.',\n          placeholder: 'T√©rmino 1: Definici√≥n\\nT√©rmino 2: Explicaci√≥n...',\n          content: '',\n          editor: null\n        }\n      ],\n      \n      // Procedimiento\n      generatedTable: [],\n      procedimientoEditor: null,\n      \n      // Sistema de control de versiones\n      documentVersions: [],\n      currentVersionIndex: 0,\n      maxVersions: 10,\n      versionHistory: [],\n      documentId: null,\n      hasUnsavedChanges: false,\n      lastSavedTime: null,\n      autoSaveEnabled: true,\n      autoSaveInterval: null,\n      autoSaveFrequency: 30000, // 30 segundos\n      \n      // UI y estado\n      statusMessage: '',\n      statusType: '',\n      isGenerating: false,\n    }\n  },\n  computed: {\n    procedureTable() {\n      return this.generatedTable;\n    },\n    \n    // Estad√≠sticas del documento\n    documentStats() {\n      return {\n        wordCount: this.calculateTotalWordCount(),\n        completion: this.calculateDocumentCompletion(),\n        sections: this.sections.length + this.remainingSections.length,\n        procedureSteps: this.generatedTable.length,\n        lastVersion: this.documentVersions[0] ? this.formatDate(this.documentVersions[0].timestamp) : 'Nunca'\n      };\n    }\n  },\n  mounted() {\n    this.$nextTick(() => {\n      this.initializeEditors();\n      this.initializeVersionSystem();\n    });\n    \n    // Configurar autoguardado autom√°tico\n    this.setupAutoVersioning();\n    \n    // Detectar cierre de ventana\n    window.addEventListener('beforeunload', this.handleBeforeUnload);\n  },\n  beforeUnmount() {\n    this.destroyEditors();\n    this.stopAutoSave();\n    window.removeEventListener('beforeunload', this.handleBeforeUnload);\n  },\n  methods: {\n    // ============ SISTEMA DE CONTROL DE VERSIONES ============\n    \n    /**\n     * Inicializa el sistema de versiones\n     */\n    initializeVersionSystem() {\n      // Generar ID √∫nico para el documento\n      this.documentId = `doc_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`;\n      \n      // Cargar versiones existentes del localStorage\n      this.loadVersionsFromStorage();\n      \n      // Si no hay versiones, crear una inicial\n      if (this.documentVersions.length === 0) {\n        this.captureVersion('Versi√≥n inicial del documento');\n      } else {\n        this.lastSavedTime = this.documentVersions[0]?.timestamp;\n      }\n      \n      // Configurar detecci√≥n de cambios\n      this.setupChangeDetection();\n      \n      console.log('‚úÖ Sistema de versiones inicializado');\n    },\n    \n    /**\n     * Captura una nueva versi√≥n del documento\n     */\n    captureVersion(description = 'Cambios sin descripci√≥n') {\n      try {\n        const versionData = this.createVersionSnapshot(description);\n        \n        // Agregar a la lista de versiones\n        this.documentVersions.unshift(versionData);\n        \n        // Mantener solo el n√∫mero m√°ximo de versiones\n        if (this.documentVersions.length > this.maxVersions) {\n          this.documentVersions.pop();\n        }\n        \n        // Actualizar √≠ndice de versi√≥n actual\n        this.currentVersionIndex = 0;\n        \n        // Actualizar tiempo de √∫ltimo guardado\n        this.lastSavedTime = versionData.timestamp;\n        \n        // Agregar al historial\n        this.versionHistory.unshift({\n          action: 'version_saved',\n          versionId: versionData.id,\n          description: description,\n          timestamp: new Date().toISOString(),\n          user: 'usuario_actual'\n        });\n        \n        // Guardar en localStorage\n        this.saveVersionsToStorage();\n        \n        // Resetear flag de cambios no guardados\n        this.hasUnsavedChanges = false;\n        \n        console.log(`üìù Versi√≥n guardada: ${description}`);\n        return versionData.id;\n        \n      } catch (error) {\n        console.error('‚ùå Error capturando versi√≥n:', error);\n        return null;\n      }\n    },\n    \n    /**\n     * Crea un snapshot del estado actual\n     */\n    createVersionSnapshot(description) {\n      // Calcular estad√≠sticas\n      const wordCount = this.calculateTotalWordCount();\n      const completion = this.calculateDocumentCompletion();\n      \n      return {\n        id: `v${Date.now()}_${Math.random().toString(36).substr(2, 9)}`,\n        timestamp: new Date().toISOString(),\n        description: description,\n        data: {\n          // Configuraci√≥n del encabezado\n          headerConfig: JSON.parse(JSON.stringify(this.headerConfig)),\n          \n          // Contenido de secciones principales\n          sections: this.sections.map(section => ({\n            title: section.title,\n            content: section.editor ? section.editor.getHTML() : '',\n            text: section.editor ? section.editor.getText() : ''\n          })),\n          \n          // Secciones restantes\n          remainingSections: this.remainingSections.map(section => ({\n            title: section.title,\n            content: section.editor ? section.editor.getHTML() : '',\n            text: section.editor ? section.editor.getText() : ''\n          })),\n          \n          // Procedimiento\n          procedimiento: {\n            content: this.procedimientoEditor ? this.procedimientoEditor.getHTML() : '',\n            text: this.procedimientoEditor ? this.procedimientoEditor.getText() : '',\n            table: JSON.parse(JSON.stringify(this.generatedTable))\n          }\n        },\n        preview: this.generateVersionPreview(wordCount, completion)\n      };\n    },\n    \n    /**\n     * Genera una vista previa de la versi√≥n\n     */\n    generateVersionPreview(wordCount, completion) {\n      // Obtener texto de la primera secci√≥n para el snippet\n      let snippet = '';\n      if (this.sections.length > 0 && this.sections[0].editor) {\n        const text = this.sections[0].editor.getText();\n        snippet = text.substring(0, 150) + (text.length > 150 ? '...' : '');\n      }\n      \n      return {\n        title: this.headerConfig.policyName || 'Documento sin t√≠tulo',\n        snippet: snippet || 'Sin contenido',\n        words: wordCount,\n        completion: completion,\n        sections: this.sections.length + this.remainingSections.length,\n        procedureSteps: this.generatedTable.length\n      };\n    },\n    \n    /**\n     * Restaura una versi√≥n espec√≠fica\n     */\n    restoreVersion(versionId) {\n      const versionIndex = this.documentVersions.findIndex(v => v.id === versionId);\n      \n      if (versionIndex === -1) {\n        this.showStatus('‚ùå Versi√≥n no encontrada', 'error');\n        return false;\n      }\n      \n      const version = this.documentVersions[versionIndex];\n      \n      // Confirmar antes de restaurar\n      if (!confirm(`¬øRestaurar versi√≥n del ${this.formatDate(version.timestamp)}?\\n\\n\"${version.description}\"`)) {\n        return false;\n      }\n      \n      try {\n        // Restaurar configuraci√≥n del encabezado\n        this.headerConfig = JSON.parse(JSON.stringify(version.data.headerConfig));\n        \n        // Restaurar secciones principales\n        this.sections.forEach((section, index) => {\n          if (version.data.sections[index] && section.editor) {\n            section.editor.commands.setContent(version.data.sections[index].content);\n          }\n        });\n        \n        // Restaurar secciones restantes\n        this.remainingSections.forEach((section, index) => {\n          if (version.data.remainingSections[index] && section.editor) {\n            section.editor.commands.setContent(version.data.remainingSections[index].content);\n          }\n        });\n        \n        // Restaurar procedimiento\n        if (this.procedimientoEditor && version.data.procedimiento) {\n          this.procedimientoEditor.commands.setContent(version.data.procedimiento.content);\n          this.generatedTable = JSON.parse(JSON.stringify(version.data.procedimiento.table));\n        }\n        \n        // Actualizar √≠ndice actual\n        this.currentVersionIndex = versionIndex;\n        \n        // Registrar en historial\n        this.versionHistory.unshift({\n          action: 'version_restored',\n          versionId: versionId,\n          timestamp: new Date().toISOString(),\n          user: 'usuario_actual'\n        });\n        \n        this.saveVersionsToStorage();\n        \n        // Cerrar modales\n        this.showVersionHistoryModal = false;\n        this.selectedVersionDetail = null;\n        \n        this.showStatus(`‚úÖ Versi√≥n restaurada: ${version.description}`, 'success');\n        return true;\n        \n      } catch (error) {\n        console.error('‚ùå Error restaurando versi√≥n:', error);\n        this.showStatus('‚ùå Error al restaurar la versi√≥n', 'error');\n        return false;\n      }\n    },\n    \n    /**\n     * Elimina una versi√≥n\n     */\n    deleteVersion(versionId) {\n      const index = this.documentVersions.findIndex(v => v.id === versionId);\n      \n      if (index === -1) return false;\n      \n      if (!confirm(`¬øEliminar esta versi√≥n permanentemente?\\n\\n\"${this.documentVersions[index].description}\"`)) {\n        return false;\n      }\n      \n      // No permitir eliminar la versi√≥n actual si es la √∫nica\n      if (this.documentVersions.length === 1) {\n        this.showStatus('‚ùå No puedes eliminar la √∫nica versi√≥n disponible', 'error');\n        return false;\n      }\n      \n      // Ajustar √≠ndice actual si se elimina la versi√≥n actual\n      if (index === this.currentVersionIndex) {\n        this.currentVersionIndex = 0;\n      } else if (index < this.currentVersionIndex) {\n        this.currentVersionIndex--;\n      }\n      \n      this.documentVersions.splice(index, 1);\n      this.saveVersionsToStorage();\n      \n      this.showStatus('üóëÔ∏è Versi√≥n eliminada', 'info');\n      return true;\n    },\n    \n    /**\n     * Guarda las versiones en localStorage\n     */\n    saveVersionsToStorage() {\n      try {\n        const data = {\n          versions: this.documentVersions,\n          history: this.versionHistory,\n          currentIndex: this.currentVersionIndex,\n          documentId: this.documentId,\n          lastUpdated: new Date().toISOString()\n        };\n        \n        localStorage.setItem(`document_versions_${this.documentId}`, JSON.stringify(data));\n        return true;\n      } catch (error) {\n        console.error('‚ùå Error guardando versiones:', error);\n        return false;\n      }\n    },\n    \n    /**\n     * Carga las versiones desde localStorage\n     */\n    loadVersionsFromStorage() {\n      try {\n        const saved = localStorage.getItem(`document_versions_${this.documentId}`);\n        if (saved) {\n          const data = JSON.parse(saved);\n          this.documentVersions = data.versions || [];\n          this.versionHistory = data.history || [];\n          this.currentVersionIndex = data.currentIndex || 0;\n          return true;\n        }\n      } catch (error) {\n        console.error('‚ùå Error cargando versiones:', error);\n      }\n      return false;\n    },\n    \n    /**\n     * Configura autoguardado autom√°tico\n     */\n    setupAutoVersioning() {\n      if (this.autoSaveEnabled) {\n        this.autoSaveInterval = setInterval(() => {\n          if (this.hasUnsavedChanges) {\n            this.captureVersion(`Auto-guardado ${new Date().toLocaleTimeString()}`);\n          }\n        }, this.autoSaveFrequency);\n        \n        console.log('üîÑ Autoguardado configurado cada', this.autoSaveFrequency / 1000, 'segundos');\n      }\n    },\n    \n    /**\n     * Detiene el autoguardado\n     */\n    stopAutoSave() {\n      if (this.autoSaveInterval) {\n        clearInterval(this.autoSaveInterval);\n        this.autoSaveInterval = null;\n        console.log('‚èπÔ∏è Autoguardado detenido');\n      }\n    },\n    \n    /**\n     * Configura detecci√≥n de cambios\n     */\n    setupChangeDetection() {\n      // Monitorear cambios en todos los editores\n      const editors = [\n        ...this.sections.map(s => s.editor),\n        ...this.remainingSections.map(s => s.editor),\n        this.procedimientoEditor\n      ].filter(Boolean);\n      \n      editors.forEach(editor => {\n        editor.on('update', () => {\n          this.markAsChanged();\n        });\n      });\n    },\n    \n    /**\n     * Marca el documento como modificado\n     */\n    markAsChanged() {\n      if (!this.hasUnsavedChanges) {\n        this.hasUnsavedChanges = true;\n        console.log('üìù Documento marcado como modificado');\n      }\n    },\n    \n    /**\n     * Maneja el evento beforeunload\n     */\n    handleBeforeUnload(event) {\n      if (this.hasUnsavedChanges) {\n        event.preventDefault();\n        event.returnValue = 'Tienes cambios sin guardar. ¬øSeguro que quieres salir?';\n        return event.returnValue;\n      }\n    },\n    \n    // ============ M√âTODOS AUXILIARES ============\n    \n    /**\n     * Calcula el total de palabras del documento\n     */\n    calculateTotalWordCount() {\n      let count = 0;\n      \n      // Contar palabras de secciones principales\n      this.sections.forEach(section => {\n        if (section.editor) {\n          const text = section.editor.getText();\n          count += text.split(/\\s+/).filter(word => word.length > 0).length;\n        }\n      });\n      \n      // Contar palabras de secciones restantes\n      this.remainingSections.forEach(section => {\n        if (section.editor) {\n          const text = section.editor.getText();\n          count += text.split(/\\s+/).filter(word => word.length > 0).length;\n        }\n      });\n      \n      // Contar palabras del procedimiento\n      if (this.procedimientoEditor) {\n        const text = this.procedimientoEditor.getText();\n        count += text.split(/\\s+/).filter(word => word.length > 0).length;\n      }\n      \n      return count;\n    },\n    \n    /**\n     * Calcula el porcentaje de completado del documento\n     */\n    calculateDocumentCompletion() {\n      let completedSections = 0;\n      const totalSections = this.sections.length + this.remainingSections.length + 1; // +1 para procedimiento\n      \n      // Verificar secciones principales (m√≠nimo 10 caracteres)\n      this.sections.forEach(section => {\n        if (section.editor && section.editor.getText().trim().length > 10) {\n          completedSections++;\n        }\n      });\n      \n      // Verificar secciones restantes\n      this.remainingSections.forEach(section => {\n        if (section.editor && section.editor.getText().trim().length > 10) {\n          completedSections++;\n        }\n      });\n      \n      // Verificar procedimiento\n      if (this.procedimientoEditor && this.procedimientoEditor.getText().trim().length > 10) {\n        completedSections++;\n      }\n      \n      return Math.round((completedSections / totalSections) * 100);\n    },\n    \n    /**\n     * Formatea una fecha\n     */\n    formatDate(dateString) {\n      if (!dateString) return 'Nunca';\n      \n      try {\n        const date = new Date(dateString);\n        return date.toLocaleString('es-ES', {\n          day: '2-digit',\n          month: '2-digit',\n          year: 'numeric',\n          hour: '2-digit',\n          minute: '2-digit'\n        });\n      } catch (error) {\n        return dateString;\n      }\n    },\n    \n    // ============ M√âTODOS DE UI ============\n    \n    /**\n     * Abre el modal de historial de versiones\n     */\n    openVersionHistoryModal() {\n      this.showVersionHistoryModal = true;\n      this.selectedVersionDetail = null;\n    },\n    \n    /**\n     * Cierra el modal de historial de versiones\n     */\n    closeVersionHistoryModal() {\n      this.showVersionHistoryModal = false;\n      this.selectedVersionDetail = null;\n    },\n    \n    /**\n     * Muestra los detalles de una versi√≥n\n     */\n    viewVersionDetail(version) {\n      this.selectedVersionDetail = version;\n    },\n    \n    /**\n     * Restaura la versi√≥n seleccionada\n     */\n    restoreSelectedVersion() {\n      if (this.selectedVersionDetail) {\n        this.restoreVersion(this.selectedVersionDetail.id);\n      }\n    },\n    \n    /**\n     * Guarda una versi√≥n manualmente\n     */\n    manualSaveVersion() {\n      const description = prompt('Describe los cambios de esta versi√≥n:', \n        `Guardado manual - ${new Date().toLocaleString()}`);\n      \n      if (description && description.trim()) {\n        const versionId = this.captureVersion(description.trim());\n        if (versionId) {\n          this.showStatus(`‚úÖ Versi√≥n guardada: \"${description}\"`, 'success');\n        }\n      }\n    },\n    \n    // ============ M√âTODOS EXISTENTES DEL EDITOR ============\n    // (Tus m√©todos originales se mantienen igual, solo agregu√© markAsChanged() donde correspond√≠a)\n    \n    initializeEditors() {\n      // Configuraci√≥n base para todos los editores\n      const commonExtensionsBase = [\n        StarterKit.configure({\n          hardBreak: {\n            keepMarks: true,\n          },\n          bulletList: {\n            HTMLAttributes: {\n              class: 'bullet-list',\n            },\n          },\n          codeBlock: {\n            HTMLAttributes: {\n              class: 'code-block',\n            },\n          },\n        }),\n        Heading.configure({\n          levels: [1, 2, 3],\n          HTMLAttributes: {\n            class: 'tiptap-heading'\n          }\n        }),\n        Underline,\n        Strike,\n        HardBreak.configure({\n          keepMarks: true,\n        }),\n        Blockquote.configure({\n          HTMLAttributes: {\n            class: 'blockquote'\n          }\n        }),\n        CodeBlock.configure({\n          languageClassPrefix: 'language-',\n        }),\n        TextAlign.configure({\n          types: ['heading', 'paragraph'],\n          alignments: ['left', 'center', 'right', 'justify'],\n          defaultAlignment: 'left',\n        }),\n        OrderedList.configure({\n          HTMLAttributes: {\n            class: 'ordered-list'\n          }\n        })\n      ];\n\n      const createEditor = (placeholder) => {\n        const extensions = [\n          ...commonExtensionsBase,\n          Placeholder.configure({\n            placeholder: ({ node }) => {\n              if (node.type.name === 'heading') return 'T√≠tulo...';\n              if (node.type.name === 'codeBlock') return 'Escribe tu c√≥digo aqu√≠...';\n              if (node.type.name === 'blockquote') return 'Escribe una cita...';\n              return placeholder || 'Escribe tu contenido aqu√≠...';\n            }\n          }),\n          LetterListExtension\n        ];\n\n        return new Editor({\n          content: '',\n          extensions: extensions,\n          onUpdate: () => {\n            // markAsChanged ya se maneja en setupChangeDetection\n          },\n          onCreate: () => {\n            console.log('Editor inicializado');\n          },\n          editorProps: {\n            attributes: {\n              class: 'prose prose-sm sm:prose lg:prose-lg xl:prose-2xl mx-auto focus:outline-none',\n              style: 'min-height: 120px; white-space: pre-line;'\n            },\n            handleKeyDown: (view, event) => {\n              // Atajos de teclado...\n              // Ctrl+B - Negrita\n              if (event.ctrlKey && event.key === 'b') {\n                event.preventDefault();\n                view.dispatch(view.state.tr.setMark(view.state.selection.from, view.state.selection.to, view.state.schema.marks.bold));\n                this.markAsChanged();\n                return true;\n              }\n              \n              // Ctrl+I - Cursiva\n              if (event.ctrlKey && event.key === 'i') {\n                event.preventDefault();\n                view.dispatch(view.state.tr.setMark(view.state.selection.from, view.state.selection.to, view.state.schema.marks.italic));\n                this.markAsChanged();\n                return true;\n              }\n              \n              // Ctrl+U - Subrayado\n              if (event.ctrlKey && event.key === 'u') {\n                event.preventDefault();\n                view.dispatch(view.state.tr.setMark(view.state.selection.from, view.state.selection.to, view.state.schema.marks.underline));\n                this.markAsChanged();\n                return true;\n              }\n              \n              // Ctrl+Shift+S - Tachado\n              if (event.ctrlKey && event.shiftKey && event.key === 's') {\n                event.preventDefault();\n                view.dispatch(view.state.tr.setMark(view.state.selection.from, view.state.selection.to, view.state.schema.marks.strike));\n                this.markAsChanged();\n                return true;\n              }\n              \n              // Ctrl+Z - Deshacer\n              if (event.ctrlKey && event.key === 'z') {\n                event.preventDefault();\n                view.dispatch(view.state.tr.undo());\n                this.markAsChanged();\n                return true;\n              }\n              \n              // Ctrl+Y - Rehacer\n              if (event.ctrlKey && event.key === 'y') {\n                event.preventDefault();\n                view.dispatch(view.state.tr.redo());\n                this.markAsChanged();\n                return true;\n              }\n              \n              return false;\n            }\n          }\n        });\n      };\n\n      // Inicializar secciones principales\n      this.sections.forEach((section, index) => {\n        const editor = createEditor(section.placeholder);\n        editor.on('update', () => {\n          this.sections[index].content = editor.getHTML();\n        });\n        section.editor = editor;\n      });\n\n      // Inicializar secciones restantes\n      this.remainingSections.forEach((section, index) => {\n        const editor = createEditor(section.placeholder);\n        editor.on('update', () => {\n          this.remainingSections[index].content = editor.getHTML();\n        });\n        section.editor = editor;\n      });\n\n      // Inicializar editor de procedimiento\n      this.procedimientoEditor = createEditor('Describe el procedimiento completo aqu√≠ en lenguaje natural...');\n      this.procedimientoEditor.on('update', () => {\n        // Actualizar contenido del procedimiento si es necesario\n      });\n    },\n\n    // M√©todo para aplicar estilos desde el select\n    applyStyle(editor, style) {\n      if (!editor) return;\n      \n      switch(style) {\n        case 'paragraph':\n          editor.chain().focus().setParagraph().run();\n          break;\n        case 'h1':\n          editor.chain().focus().toggleHeading({ level: 1 }).run();\n          break;\n        case 'h2':\n          editor.chain().focus().toggleHeading({ level: 2 }).run();\n          break;\n        case 'h3':\n          editor.chain().focus().toggleHeading({ level: 3 }).run();\n          break;\n        case 'blockquote':\n          editor.chain().focus().toggleBlockquote().run();\n          break;\n        case 'code':\n          editor.chain().focus().toggleCodeBlock().run();\n          break;\n      }\n      this.markAsChanged();\n    },\n\n    // M√©todo para obtener el estilo actual del cursor\n    getCurrentStyle(editor) {\n      if (!editor) return 'paragraph';\n      \n      if (editor.isActive('heading', { level: 1 })) return 'h1';\n      if (editor.isActive('heading', { level: 2 })) return 'h2';\n      if (editor.isActive('heading', { level: 3 })) return 'h3';\n      if (editor.isActive('blockquote')) return 'blockquote';\n      if (editor.isActive('codeBlock')) return 'code';\n      \n      return 'paragraph';\n    },\n\n    // M√©todo para alternar lista con letras\n    toggleLetterList(editor) {\n      if (!editor) return;\n\n      if (editor.isActive('bulletList', { 'data-type': 'letter' })) {\n        editor.chain().focus().updateAttributes('bulletList', { 'data-type': null }).run();\n      } else if (editor.isActive('bulletList')) {\n        editor.chain().focus().updateAttributes('bulletList', { 'data-type': 'letter' }).run();\n      } else {\n        editor.chain().focus().toggleBulletList().updateAttributes('bulletList', { 'data-type': 'letter' }).run();\n      }\n      this.markAsChanged();\n    },\n\n    // M√©todo central para togglear vi√±etas normales\n    toggleBulletList(editor) {\n      if (!editor) return;\n\n      if (editor.isActive('bulletList', { 'data-type': 'letter' })) {\n        editor.chain().focus().updateAttributes('bulletList', { 'data-type': null }).run();\n      } else {\n        editor.chain().focus().toggleBulletList().run();\n      }\n      this.markAsChanged();\n    },\n\n    destroyEditors() {\n      this.sections.forEach(section => {\n        if (section.editor) {\n          section.editor.destroy();\n          section.editor = null;\n        }\n      });\n      this.remainingSections.forEach(section => {\n        if (section.editor) {\n          section.editor.destroy();\n          section.editor = null;\n        }\n      });\n      if (this.procedimientoEditor) {\n        this.procedimientoEditor.destroy();\n        this.procedimientoEditor = null;\n      }\n    },\n\n    clearSection(section) {\n      if (section.editor) {\n        section.editor.commands.clearContent();\n        this.markAsChanged();\n        this.showStatus('Secci√≥n limpiada', 'info');\n      }\n    },\n\n    clearProcedimiento() {\n      if (this.procedimientoEditor) {\n        this.procedimientoEditor.commands.clearContent();\n        this.generatedTable = [];\n        this.markAsChanged();\n        this.showStatus('Procedimiento limpiado', 'info');\n      }\n    },\n\n    getFormattedDate() {\n      const today = new Date();\n      const year = today.getFullYear();\n      const month = String(today.getMonth() + 1).padStart(2, '0');\n      const day = String(today.getDate()).padStart(2, '0');\n      return `${year}-${month}-${day}`;\n    },\n\n    loadExampleProcedimiento() {\n      if (!this.procedimientoEditor) return;\n      \n      const exampleText = `El administrador revisa la lista de proveedores a pagar\nEl administrador env√≠a la lista al gerente general para revisi√≥n\nEl gerente general revisa la lista de proveedores\n¬øLa lista est√° correcta?\nSi est√° correcta, el gerente general realiza el pago a los proveedores\na) Verifica disponibilidad de fondos\nb) Prepara √≥rdenes de pago\nc) Registra en el sistema contable\nSi no est√° correcta, el gerente general devuelve la lista al administrador\nEl administrador verifica y corrige la informaci√≥n de los proveedores\n5.1.1 Consulta base de datos de proveedores\n5.1.2 Actualiza informaci√≥n faltante\n5.1.3 Valida documentos de respaldo\nEl administrador actualiza la lista con la informaci√≥n corregida\nEl proceso se repite desde el env√≠o al gerente general\nFin del proceso`;\n\n      const formattedContent = exampleText.split('\\n').map(line => {\n        if (line.trim() === '') return '<p></p>';\n        \n        if (/^[a-z]\\)/.test(line.trim())) {\n          return `<ul data-type=\"letter\"><li>${line.replace(/^[a-z]\\)\\s*/, '')}</li></ul>`;\n        }\n        \n        if (/^\\d+\\.\\d+\\.\\d+/.test(line.trim())) {\n          return `<ul><li>${line}</li></ul>`;\n        }\n        \n        return `<p>${line}</p>`;\n      }).join('');\n\n      this.procedimientoEditor.commands.setContent(formattedContent);\n      this.markAsChanged();\n      this.showStatus('üìù Ejemplo con subsecciones cargado. Haz clic en \"Generar Tabla Autom√°ticamente\" para ver el resultado.', 'info');\n    },\n\n    parseProcedimiento() {\n      if (!this.procedimientoEditor) return;\n      \n      const textContent = this.procedimientoEditor.getText();\n      \n      if (!textContent.trim()) {\n        this.showStatus('‚ùå Por favor ingresa la descripci√≥n del procedimiento', 'error');\n        return;\n      }\n\n      try {\n        const lines = textContent.split('\\n').filter(line => line.trim() !== '');\n        const table = [];\n        let stepNumber = 1;\n        let subStepNumber = 0;\n        let currentMainStep = null;\n\n        for (let i = 0; i < lines.length; i++) {\n          const line = lines[i].trim();\n          \n          if (line === '') continue;\n\n          if (this.isSubsectionStarter(line)) {\n            if (currentMainStep) {\n              subStepNumber++;\n              const fullNumber = `${currentMainStep}.${subStepNumber}`;\n              const responsible = this.extractResponsible(line);\n              const activity = this.extractActivity(line, responsible);\n              \n              table.push({ \n                number: fullNumber, \n                who: responsible, \n                activity: activity,\n                level: 'sub'\n              });\n            } else {\n              const responsible = this.extractResponsible(line);\n              const activity = this.extractActivity(line, responsible);\n              \n              table.push({ \n                number: `${stepNumber}`, \n                who: responsible, \n                activity: activity \n              });\n              stepNumber++;\n              subStepNumber = 0;\n            }\n          }\n          else if (this.isMainProcessLine(line)) {\n            table.push({ number: '', who: '', activity: line, level: 'section' });\n            currentMainStep = null;\n            subStepNumber = 0;\n          }\n          else if (line.startsWith('¬ø')) {\n            table.push({ number: '', who: '', activity: line, level: 'question' });\n            currentMainStep = null;\n            subStepNumber = 0;\n          }\n          else if (line.toLowerCase().startsWith('si ') || line.toLowerCase().startsWith('no ') || \n                   line.toLowerCase().startsWith('si,') || line.toLowerCase().startsWith('no,')) {\n            table.push({ number: '', who: '', activity: line, level: 'alternative' });\n            currentMainStep = null;\n            subStepNumber = 0;\n          }\n          else if (line.toLowerCase().includes('fin del proceso')) {\n            table.push({ number: '', who: '', activity: 'Fin del Proceso', level: 'end' });\n            currentMainStep = null;\n            subStepNumber = 0;\n          }\n          else {\n            const responsible = this.extractResponsible(line);\n            const activity = this.extractActivity(line, responsible);\n            \n            if (responsible || activity) {\n              table.push({ \n                number: `${stepNumber}`, \n                who: responsible, \n                activity: activity \n              });\n              currentMainStep = stepNumber;\n              stepNumber++;\n              subStepNumber = 0;\n            }\n          }\n        }\n\n        this.generatedTable = table;\n        this.markAsChanged();\n        this.showStatus('‚úÖ Tabla generada autom√°ticamente desde la descripci√≥n', 'success');\n      } catch (error) {\n        this.showStatus('‚ùå Error al procesar la descripci√≥n: ' + error.message, 'error');\n      }\n    },\n\n    isSubsectionStarter(line) {\n      const subsectionPatterns = [\n        /^\\d+\\.\\d+\\.\\d+/,\n        /^[a-z]\\)/,\n        /^[ivx]+\\)/,\n        /^‚Ä¢\\s/,\n        /^-\\s/,\n        /^‚Üí\\s/,\n        /^subpaso\\s\\d+/i,\n        /^detalle\\s\\d+/i\n      ];\n\n      return subsectionPatterns.some(pattern => pattern.test(line.toLowerCase()));\n    },\n\n    isMainProcessLine(line) {\n      return !line.startsWith('¬ø') && \n             !line.toLowerCase().startsWith('si ') && \n             !line.toLowerCase().startsWith('no ') &&\n             !line.toLowerCase().startsWith('si,') && \n             !line.toLowerCase().startsWith('no,') &&\n             !line.toLowerCase().includes('fin del proceso') &&\n             !this.extractResponsible(line) &&\n             !this.isSubsectionStarter(line) &&\n             line.length > 10;\n    },\n\n    extractResponsible(line) {\n      const patterns = [\n        /^el (\\w+)/i,\n        /^la (\\w+)/i,\n        /^los (\\w+)/i,\n        /^las (\\w+)/i,\n        /^un (\\w+)/i,\n        /^una (\\w+)/i,\n        /^(\\w+) (revisa|env√≠a|realiza|verifica|corrige|aprueba|autoriza)/i\n      ];\n\n      for (const pattern of patterns) {\n        const match = line.match(pattern);\n        if (match) {\n          return this.capitalizeFirstLetter(match[1] || match[2]);\n        }\n      }\n\n      return '';\n    },\n\n    extractActivity(line, responsible) {\n      if (!responsible) return line;\n\n      const respRaw = String(responsible).trim();\n      const respEscaped = respRaw.replace(/[.*+?^${}()|[\\]\\\\]/g, '\\\\$&');\n\n      const removePattern = new RegExp(`^(el\\\\s+${respEscaped}|la\\\\s+${respEscaped}|los\\\\s+${respEscaped}|las\\\\s+${respEscaped}|${respEscaped})\\\\s+`, 'i');\n      let activity = line.replace(removePattern, '').trim();\n\n      if (!activity) return '';\n      return activity.charAt(0).toUpperCase() + activity.slice(1);\n    },\n\n    capitalizeFirstLetter(string) {\n      return string.charAt(0).toUpperCase() + string.slice(1);\n    },\n\n    getRowClass(row) {\n      if (row.level === 'section') return 'section-row';\n      if (row.level === 'sub') return 'subsection-row';\n      if (row.level === 'question') return 'question-row';\n      if (row.level === 'alternative') return 'alternative-row';\n      if (row.level === 'end') return 'end-row';\n      if (!row.number && !row.who && !row.activity) return 'empty-row';\n      return 'normal-row';\n    },\n\n    async generateWordDocument() {\n      // Capturar versi√≥n antes de generar\n      this.captureVersion('Versi√≥n antes de generar Word');\n      \n      this.isGenerating = true;\n      \n      const procedimientoText = this.procedimientoEditor ? this.procedimientoEditor.getText() : '';\n      \n      if (procedimientoText && this.generatedTable.length === 0) {\n        this.parseProcedimiento();\n      }\n\n      const documentData = {\n        headerConfig: this.headerConfig,\n        objetivo: this.sections[0].editor.getHTML(),\n        alcance: this.sections[1].editor.getHTML(),\n        responsabilidades: this.sections[2].editor.getHTML(),\n        normativa: this.sections[3].editor.getHTML(),\n        anexos: this.remainingSections[0].editor.getHTML(),\n        terminos: this.remainingSections[1].editor.getHTML()\n      };\n\n      try {\n        await generateWordDocument(documentData, this.generatedTable);\n        this.showStatus('‚úÖ Documento Word generado exitosamente!', 'success');\n      } catch (error) {\n        console.error('Error generating document:', error);\n        this.showStatus('‚ùå Error al generar el documento: ' + error.message, 'error');\n      } finally {\n        this.isGenerating = false;\n      }\n    },\n\n    resetDocument() {\n      this.showResetModal = true;\n    },\n\n    closeResetModal() {\n      this.showResetModal = false;\n    },\n\n    confirmReset() {\n      this.showResetModal = false;\n      this.executeReset();\n      \n      // Capturar versi√≥n despu√©s del reset\n      this.captureVersion('Documento reseteado');\n      \n      this.showStatus('üóëÔ∏è Todo el contenido ha sido resetado', 'info');\n    },\n\n    executeReset() {\n      this.sections.forEach(section => {\n        if (section.editor) {\n          section.editor.commands.clearContent();\n        }\n      });\n      this.remainingSections.forEach(section => {\n        if (section.editor) {\n          section.editor.commands.clearContent();\n        }\n      });\n      if (this.procedimientoEditor) {\n        this.procedimientoEditor.commands.clearContent();\n      }\n      this.generatedTable = [];\n      \n      this.headerConfig = {\n        manualName: '',\n        policyName: '',\n        codigo: '',\n        area: '',\n        unidad: '',\n        revision: '',\n        fecha: this.getFormattedDate()\n      };\n      \n      this.hasUnsavedChanges = true;\n    },\n\n    showStatus(message, type) {\n      this.statusMessage = message;\n      this.statusType = type;\n      \n      setTimeout(() => {\n        this.statusMessage = '';\n        this.statusType = '';\n      }, 5000);\n    }\n  }\n}\n</script>\n\n<style scoped>\n/* ============ ESTILOS PARA CONTROL DE VERSIONES ============ */\n\n.version-control-bar {\n  display: flex;\n  align-items: center;\n  gap: 10px;\n  padding: 10px 15px;\n  background: #f8f9fa;\n  border-radius: 8px;\n  margin: 20px 0;\n  border: 1px solid #e9ecef;\n  flex-wrap: wrap;\n}\n\n.version-btn, .save-version-btn {\n  background: white;\n  border: 1px solid #3498db;\n  color: #3498db;\n  padding: 8px 15px;\n  border-radius: 6px;\n  cursor: pointer;\n  font-size: 14px;\n  font-weight: 500;\n  transition: all 0.3s ease;\n  display: flex;\n  align-items: center;\n  gap: 8px;\n}\n\n.version-btn:hover, .save-version-btn:hover {\n  background: #3498db;\n  color: white;\n  transform: translateY(-1px);\n}\n\n.badge {\n  background: #e74c3c;\n  color: white;\n  border-radius: 50%;\n  width: 20px;\n  height: 20px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  font-size: 12px;\n  font-weight: bold;\n}\n\n.version-info {\n  margin-left: auto;\n  font-size: 13px;\n  color: #6c757d;\n}\n\n.last-save {\n  background: #e8f4fc;\n  padding: 4px 8px;\n  border-radius: 4px;\n  border: 1px solid #d1ecf1;\n}\n\n.auto-save-status {\n  display: flex;\n  align-items: center;\n  gap: 6px;\n  font-size: 12px;\n  color: #6c757d;\n  background: #f8f9fa;\n  padding: 4px 8px;\n  border-radius: 4px;\n  border: 1px solid #e9ecef;\n}\n\n.auto-save-status.active .status-dot {\n  background-color: #28a745;\n}\n\n.auto-save-status:not(.active) .status-dot {\n  background-color: #dc3545;\n}\n\n.status-dot {\n  width: 8px;\n  height: 8px;\n  border-radius: 50%;\n  display: inline-block;\n}\n\n/* Modal de historial de versiones */\n.version-history-modal {\n  max-width: 800px;\n  max-height: 80vh;\n  overflow: hidden;\n}\n\n.versions-list {\n  max-height: 400px;\n  overflow-y: auto;\n  padding-right: 10px;\n}\n\n.version-item {\n  background: white;\n  border: 1px solid #e9ecef;\n  border-radius: 8px;\n  margin-bottom: 10px;\n  overflow: hidden;\n  transition: all 0.3s ease;\n}\n\n.version-item.current-version {\n  border-color: #3498db;\n  border-left: 4px solid #3498db;\n}\n\n.version-item:hover {\n  box-shadow: 0 4px 12px rgba(0,0,0,0.1);\n  transform: translateY(-1px);\n}\n\n.version-header {\n  padding: 15px;\n  cursor: pointer;\n  background: #f8f9fa;\n  border-bottom: 1px solid #e9ecef;\n}\n\n.version-meta {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  margin-bottom: 8px;\n}\n\n.version-time {\n  font-size: 12px;\n  color: #6c757d;\n  font-weight: 500;\n}\n\n.version-badge {\n  background: #28a745;\n  color: white;\n  padding: 2px 8px;\n  border-radius: 12px;\n  font-size: 11px;\n  font-weight: bold;\n}\n\n.version-description {\n  font-weight: 600;\n  color: #2c3e50;\n  margin-bottom: 8px;\n}\n\n.version-stats {\n  display: flex;\n  gap: 15px;\n  font-size: 12px;\n  color: #6c757d;\n}\n\n.stat {\n  display: flex;\n  align-items: center;\n  gap: 4px;\n}\n\n.version-actions {\n  display: flex;\n  padding: 10px 15px;\n  gap: 8px;\n  background: #f8f9fa;\n}\n\n.action-btn {\n  padding: 6px 12px;\n  border: none;\n  border-radius: 4px;\n  font-size: 12px;\n  cursor: pointer;\n  transition: all 0.2s ease;\n  display: flex;\n  align-items: center;\n  gap: 4px;\n}\n\n.restore-btn {\n  background: #d4edda;\n  color: #155724;\n}\n\n.restore-btn:hover {\n  background: #c3e6cb;\n}\n\n.delete-btn {\n  background: #f8d7da;\n  color: #721c24;\n}\n\n.delete-btn:hover {\n  background: #f5c6cb;\n}\n\n.view-btn {\n  background: #d1ecf1;\n  color: #0c5460;\n  margin-left: auto;\n}\n\n.view-btn:hover {\n  background: #bee5eb;\n}\n\n/* Vista detallada de versi√≥n */\n.version-detail {\n  padding: 10px;\n}\n\n.back-btn {\n  background: none;\n  border: none;\n  color: #3498db;\n  cursor: pointer;\n  padding: 5px 0;\n  margin-bottom: 15px;\n  font-size: 14px;\n}\n\n.back-btn:hover {\n  text-decoration: underline;\n}\n\n.detail-time {\n  font-size: 13px;\n  color: #6c757d;\n  margin-bottom: 20px;\n}\n\n.detail-grid {\n  display: grid;\n  grid-template-columns: 1fr 1fr;\n  gap: 20px;\n  margin: 20px 0;\n}\n\n.detail-section {\n  background: #f8f9fa;\n  padding: 15px;\n  border-radius: 6px;\n  border: 1px solid #e9ecef;\n}\n\n.detail-section.full-width {\n  grid-column: 1 / -1;\n}\n\n.detail-section h5 {\n  margin-top: 0;\n  color: #2c3e50;\n  font-size: 14px;\n  margin-bottom: 10px;\n}\n\n.preview-text {\n  font-size: 13px;\n  line-height: 1.5;\n  color: #495057;\n  font-style: italic;\n  margin-bottom: 10px;\n}\n\n.preview-title {\n  font-size: 12px;\n  color: #6c757d;\n}\n\n.stats-list {\n  list-style: none;\n  padding: 0;\n  margin: 0;\n}\n\n.stats-list li {\n  padding: 5px 0;\n  border-bottom: 1px solid #e9ecef;\n  font-size: 13px;\n}\n\n.stats-list li:last-child {\n  border-bottom: none;\n}\n\n.stats-list li strong {\n  color: #2c3e50;\n  min-width: 140px;\n  display: inline-block;\n}\n\n.header-preview {\n  background: #2c3e50;\n  color: #ecf0f1;\n  padding: 10px;\n  border-radius: 4px;\n  font-family: 'Consolas', monospace;\n  font-size: 11px;\n  max-height: 150px;\n  overflow-y: auto;\n  white-space: pre-wrap;\n}\n\n.detail-actions {\n  margin-top: 20px;\n  text-align: center;\n}\n\n.primary-btn {\n  background: #3498db;\n  color: white;\n  border: none;\n  padding: 10px 20px;\n  border-radius: 6px;\n  cursor: pointer;\n  font-weight: 600;\n  transition: all 0.3s ease;\n}\n\n.primary-btn:hover {\n  background: #2980b9;\n  transform: translateY(-1px);\n}\n\n.empty-state {\n  text-align: center;\n  padding: 40px 20px;\n  color: #6c757d;\n}\n\n.empty-state p {\n  margin-bottom: 20px;\n}\n\n/* Scrollbar personalizado */\n.versions-list::-webkit-scrollbar {\n  width: 6px;\n}\n\n.versions-list::-webkit-scrollbar-track {\n  background: #f1f1f1;\n  border-radius: 3px;\n}\n\n.versions-list::-webkit-scrollbar-thumb {\n  background: #888;\n  border-radius: 3px;\n}\n\n.versions-list::-webkit-scrollbar-thumb:hover {\n  background: #555;\n}\n\n/* ============ ESTILOS EXISTENTES (se mantienen igual) ============ */\n\n.document-view {\n  max-width: 1200px;\n  margin: 0 auto;\n  padding: 20px;\n}\n\n.modal-overlay {\n  position: fixed;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  background-color: rgba(0, 0, 0, 0.6);\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  z-index: 1000;\n  backdrop-filter: blur(4px);\n  animation: fadeIn 0.2s ease-out;\n}\n\n.modal-container {\n  background: white;\n  border-radius: 12px;\n  box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);\n  width: 90%;\n  max-width: 450px;\n  overflow: hidden;\n  animation: slideUp 0.3s ease-out;\n  border: 1px solid #e1e8ed;\n}\n\n.modal-header {\n  display: flex;\n  align-items: center;\n  padding: 20px 24px 0;\n  background: linear-gradient(135deg, #fff9e6 0%, #ffeaa7 100%);\n  border-bottom: 1px solid #fdcb6e;\n}\n\n.modal-title {\n  flex: 1;\n  margin: 0;\n  color: #e67e22;\n  font-size: 1.3rem;\n  font-weight: 700;\n}\n\n.modal-close-btn {\n  background: none;\n  border: none;\n  font-size: 24px;\n  cursor: pointer;\n  color: #95a5a6;\n  width: 32px;\n  height: 32px;\n  border-radius: 50%;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  transition: all 0.2s ease;\n}\n\n.modal-close-btn:hover {\n  background: #f8f9fa;\n  color: #e74c3c;\n}\n\n.modal-content {\n  padding: 24px;\n  text-align: center;\n}\n\n.modal-message {\n  font-size: 1.1rem;\n  font-weight: 600;\n  color: #2c3e50;\n  margin: 0 0 8px 0;\n  line-height: 1.4;\n}\n\n.modal-warning {\n  font-size: 0.95rem;\n  color: #e74c3c;\n  margin: 0;\n  font-weight: 500;\n}\n\n.modal-actions {\n  display: flex;\n  gap: 12px;\n  padding: 0 24px 24px;\n  justify-content: center;\n}\n\n.modal-btn {\n  flex: 1;\n  border: none;\n  padding: 12px 20px;\n  border-radius: 8px;\n  cursor: pointer;\n  font-size: 14px;\n  font-weight: 600;\n  transition: all 0.3s ease;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  gap: 8px;\n  min-height: 44px;\n}\n\n.modal-btn-cancel {\n  background-color: #ecf0f1;\n  color: #2c3e50;\n  border: 2px solid #bdc3c7;\n}\n\n.modal-btn-cancel:hover {\n  background-color: #d5dbdb;\n  border-color: #95a5a6;\n  transform: translateY(-1px);\n}\n\n.modal-btn-confirm {\n  background: linear-gradient(135deg, #e74c3c 0%, #c0392b 100%);\n  color: white;\n  border: 2px solid #c0392b;\n}\n\n.modal-btn-confirm:hover {\n  background: linear-gradient(135deg, #c0392b 0%, #a93226 100%);\n  transform: translateY(-1px);\n  box-shadow: 0 4px 12px rgba(231, 76, 60, 0.3);\n}\n\n.modal-btn-secondary {\n  background: #3498db;\n  color: white;\n  border: 2px solid #2980b9;\n}\n\n.modal-btn-secondary:hover {\n  background: #2980b9;\n  transform: translateY(-1px);\n}\n\n.modal-btn-primary {\n  background: #2ecc71;\n  color: white;\n  border: 2px solid #27ae60;\n}\n\n.modal-btn-primary:hover {\n  background: #27ae60;\n  transform: translateY(-1px);\n}\n\n.btn-icon {\n  font-size: 16px;\n}\n\n@keyframes fadeIn {\n  from { opacity: 0; }\n  to { opacity: 1; }\n}\n\n@keyframes slideUp {\n  from {\n    opacity: 0;\n    transform: translateY(30px) scale(0.95);\n  }\n  to {\n    opacity: 1;\n    transform: translateY(0) scale(1);\n  }\n}\n\n.document-controls {\n  display: flex;\n  gap: 15px;\n  margin-bottom: 30px;\n  justify-content: center;\n  flex-wrap: wrap;\n}\n\n.generate-btn, .reset-btn {\n  border: none;\n  padding: 12px 24px;\n  border-radius: 6px;\n  cursor: pointer;\n  font-size: 14px;\n  font-weight: 600;\n  transition: all 0.3s ease;\n  min-width: 160px;\n}\n\n.generate-btn:disabled {\n  opacity: 0.6;\n  cursor: not-allowed;\n  transform: none;\n}\n\n.generate-btn:disabled:hover {\n  transform: none;\n}\n\n.generate-btn {\n  background-color: #2c5aa0; \n  color: white;\n}\n\n.generate-btn:hover:not(:disabled) {\n  background-color: #15386c; \n  transform: translateY(-2px);\n}\n\n.reset-btn {\n  background-color: red;\n  color: white;\n}\n\n.reset-btn:hover {\n  background-color: rgb(181, 20, 20);\n  transform: translateY(-2px);\n}\n\n.document-editor {\n  background: white;\n  padding: 30px;\n  border-radius: 10px;\n  box-shadow: 0 2px 20px rgba(0, 0, 0, 0.1);\n}\n\n.section {\n  margin-bottom: 30px;\n  padding: 25px;\n  border: 1px solid #e1e8ed;\n  border-radius: 8px;\n  background: #ffffff;\n  transition: box-shadow 0.3s ease;\n}\n\n.section:hover {\n  box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);\n}\n\n.section h3 {\n  color: #2c3e50;\n  margin-bottom: 15px;\n  font-size: 1.4rem;\n  border-bottom: 3px solid #3498db;\n  padding-bottom: 10px;\n  font-weight: 700;\n}\n\n.header-config {\n  background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);\n  border-left: 4px solid #3498db;\n}\n\n.header-fields {\n  display: grid;\n  grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));\n  gap: 15px;\n  margin-top: 15px;\n}\n\n.field-group {\n  display: flex;\n  flex-direction: column;\n}\n\n.field-group label {\n  font-weight: 600;\n  margin-bottom: 5px;\n  color: #2c3e50;\n  font-size: 0.9rem;\n}\n\n.header-input {\n  padding: 10px 12px;\n  border: 2px solid #e9ecef;\n  border-radius: 6px;\n  font-size: 14px;\n  transition: border-color 0.3s ease;\n}\n\n.header-input::placeholder {\n  color: #6c757d;\n  opacity: 0.7;\n  font-style: italic;\n}\n\n.header-input:focus::placeholder {\n  opacity: 0.5;\n}\n\n.header-input:focus {\n  outline: none;\n  border-color: #3498db;\n  box-shadow: 0 0 0 3px rgba(52, 152, 219, 0.1);\n}\n\n.section-description {\n  background: #f8f9fa;\n  padding: 15px;\n  border-radius: 6px;\n  margin-bottom: 15px;\n  font-size: 0.95rem;\n  color: #495057;\n  border-left: 4px solid #3498db;\n}\n\n.section-description p {\n  margin: 0;\n}\n\n.section-description ul {\n  margin: 10px 0;\n  padding-left: 20px;\n}\n\n.section-description li {\n  margin-bottom: 5px;\n  line-height: 1.4;\n}\n\n.format-example {\n  background: #f8f9fa;\n  border: 1px solid #dee2e6;\n  border-radius: 4px;\n  padding: 15px;\n  font-family: 'Consolas', 'Monaco', monospace;\n  font-size: 12px;\n  line-height: 1.4;\n  margin: 10px 0;\n  white-space: pre-wrap;\n  color: #495057;\n}\n\n.rich-text-editor {\n  border: 2px solid #e9ecef;\n  border-radius: 6px;\n  background: white;\n  transition: border-color 0.3s ease;\n  overflow: hidden;\n}\n\n.rich-text-editor:focus-within {\n  border-color: #3498db;\n  box-shadow: 0 0 0 3px rgba(52, 152, 219, 0.1);\n}\n\n.toolbar {\n  display: flex;\n  align-items: center;\n  padding: 8px 12px;\n  background: #f8f9fa;\n  border-bottom: 1px solid #e9ecef;\n  gap: 4px;\n  flex-wrap: wrap;\n}\n\n.toolbar-group {\n  display: flex;\n  align-items: center;\n  gap: 4px;\n}\n\n.toolbar-btn {\n  background: white;\n  border: 1px solid #dee2e6;\n  border-radius: 4px;\n  padding: 6px 8px;\n  font-size: 12px;\n  cursor: pointer;\n  transition: all 0.2s ease;\n  color: #495057;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  min-width: 28px;\n  height: 28px;\n}\n\n.toolbar-btn:hover {\n  background: #e9ecef;\n  border-color: #adb5bd;\n}\n\n.toolbar-btn.active {\n  background: #3498db;\n  color: white;\n  border-color: #3498db;\n}\n\n.style-select {\n  padding: 4px 8px;\n  border: 1px solid #dee2e6;\n  border-radius: 4px;\n  font-size: 11px;\n  background: white;\n  color: #495057;\n  min-width: 120px;\n  height: 28px;\n  cursor: pointer;\n  outline: none;\n}\n\n.style-select:focus {\n  border-color: #3498db;\n  box-shadow: 0 0 0 1px rgba(52, 152, 219, 0.2);\n}\n\n.style-select option {\n  padding: 4px;\n}\n\n.icon-text {\n  font-size: 14px;\n  font-weight: bold;\n}\n\n.icon-align {\n  font-size: 14px;\n  font-weight: bold;\n}\n\n.toolbar-separator {\n  width: 1px;\n  height: 20px;\n  background: #dee2e6;\n  margin: 0 4px;\n}\n\n.editor-content {\n  padding: 15px;\n  min-height: 120px;\n  max-height: 400px;\n  overflow-y: auto;\n  font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;\n  font-size: 14px;\n  line-height: 1.6;\n  color: #2c3e50;\n  background: white;\n  outline: none;\n}\n\n:deep(.ProseMirror) {\n  outline: none;\n  font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;\n  font-size: 14px;\n  line-height: 1.6;\n  color: #2c3e50;\n  min-height: 100px;\n  padding: 0 !important;\n}\n\n:deep(.ProseMirror p) {\n  margin: 0 0 12px 0;\n}\n\n:deep(.ProseMirror:focus) {\n  outline: none;\n}\n\n:deep(.ProseMirror h1) {\n  font-size: 1.5rem !important;\n  font-weight: 700 !important;\n  color: #1F4E79 !important;\n  margin: 1.5rem 0 1rem 0 !important;\n  line-height: 1.2 !important;\n  border-bottom: 2px solid #1F4E79 !important;\n  padding-bottom: 0.5rem !important;\n  font-family: 'Times New Roman', serif !important;\n}\n\n:deep(.ProseMirror h2) {\n  font-size: 1.3rem !important;\n  font-weight: 600 !important;\n  color: #2C3E50 !important;\n  margin: 1.3rem 0 0.8rem 0 !important;\n  line-height: 1.3 !important;\n  border-bottom: 1px solid #D4D4D4 !important;\n  padding-bottom: 0.4rem !important;\n  font-family: 'Times New Roman', serif !important;\n}\n\n:deep(.ProseMirror h3) {\n  font-size: 1.1rem !important;\n  font-weight: 600 !important;\n  color: #34495E !important;\n  margin: 1rem 0 0.5rem 0 !important;\n  line-height: 1.4 !important;\n  font-family: 'Times New Roman', serif !important;\n}\n\n:deep(.ProseMirror blockquote) {\n  border-left: 4px solid #3498db !important;\n  padding-left: 1rem !important;\n  margin: 1rem 0 !important;\n  font-style: italic !important;\n  color: #495057 !important;\n  background: #f8f9fa !important;\n  padding: 0.75rem 1rem !important;\n  border-radius: 4px !important;\n}\n\n:deep(.ProseMirror pre) {\n  background: #2c3e50 !important;\n  color: #ecf0f1 !important;\n  padding: 0.75rem 1rem !important;\n  border-radius: 4px !important;\n  font-family: 'Consolas', 'Monaco', monospace !important;\n  font-size: 0.9rem !important;\n  margin: 1rem 0 !important;\n  overflow-x: auto !important;\n}\n\n:deep(.ProseMirror code) {\n  background: #f8f9fa !important;\n  color: #e74c3c !important;\n  padding: 0.2rem 0.4rem !important;\n  border-radius: 3px !important;\n  font-family: 'Consolas', 'Monaco', monospace !important;\n  font-size: 0.9rem !important;\n}\n\n:deep(.ProseMirror .text-align-left) {\n  text-align: left !important;\n}\n\n:deep(.ProseMirror .text-align-center) {\n  text-align: center !important;\n}\n\n:deep(.ProseMirror .text-align-right) {\n  text-align: right !important;\n}\n\n:deep(.ProseMirror .text-align-justify) {\n  text-align: justify !important;\n  text-justify: inter-word !important;\n}\n\n:deep(.ProseMirror s) {\n  text-decoration: line-through !important;\n  color: #95a5a6 !important;\n}\n\n:deep(.ProseMirror h1:first-child),\n:deep(.ProseMirror h2:first-child),\n:deep(.ProseMirror h3:first-child) {\n  margin-top: 0;\n}\n\n:deep(.ProseMirror ul),\n:deep(.ProseMirror ol) {\n  padding-left: 24px;\n  margin: 12px 0;\n}\n\n:deep(.ProseMirror li) {\n  margin-bottom: 6px;\n  line-height: 1.5;\n}\n\n:deep(.ProseMirror ul li) {\n  list-style-type: disc;\n}\n\n:deep(.ProseMirror ol li) {\n  list-style-type: decimal;\n}\n\n:deep(.ProseMirror strong) {\n  font-weight: 600;\n  color: #2c3e50;\n}\n\n:deep(.ProseMirror em) {\n  font-style: italic;\n}\n\n:deep(.ProseMirror u) {\n  text-decoration: underline;\n}\n\n:deep(.ProseMirror .is-empty:first-child::before) {\n  content: attr(data-placeholder);\n  color: #adb5bd;\n  float: left;\n  height: 0;\n  pointer-events: none;\n}\n\n:deep(ul[data-type=\"letter\"]) {\n  list-style-type: lower-alpha !important;\n  padding-left: 24px !important;\n  margin: 8px 0 !important;\n}\n\n:deep(ul[data-type=\"letter\"] li) {\n  list-style-type: lower-alpha !important;\n  margin-bottom: 4px !important;\n}\n\n:deep(ul:not([data-type=\"letter\"])) {\n  list-style-type: disc !important;\n  padding-left: 24px !important;\n  margin: 8px 0 !important;\n}\n\n:deep(ul:not([data-type=\"letter\"]) li) {\n  list-style-type: disc !important;\n  margin-bottom: 4px !important;\n}\n\n.action-buttons {\n  display: flex;\n  gap: 10px;\n  margin: 20px 0;\n  flex-wrap: wrap;\n}\n\n.parse-btn, .sample-btn {\n  border: none;\n  padding: 10px 16px;\n  border-radius: 5px;\n  cursor: pointer;\n  font-size: 13px;\n  font-weight: 600;\n  transition: all 0.3s ease;\n  display: flex;\n  align-items: center;\n  gap: 6px;\n}\n\n.parse-btn {\n  background-color: #27ae60;\n  color: white;\n}\n\n.sample-btn {\n  background-color: #3498db;\n  color: white;\n}\n\n.parse-btn:hover, .sample-btn:hover {\n  transform: translateY(-1px);\n  opacity: 0.9;\n}\n\n.table-preview {\n  margin: 25px 0;\n  padding: 20px;\n  background: #f8f9fa;\n  border-radius: 8px;\n  border: 1px solid #dee2e6;\n}\n\n.table-preview h4 {\n  margin-bottom: 15px;\n  color: #2c3e50;\n  font-size: 1.1rem;\n  font-weight: 600;\n}\n\n.preview-container {\n  overflow-x: auto;\n  background: white;\n  border: 1px solid #ced4da;\n  border-radius: 6px;\n  padding: 10px;\n}\n\n.preview-table {\n  width: 100%;\n  border-collapse: collapse;\n  border: 1px solid #000;\n  font-size: 11px;\n}\n\n.preview-table th {\n  border: 1px solid #000;\n  padding: 6px 8px;\n  background-color: #f0f0f0;\n  font-weight: bold;\n  text-align: center;\n}\n\n.preview-table td {\n  border: 1px solid #000;\n  padding: 4px 6px;\n  text-align: left;\n  vertical-align: top;\n}\n\n.section-row td {\n  background-color: #e3f2fd;\n  font-weight: bold;\n  border-left: 4px solid #2196f3 !important;\n}\n\n.subsection-row td:first-child {\n  font-weight: bold;\n  background-color: #e8f5e8;\n  padding-left: 30px !important;\n}\n\n.subsection-row td:not(:first-child) {\n  background-color: #e8f5e8;\n  padding-left: 10px;\n}\n\n.question-row td {\n  background-color: #fff3cd !important;\n  font-style: italic;\n  border-left: 4px solid #ffc107 !important;\n}\n\n.alternative-row td {\n  background-color: #d1ecf1 !important;\n  border-left: 4px solid #17a2b8 !important;\n}\n\n.end-row td {\n  background-color: #d4edda !important;\n  font-weight: bold;\n  border-left: 4px solid #28a745 !important;\n}\n\n.empty-row td {\n  background-color: #ffffff;\n  color: #6c757d;\n}\n\n.normal-row td {\n  background-color: #ffffff;\n}\n\n.status-message {\n  padding: 15px 20px;\n  margin: 20px auto;\n  border-radius: 8px;\n  font-weight: 600;\n  text-align: center;\n  max-width: 600px;\n  box-shadow: 0 2px 10px rgba(0,0,0,0.1);\n}\n\n.status-message.success {\n  background-color: #d4edda;\n  color: #155724;\n  border: 1px solid #c3e6cb;\n}\n\n.status-message.error {\n  background-color: #f8d7da;\n  color: #721c24;\n  border: 1px solid #f5c6cb;\n}\n\n.status-message.info {\n  background-color: #d1ecf1;\n  color: #0c5460;\n  border: 1px solid #bee5eb;\n}\n\n/* Responsive breakpoints */\n@media (max-width: 1024px) {\n  .document-editor {\n    padding: 22px;\n  }\n\n  .header-fields {\n    grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));\n    gap: 12px;\n  }\n\n  .section h3 {\n    font-size: 1.25rem;\n  }\n\n  .editor-content {\n    min-height: 100px;\n    max-height: 300px;\n    padding: 12px;\n  }\n\n  .preview-table {\n    font-size: 10px;\n  }\n\n  .action-buttons {\n    gap: 8px;\n  }\n  \n  .style-select {\n    min-width: 100px;\n    font-size: 10px;\n  }\n}\n\n@media (max-width: 768px) {\n  .document-view {\n    padding: 8px;\n  }\n\n  .document-controls {\n    flex-direction: column;\n    align-items: stretch;\n    width: 100%;\n    gap: 10px;\n  }\n  \n  .generate-btn, .reset-btn {\n    width: 100%;\n    max-width: none;\n  }\n  \n  .action-buttons {\n    justify-content: center;\n    flex-direction: column;\n    align-items: stretch;\n  }\n\n  .parse-btn, .sample-btn {\n    width: 100%;\n  }\n  \n  .section {\n    padding: 12px;\n  }\n  \n  .header-fields {\n    grid-template-columns: 1fr;\n  }\n\n  .format-example {\n    font-size: 11px;\n    padding: 12px;\n  }\n\n  .toolbar {\n    padding: 6px 8px;\n    flex-direction: column;\n    align-items: flex-start;\n    gap: 8px;\n  }\n\n  .toolbar-group {\n    flex-wrap: wrap;\n  }\n\n  .toolbar-btn {\n    padding: 4px 6px;\n    font-size: 11px;\n    min-width: 24px;\n    height: 24px;\n  }\n  \n  .style-select {\n    min-width: 80px;\n    font-size: 9px;\n    height: 24px;\n    padding: 2px 4px;\n  }\n\n  /* Modal responsive */\n  .modal-container {\n    width: 95%;\n    margin: 20px;\n  }\n  \n  .modal-header {\n    padding: 16px 20px 0;\n  }\n  \n  .modal-content {\n    padding: 20px;\n  }\n  \n  .modal-actions {\n    flex-direction: column;\n    padding: 0 20px 20px;\n  }\n  \n  .modal-btn {\n    width: 100%;\n  }\n  \n  .modal-title {\n    font-size: 1.2rem;\n  }\n  \n  .modal-message {\n    font-size: 1rem;\n  }\n  \n  /* Versiones responsive */\n  .version-control-bar {\n    flex-direction: column;\n    align-items: flex-start;\n  }\n  \n  .version-info {\n    margin-left: 0;\n    margin-top: 10px;\n  }\n  \n  .version-detail .detail-grid {\n    grid-template-columns: 1fr;\n  }\n}\n\n@media (max-width: 480px) {\n  .document-view {\n    padding: 6px;\n  }\n\n  .document-editor {\n    padding: 12px;\n  }\n\n  .section h3 {\n    font-size: 1.05rem;\n    padding-bottom: 8px;\n  }\n\n  .header-input {\n    padding: 9px 10px;\n    font-size: 13px;\n  }\n\n  .editor-content {\n    min-height: 80px;\n    max-height: 250px;\n    padding: 10px;\n  }\n\n  .preview-container {\n    padding: 6px;\n  }\n\n  .preview-table th, .preview-table td {\n    padding: 6px 6px;\n  }\n\n  .button-icon {\n    display: none;\n  }\n  \n  .style-select {\n    min-width: 70px;\n    font-size: 8px;\n  }\n}\n</style>"],"mappings":";;;;;AAo1BA,SAASA,oBAAmB,QAAS,sBAAqB;AAC1D,SAASC,MAAM,EAAEC,aAAY,QAAS,eAAc;AACpD,OAAOC,UAAS,MAAO,qBAAoB;AAC3C,OAAOC,OAAM,MAAO,2BAA0B;AAC9C,OAAOC,SAAQ,MAAO,6BAA4B;AAClD,OAAOC,MAAK,MAAO,0BAAyB;AAC5C,OAAOC,WAAU,MAAO,+BAA8B;AACtD,OAAOC,SAAQ,MAAO,8BAA6B;AACnD,OAAOC,UAAS,MAAO,+BAA8B;AACrD,OAAOC,WAAU,MAAO,gCAA+B;AACvD,OAAOC,UAAS,MAAO,8BAA6B;AACpD,OAAOC,SAAQ,MAAO,8BAA6B;AACnD,OAAOC,SAAQ,MAAO,8BAA6B;;AAEnD;AACA,MAAMC,mBAAkB,GAAIL,UAAU,CAACM,MAAM,CAAC;EAC5CC,aAAaA,CAAA,EAAG;IACd,OAAO;MACL,WAAW,EAAE;QACXC,OAAO,EAAE,IAAI;QACbC,SAAS,EAAEC,OAAM,IAAKA,OAAO,CAACC,YAAY,CAAC,WAAW,CAAC;QACvDC,UAAU,EAAEC,UAAS,IAAK;UACxB,OAAOA,UAAU,CAAC,WAAW,IAAI;YAAE,WAAW,EAAEA,UAAU,CAAC,WAAW;UAAE,IAAI,CAAC;QAC/E;MACF;IACF;EACF;AACF,CAAC;AAED,eAAe;EACbC,IAAI,EAAE,cAAc;EACpBC,UAAU,EAAE;IACVtB;EACF,CAAC;EACDuB,IAAIA,CAAA,EAAG;IACL,OAAO;MACL;MACAC,cAAc,EAAE,KAAK;MACrBC,uBAAuB,EAAE,KAAK;MAC9BC,qBAAqB,EAAE,IAAI;MAE3B;MACAC,YAAY,EAAE;QACZC,UAAU,EAAE,EAAE;QACdC,UAAU,EAAE,EAAE;QACdC,MAAM,EAAE,EAAE;QACVC,IAAI,EAAE,EAAE;QACRC,MAAM,EAAE,EAAE;QACVC,QAAQ,EAAE,EAAE;QACZC,KAAK,EAAE,IAAI,CAACC,gBAAgB,CAAC;MAC/B,CAAC;MAED;MACAC,QAAQ,EAAE,CACR;QACEC,KAAK,EAAE,yBAAyB;QAChCC,WAAW,EAAE,oDAAoD;QACjEC,WAAW,EAAE,+EAA+E;QAC5FC,OAAO,EAAE,EAAE;QACXC,MAAM,EAAE;MACV,CAAC,EACD;QACEJ,KAAK,EAAE,YAAY;QACnBC,WAAW,EAAE,oDAAoD;QACjEC,WAAW,EAAE,iFAAiF;QAC9FC,OAAO,EAAE,EAAE;QACXC,MAAM,EAAE;MACV,CAAC,EACD;QACEJ,KAAK,EAAE,sBAAsB;QAC7BC,WAAW,EAAE,4DAA4D;QACzEC,WAAW,EAAE,0DAA0D;QACvEC,OAAO,EAAE,EAAE;QACXC,MAAM,EAAE;MACV,CAAC,EACD;QACEJ,KAAK,EAAE,cAAc;QACrBC,WAAW,EAAE,0DAA0D;QACvEC,WAAW,EAAE,uFAAuF;QACpGC,OAAO,EAAE,EAAE;QACXC,MAAM,EAAE;MACV,EACD;MAEDC,iBAAiB,EAAE,CACjB;QACEL,KAAK,EAAE,WAAW;QAClBC,WAAW,EAAE,wDAAwD;QACrEC,WAAW,EAAE,kDAAkD;QAC/DC,OAAO,EAAE,EAAE;QACXC,MAAM,EAAE;MACV,CAAC,EACD;QACEJ,KAAK,EAAE,2BAA2B;QAClCC,WAAW,EAAE,uDAAuD;QACpEC,WAAW,EAAE,kDAAkD;QAC/DC,OAAO,EAAE,EAAE;QACXC,MAAM,EAAE;MACV,EACD;MAED;MACAE,cAAc,EAAE,EAAE;MAClBC,mBAAmB,EAAE,IAAI;MAEzB;MACAC,gBAAgB,EAAE,EAAE;MACpBC,mBAAmB,EAAE,CAAC;MACtBC,WAAW,EAAE,EAAE;MACfC,cAAc,EAAE,EAAE;MAClBC,UAAU,EAAE,IAAI;MAChBC,iBAAiB,EAAE,KAAK;MACxBC,aAAa,EAAE,IAAI;MACnBC,eAAe,EAAE,IAAI;MACrBC,gBAAgB,EAAE,IAAI;MACtBC,iBAAiB,EAAE,KAAK;MAAE;;MAE1B;MACAC,aAAa,EAAE,EAAE;MACjBC,UAAU,EAAE,EAAE;MACdC,YAAY,EAAE;IAChB;EACF,CAAC;EACDC,QAAQ,EAAE;IACRC,cAAcA,CAAA,EAAG;MACf,OAAO,IAAI,CAAChB,cAAc;IAC5B,CAAC;IAED;IACAiB,aAAaA,CAAA,EAAG;MACd,OAAO;QACLC,SAAS,EAAE,IAAI,CAACC,uBAAuB,CAAC,CAAC;QACzCC,UAAU,EAAE,IAAI,CAACC,2BAA2B,CAAC,CAAC;QAC9C5B,QAAQ,EAAE,IAAI,CAACA,QAAQ,CAAC6B,MAAK,GAAI,IAAI,CAACvB,iBAAiB,CAACuB,MAAM;QAC9DC,cAAc,EAAE,IAAI,CAACvB,cAAc,CAACsB,MAAM;QAC1CE,WAAW,EAAE,IAAI,CAACtB,gBAAgB,CAAC,CAAC,IAAI,IAAI,CAACuB,UAAU,CAAC,IAAI,CAACvB,gBAAgB,CAAC,CAAC,CAAC,CAACwB,SAAS,IAAI;MAChG,CAAC;IACH;EACF,CAAC;EACDC,OAAOA,CAAA,EAAG;IACR,IAAI,CAACC,SAAS,CAAC,MAAM;MACnB,IAAI,CAACC,iBAAiB,CAAC,CAAC;MACxB,IAAI,CAACC,uBAAuB,CAAC,CAAC;IAChC,CAAC,CAAC;;IAEF;IACA,IAAI,CAACC,mBAAmB,CAAC,CAAC;;IAE1B;IACAC,MAAM,CAACC,gBAAgB,CAAC,cAAc,EAAE,IAAI,CAACC,kBAAkB,CAAC;EAClE,CAAC;EACDC,aAAaA,CAAA,EAAG;IACd,IAAI,CAACC,cAAc,CAAC,CAAC;IACrB,IAAI,CAACC,YAAY,CAAC,CAAC;IACnBL,MAAM,CAACM,mBAAmB,CAAC,cAAc,EAAE,IAAI,CAACJ,kBAAkB,CAAC;EACrE,CAAC;EACDK,OAAO,EAAE;IACP;;IAEA;;;IAGAT,uBAAuBA,CAAA,EAAG;MACxB;MACA,IAAI,CAACxB,UAAS,GAAI,OAAOkC,IAAI,CAACC,GAAG,CAAC,CAAC,IAAIC,IAAI,CAACC,MAAM,CAAC,CAAC,CAACC,QAAQ,CAAC,EAAE,CAAC,CAACC,MAAM,CAAC,CAAC,EAAE,CAAC,CAAC,EAAE;;MAEhF;MACA,IAAI,CAACC,uBAAuB,CAAC,CAAC;;MAE9B;MACA,IAAI,IAAI,CAAC5C,gBAAgB,CAACoB,MAAK,KAAM,CAAC,EAAE;QACtC,IAAI,CAACyB,cAAc,CAAC,+BAA+B,CAAC;MACtD,OAAO;QACL,IAAI,CAACvC,aAAY,GAAI,IAAI,CAACN,gBAAgB,CAAC,CAAC,CAAC,EAAEwB,SAAS;MAC1D;;MAEA;MACA,IAAI,CAACsB,oBAAoB,CAAC,CAAC;MAE3BC,OAAO,CAACC,GAAG,CAAC,qCAAqC,CAAC;IACpD,CAAC;IAED;;;IAGAH,cAAcA,CAACpD,WAAU,GAAI,yBAAyB,EAAE;MACtD,IAAI;QACF,MAAMwD,WAAU,GAAI,IAAI,CAACC,qBAAqB,CAACzD,WAAW,CAAC;;QAE3D;QACA,IAAI,CAACO,gBAAgB,CAACmD,OAAO,CAACF,WAAW,CAAC;;QAE1C;QACA,IAAI,IAAI,CAACjD,gBAAgB,CAACoB,MAAK,GAAI,IAAI,CAAClB,WAAW,EAAE;UACnD,IAAI,CAACF,gBAAgB,CAACoD,GAAG,CAAC,CAAC;QAC7B;;QAEA;QACA,IAAI,CAACnD,mBAAkB,GAAI,CAAC;;QAE5B;QACA,IAAI,CAACK,aAAY,GAAI2C,WAAW,CAACzB,SAAS;;QAE1C;QACA,IAAI,CAACrB,cAAc,CAACgD,OAAO,CAAC;UAC1BE,MAAM,EAAE,eAAe;UACvBC,SAAS,EAAEL,WAAW,CAACM,EAAE;UACzB9D,WAAW,EAAEA,WAAW;UACxB+B,SAAS,EAAE,IAAIc,IAAI,CAAC,CAAC,CAACkB,WAAW,CAAC,CAAC;UACnCC,IAAI,EAAE;QACR,CAAC,CAAC;;QAEF;QACA,IAAI,CAACC,qBAAqB,CAAC,CAAC;;QAE5B;QACA,IAAI,CAACrD,iBAAgB,GAAI,KAAK;QAE9B0C,OAAO,CAACC,GAAG,CAAC,wBAAwBvD,WAAW,EAAE,CAAC;QAClD,OAAOwD,WAAW,CAACM,EAAE;MAEvB,EAAE,OAAOI,KAAK,EAAE;QACdZ,OAAO,CAACY,KAAK,CAAC,6BAA6B,EAAEA,KAAK,CAAC;QACnD,OAAO,IAAI;MACb;IACF,CAAC;IAED;;;IAGAT,qBAAqBA,CAACzD,WAAW,EAAE;MACjC;MACA,MAAMuB,SAAQ,GAAI,IAAI,CAACC,uBAAuB,CAAC,CAAC;MAChD,MAAMC,UAAS,GAAI,IAAI,CAACC,2BAA2B,CAAC,CAAC;MAErD,OAAO;QACLoC,EAAE,EAAE,IAAIjB,IAAI,CAACC,GAAG,CAAC,CAAC,IAAIC,IAAI,CAACC,MAAM,CAAC,CAAC,CAACC,QAAQ,CAAC,EAAE,CAAC,CAACC,MAAM,CAAC,CAAC,EAAE,CAAC,CAAC,EAAE;QAC/DnB,SAAS,EAAE,IAAIc,IAAI,CAAC,CAAC,CAACkB,WAAW,CAAC,CAAC;QACnC/D,WAAW,EAAEA,WAAW;QACxBf,IAAI,EAAE;UACJ;UACAI,YAAY,EAAE8E,IAAI,CAACC,KAAK,CAACD,IAAI,CAACE,SAAS,CAAC,IAAI,CAAChF,YAAY,CAAC,CAAC;UAE3D;UACAS,QAAQ,EAAE,IAAI,CAACA,QAAQ,CAACwE,GAAG,CAACC,OAAM,KAAM;YACtCxE,KAAK,EAAEwE,OAAO,CAACxE,KAAK;YACpBG,OAAO,EAAEqE,OAAO,CAACpE,MAAK,GAAIoE,OAAO,CAACpE,MAAM,CAACqE,OAAO,CAAC,IAAI,EAAE;YACvDC,IAAI,EAAEF,OAAO,CAACpE,MAAK,GAAIoE,OAAO,CAACpE,MAAM,CAACuE,OAAO,CAAC,IAAI;UACpD,CAAC,CAAC,CAAC;UAEH;UACAtE,iBAAiB,EAAE,IAAI,CAACA,iBAAiB,CAACkE,GAAG,CAACC,OAAM,KAAM;YACxDxE,KAAK,EAAEwE,OAAO,CAACxE,KAAK;YACpBG,OAAO,EAAEqE,OAAO,CAACpE,MAAK,GAAIoE,OAAO,CAACpE,MAAM,CAACqE,OAAO,CAAC,IAAI,EAAE;YACvDC,IAAI,EAAEF,OAAO,CAACpE,MAAK,GAAIoE,OAAO,CAACpE,MAAM,CAACuE,OAAO,CAAC,IAAI;UACpD,CAAC,CAAC,CAAC;UAEH;UACAC,aAAa,EAAE;YACbzE,OAAO,EAAE,IAAI,CAACI,mBAAkB,GAAI,IAAI,CAACA,mBAAmB,CAACkE,OAAO,CAAC,IAAI,EAAE;YAC3EC,IAAI,EAAE,IAAI,CAACnE,mBAAkB,GAAI,IAAI,CAACA,mBAAmB,CAACoE,OAAO,CAAC,IAAI,EAAE;YACxEE,KAAK,EAAET,IAAI,CAACC,KAAK,CAACD,IAAI,CAACE,SAAS,CAAC,IAAI,CAAChE,cAAc,CAAC;UACvD;QACF,CAAC;QACDwE,OAAO,EAAE,IAAI,CAACC,sBAAsB,CAACvD,SAAS,EAAEE,UAAU;MAC5D,CAAC;IACH,CAAC;IAED;;;IAGAqD,sBAAsBA,CAACvD,SAAS,EAAEE,UAAU,EAAE;MAC5C;MACA,IAAIsD,OAAM,GAAI,EAAE;MAChB,IAAI,IAAI,CAACjF,QAAQ,CAAC6B,MAAK,GAAI,KAAK,IAAI,CAAC7B,QAAQ,CAAC,CAAC,CAAC,CAACK,MAAM,EAAE;QACvD,MAAMsE,IAAG,GAAI,IAAI,CAAC3E,QAAQ,CAAC,CAAC,CAAC,CAACK,MAAM,CAACuE,OAAO,CAAC,CAAC;QAC9CK,OAAM,GAAIN,IAAI,CAACO,SAAS,CAAC,CAAC,EAAE,GAAG,KAAKP,IAAI,CAAC9C,MAAK,GAAI,GAAE,GAAI,KAAI,GAAI,EAAE,CAAC;MACrE;MAEA,OAAO;QACL5B,KAAK,EAAE,IAAI,CAACV,YAAY,CAACE,UAAS,IAAK,sBAAsB;QAC7DwF,OAAO,EAAEA,OAAM,IAAK,eAAe;QACnCE,KAAK,EAAE1D,SAAS;QAChBE,UAAU,EAAEA,UAAU;QACtB3B,QAAQ,EAAE,IAAI,CAACA,QAAQ,CAAC6B,MAAK,GAAI,IAAI,CAACvB,iBAAiB,CAACuB,MAAM;QAC9DC,cAAc,EAAE,IAAI,CAACvB,cAAc,CAACsB;MACtC,CAAC;IACH,CAAC;IAED;;;IAGAuD,cAAcA,CAACrB,SAAS,EAAE;MACxB,MAAMsB,YAAW,GAAI,IAAI,CAAC5E,gBAAgB,CAAC6E,SAAS,CAACC,CAAA,IAAKA,CAAC,CAACvB,EAAC,KAAMD,SAAS,CAAC;MAE7E,IAAIsB,YAAW,KAAM,CAAC,CAAC,EAAE;QACvB,IAAI,CAACG,UAAU,CAAC,yBAAyB,EAAE,OAAO,CAAC;QACnD,OAAO,KAAK;MACd;MAEA,MAAMC,OAAM,GAAI,IAAI,CAAChF,gBAAgB,CAAC4E,YAAY,CAAC;;MAEnD;MACA,IAAI,CAACK,OAAO,CAAC,0BAA0B,IAAI,CAAC1D,UAAU,CAACyD,OAAO,CAACxD,SAAS,CAAC,SAASwD,OAAO,CAACvF,WAAW,GAAG,CAAC,EAAE;QACzG,OAAO,KAAK;MACd;MAEA,IAAI;QACF;QACA,IAAI,CAACX,YAAW,GAAI8E,IAAI,CAACC,KAAK,CAACD,IAAI,CAACE,SAAS,CAACkB,OAAO,CAACtG,IAAI,CAACI,YAAY,CAAC,CAAC;;QAEzE;QACA,IAAI,CAACS,QAAQ,CAAC2F,OAAO,CAAC,CAAClB,OAAO,EAAEmB,KAAK,KAAK;UACxC,IAAIH,OAAO,CAACtG,IAAI,CAACa,QAAQ,CAAC4F,KAAK,KAAKnB,OAAO,CAACpE,MAAM,EAAE;YAClDoE,OAAO,CAACpE,MAAM,CAACwF,QAAQ,CAACC,UAAU,CAACL,OAAO,CAACtG,IAAI,CAACa,QAAQ,CAAC4F,KAAK,CAAC,CAACxF,OAAO,CAAC;UAC1E;QACF,CAAC,CAAC;;QAEF;QACA,IAAI,CAACE,iBAAiB,CAACqF,OAAO,CAAC,CAAClB,OAAO,EAAEmB,KAAK,KAAK;UACjD,IAAIH,OAAO,CAACtG,IAAI,CAACmB,iBAAiB,CAACsF,KAAK,KAAKnB,OAAO,CAACpE,MAAM,EAAE;YAC3DoE,OAAO,CAACpE,MAAM,CAACwF,QAAQ,CAACC,UAAU,CAACL,OAAO,CAACtG,IAAI,CAACmB,iBAAiB,CAACsF,KAAK,CAAC,CAACxF,OAAO,CAAC;UACnF;QACF,CAAC,CAAC;;QAEF;QACA,IAAI,IAAI,CAACI,mBAAkB,IAAKiF,OAAO,CAACtG,IAAI,CAAC0F,aAAa,EAAE;UAC1D,IAAI,CAACrE,mBAAmB,CAACqF,QAAQ,CAACC,UAAU,CAACL,OAAO,CAACtG,IAAI,CAAC0F,aAAa,CAACzE,OAAO,CAAC;UAChF,IAAI,CAACG,cAAa,GAAI8D,IAAI,CAACC,KAAK,CAACD,IAAI,CAACE,SAAS,CAACkB,OAAO,CAACtG,IAAI,CAAC0F,aAAa,CAACC,KAAK,CAAC,CAAC;QACpF;;QAEA;QACA,IAAI,CAACpE,mBAAkB,GAAI2E,YAAY;;QAEvC;QACA,IAAI,CAACzE,cAAc,CAACgD,OAAO,CAAC;UAC1BE,MAAM,EAAE,kBAAkB;UAC1BC,SAAS,EAAEA,SAAS;UACpB9B,SAAS,EAAE,IAAIc,IAAI,CAAC,CAAC,CAACkB,WAAW,CAAC,CAAC;UACnCC,IAAI,EAAE;QACR,CAAC,CAAC;QAEF,IAAI,CAACC,qBAAqB,CAAC,CAAC;;QAE5B;QACA,IAAI,CAAC9E,uBAAsB,GAAI,KAAK;QACpC,IAAI,CAACC,qBAAoB,GAAI,IAAI;QAEjC,IAAI,CAACkG,UAAU,CAAC,yBAAyBC,OAAO,CAACvF,WAAW,EAAE,EAAE,SAAS,CAAC;QAC1E,OAAO,IAAI;MAEb,EAAE,OAAOkE,KAAK,EAAE;QACdZ,OAAO,CAACY,KAAK,CAAC,8BAA8B,EAAEA,KAAK,CAAC;QACpD,IAAI,CAACoB,UAAU,CAAC,iCAAiC,EAAE,OAAO,CAAC;QAC3D,OAAO,KAAK;MACd;IACF,CAAC;IAED;;;IAGAO,aAAaA,CAAChC,SAAS,EAAE;MACvB,MAAM6B,KAAI,GAAI,IAAI,CAACnF,gBAAgB,CAAC6E,SAAS,CAACC,CAAA,IAAKA,CAAC,CAACvB,EAAC,KAAMD,SAAS,CAAC;MAEtE,IAAI6B,KAAI,KAAM,CAAC,CAAC,EAAE,OAAO,KAAK;MAE9B,IAAI,CAACF,OAAO,CAAC,+CAA+C,IAAI,CAACjF,gBAAgB,CAACmF,KAAK,CAAC,CAAC1F,WAAW,GAAG,CAAC,EAAE;QACxG,OAAO,KAAK;MACd;;MAEA;MACA,IAAI,IAAI,CAACO,gBAAgB,CAACoB,MAAK,KAAM,CAAC,EAAE;QACtC,IAAI,CAAC2D,UAAU,CAAC,kDAAkD,EAAE,OAAO,CAAC;QAC5E,OAAO,KAAK;MACd;;MAEA;MACA,IAAII,KAAI,KAAM,IAAI,CAAClF,mBAAmB,EAAE;QACtC,IAAI,CAACA,mBAAkB,GAAI,CAAC;MAC9B,OAAO,IAAIkF,KAAI,GAAI,IAAI,CAAClF,mBAAmB,EAAE;QAC3C,IAAI,CAACA,mBAAmB,EAAE;MAC5B;MAEA,IAAI,CAACD,gBAAgB,CAACuF,MAAM,CAACJ,KAAK,EAAE,CAAC,CAAC;MACtC,IAAI,CAACzB,qBAAqB,CAAC,CAAC;MAE5B,IAAI,CAACqB,UAAU,CAAC,uBAAuB,EAAE,MAAM,CAAC;MAChD,OAAO,IAAI;IACb,CAAC;IAED;;;IAGArB,qBAAqBA,CAAA,EAAG;MACtB,IAAI;QACF,MAAMhF,IAAG,GAAI;UACX8G,QAAQ,EAAE,IAAI,CAACxF,gBAAgB;UAC/ByF,OAAO,EAAE,IAAI,CAACtF,cAAc;UAC5BuF,YAAY,EAAE,IAAI,CAACzF,mBAAmB;UACtCG,UAAU,EAAE,IAAI,CAACA,UAAU;UAC3BuF,WAAW,EAAE,IAAIrD,IAAI,CAAC,CAAC,CAACkB,WAAW,CAAC;QACtC,CAAC;QAEDoC,YAAY,CAACC,OAAO,CAAC,qBAAqB,IAAI,CAACzF,UAAU,EAAE,EAAEwD,IAAI,CAACE,SAAS,CAACpF,IAAI,CAAC,CAAC;QAClF,OAAO,IAAI;MACb,EAAE,OAAOiF,KAAK,EAAE;QACdZ,OAAO,CAACY,KAAK,CAAC,8BAA8B,EAAEA,KAAK,CAAC;QACpD,OAAO,KAAK;MACd;IACF,CAAC;IAED;;;IAGAf,uBAAuBA,CAAA,EAAG;MACxB,IAAI;QACF,MAAMkD,KAAI,GAAIF,YAAY,CAACG,OAAO,CAAC,qBAAqB,IAAI,CAAC3F,UAAU,EAAE,CAAC;QAC1E,IAAI0F,KAAK,EAAE;UACT,MAAMpH,IAAG,GAAIkF,IAAI,CAACC,KAAK,CAACiC,KAAK,CAAC;UAC9B,IAAI,CAAC9F,gBAAe,GAAItB,IAAI,CAAC8G,QAAO,IAAK,EAAE;UAC3C,IAAI,CAACrF,cAAa,GAAIzB,IAAI,CAAC+G,OAAM,IAAK,EAAE;UACxC,IAAI,CAACxF,mBAAkB,GAAIvB,IAAI,CAACgH,YAAW,IAAK,CAAC;UACjD,OAAO,IAAI;QACb;MACF,EAAE,OAAO/B,KAAK,EAAE;QACdZ,OAAO,CAACY,KAAK,CAAC,6BAA6B,EAAEA,KAAK,CAAC;MACrD;MACA,OAAO,KAAK;IACd,CAAC;IAED;;;IAGA9B,mBAAmBA,CAAA,EAAG;MACpB,IAAI,IAAI,CAACtB,eAAe,EAAE;QACxB,IAAI,CAACC,gBAAe,GAAIwF,WAAW,CAAC,MAAM;UACxC,IAAI,IAAI,CAAC3F,iBAAiB,EAAE;YAC1B,IAAI,CAACwC,cAAc,CAAC,iBAAiB,IAAIP,IAAI,CAAC,CAAC,CAAC2D,kBAAkB,CAAC,CAAC,EAAE,CAAC;UACzE;QACF,CAAC,EAAE,IAAI,CAACxF,iBAAiB,CAAC;QAE1BsC,OAAO,CAACC,GAAG,CAAC,kCAAkC,EAAE,IAAI,CAACvC,iBAAgB,GAAI,IAAI,EAAE,UAAU,CAAC;MAC5F;IACF,CAAC;IAED;;;IAGA0B,YAAYA,CAAA,EAAG;MACb,IAAI,IAAI,CAAC3B,gBAAgB,EAAE;QACzB0F,aAAa,CAAC,IAAI,CAAC1F,gBAAgB,CAAC;QACpC,IAAI,CAACA,gBAAe,GAAI,IAAI;QAC5BuC,OAAO,CAACC,GAAG,CAAC,0BAA0B,CAAC;MACzC;IACF,CAAC;IAED;;;IAGAF,oBAAoBA,CAAA,EAAG;MACrB;MACA,MAAMqD,OAAM,GAAI,CACd,GAAG,IAAI,CAAC5G,QAAQ,CAACwE,GAAG,CAACqC,CAAA,IAAKA,CAAC,CAACxG,MAAM,CAAC,EACnC,GAAG,IAAI,CAACC,iBAAiB,CAACkE,GAAG,CAACqC,CAAA,IAAKA,CAAC,CAACxG,MAAM,CAAC,EAC5C,IAAI,CAACG,mBAAkB,CACxB,CAACsG,MAAM,CAACC,OAAO,CAAC;MAEjBH,OAAO,CAACjB,OAAO,CAACtF,MAAK,IAAK;QACxBA,MAAM,CAAC2G,EAAE,CAAC,QAAQ,EAAE,MAAM;UACxB,IAAI,CAACC,aAAa,CAAC,CAAC;QACtB,CAAC,CAAC;MACJ,CAAC,CAAC;IACJ,CAAC;IAED;;;IAGAA,aAAaA,CAAA,EAAG;MACd,IAAI,CAAC,IAAI,CAACnG,iBAAiB,EAAE;QAC3B,IAAI,CAACA,iBAAgB,GAAI,IAAI;QAC7B0C,OAAO,CAACC,GAAG,CAAC,sCAAsC,CAAC;MACrD;IACF,CAAC;IAED;;;IAGAhB,kBAAkBA,CAACyE,KAAK,EAAE;MACxB,IAAI,IAAI,CAACpG,iBAAiB,EAAE;QAC1BoG,KAAK,CAACC,cAAc,CAAC,CAAC;QACtBD,KAAK,CAACE,WAAU,GAAI,wDAAwD;QAC5E,OAAOF,KAAK,CAACE,WAAW;MAC1B;IACF,CAAC;IAED;;IAEA;;;IAGA1F,uBAAuBA,CAAA,EAAG;MACxB,IAAI2F,KAAI,GAAI,CAAC;;MAEb;MACA,IAAI,CAACrH,QAAQ,CAAC2F,OAAO,CAAClB,OAAM,IAAK;QAC/B,IAAIA,OAAO,CAACpE,MAAM,EAAE;UAClB,MAAMsE,IAAG,GAAIF,OAAO,CAACpE,MAAM,CAACuE,OAAO,CAAC,CAAC;UACrCyC,KAAI,IAAK1C,IAAI,CAAC2C,KAAK,CAAC,KAAK,CAAC,CAACR,MAAM,CAACS,IAAG,IAAKA,IAAI,CAAC1F,MAAK,GAAI,CAAC,CAAC,CAACA,MAAM;QACnE;MACF,CAAC,CAAC;;MAEF;MACA,IAAI,CAACvB,iBAAiB,CAACqF,OAAO,CAAClB,OAAM,IAAK;QACxC,IAAIA,OAAO,CAACpE,MAAM,EAAE;UAClB,MAAMsE,IAAG,GAAIF,OAAO,CAACpE,MAAM,CAACuE,OAAO,CAAC,CAAC;UACrCyC,KAAI,IAAK1C,IAAI,CAAC2C,KAAK,CAAC,KAAK,CAAC,CAACR,MAAM,CAACS,IAAG,IAAKA,IAAI,CAAC1F,MAAK,GAAI,CAAC,CAAC,CAACA,MAAM;QACnE;MACF,CAAC,CAAC;;MAEF;MACA,IAAI,IAAI,CAACrB,mBAAmB,EAAE;QAC5B,MAAMmE,IAAG,GAAI,IAAI,CAACnE,mBAAmB,CAACoE,OAAO,CAAC,CAAC;QAC/CyC,KAAI,IAAK1C,IAAI,CAAC2C,KAAK,CAAC,KAAK,CAAC,CAACR,MAAM,CAACS,IAAG,IAAKA,IAAI,CAAC1F,MAAK,GAAI,CAAC,CAAC,CAACA,MAAM;MACnE;MAEA,OAAOwF,KAAK;IACd,CAAC;IAED;;;IAGAzF,2BAA2BA,CAAA,EAAG;MAC5B,IAAI4F,iBAAgB,GAAI,CAAC;MACzB,MAAMC,aAAY,GAAI,IAAI,CAACzH,QAAQ,CAAC6B,MAAK,GAAI,IAAI,CAACvB,iBAAiB,CAACuB,MAAK,GAAI,CAAC,EAAE;;MAEhF;MACA,IAAI,CAAC7B,QAAQ,CAAC2F,OAAO,CAAClB,OAAM,IAAK;QAC/B,IAAIA,OAAO,CAACpE,MAAK,IAAKoE,OAAO,CAACpE,MAAM,CAACuE,OAAO,CAAC,CAAC,CAAC8C,IAAI,CAAC,CAAC,CAAC7F,MAAK,GAAI,EAAE,EAAE;UACjE2F,iBAAiB,EAAE;QACrB;MACF,CAAC,CAAC;;MAEF;MACA,IAAI,CAAClH,iBAAiB,CAACqF,OAAO,CAAClB,OAAM,IAAK;QACxC,IAAIA,OAAO,CAACpE,MAAK,IAAKoE,OAAO,CAACpE,MAAM,CAACuE,OAAO,CAAC,CAAC,CAAC8C,IAAI,CAAC,CAAC,CAAC7F,MAAK,GAAI,EAAE,EAAE;UACjE2F,iBAAiB,EAAE;QACrB;MACF,CAAC,CAAC;;MAEF;MACA,IAAI,IAAI,CAAChH,mBAAkB,IAAK,IAAI,CAACA,mBAAmB,CAACoE,OAAO,CAAC,CAAC,CAAC8C,IAAI,CAAC,CAAC,CAAC7F,MAAK,GAAI,EAAE,EAAE;QACrF2F,iBAAiB,EAAE;MACrB;MAEA,OAAOvE,IAAI,CAAC0E,KAAK,CAAEH,iBAAgB,GAAIC,aAAa,GAAI,GAAG,CAAC;IAC9D,CAAC;IAED;;;IAGAzF,UAAUA,CAAC4F,UAAU,EAAE;MACrB,IAAI,CAACA,UAAU,EAAE,OAAO,OAAO;MAE/B,IAAI;QACF,MAAMC,IAAG,GAAI,IAAI9E,IAAI,CAAC6E,UAAU,CAAC;QACjC,OAAOC,IAAI,CAACC,cAAc,CAAC,OAAO,EAAE;UAClCC,GAAG,EAAE,SAAS;UACdC,KAAK,EAAE,SAAS;UAChBC,IAAI,EAAE,SAAS;UACfC,IAAI,EAAE,SAAS;UACfC,MAAM,EAAE;QACV,CAAC,CAAC;MACJ,EAAE,OAAO/D,KAAK,EAAE;QACd,OAAOwD,UAAU;MACnB;IACF,CAAC;IAED;;IAEA;;;IAGAQ,uBAAuBA,CAAA,EAAG;MACxB,IAAI,CAAC/I,uBAAsB,GAAI,IAAI;MACnC,IAAI,CAACC,qBAAoB,GAAI,IAAI;IACnC,CAAC;IAED;;;IAGA+I,wBAAwBA,CAAA,EAAG;MACzB,IAAI,CAAChJ,uBAAsB,GAAI,KAAK;MACpC,IAAI,CAACC,qBAAoB,GAAI,IAAI;IACnC,CAAC;IAED;;;IAGAgJ,iBAAiBA,CAAC7C,OAAO,EAAE;MACzB,IAAI,CAACnG,qBAAoB,GAAImG,OAAO;IACtC,CAAC;IAED;;;IAGA8C,sBAAsBA,CAAA,EAAG;MACvB,IAAI,IAAI,CAACjJ,qBAAqB,EAAE;QAC9B,IAAI,CAAC8F,cAAc,CAAC,IAAI,CAAC9F,qBAAqB,CAAC0E,EAAE,CAAC;MACpD;IACF,CAAC;IAED;;;IAGAwE,iBAAiBA,CAAA,EAAG;MAClB,MAAMtI,WAAU,GAAIuI,MAAM,CAAC,uCAAuC,EAChE,qBAAqB,IAAI1F,IAAI,CAAC,CAAC,CAAC+E,cAAc,CAAC,CAAC,EAAE,CAAC;MAErD,IAAI5H,WAAU,IAAKA,WAAW,CAACwH,IAAI,CAAC,CAAC,EAAE;QACrC,MAAM3D,SAAQ,GAAI,IAAI,CAACT,cAAc,CAACpD,WAAW,CAACwH,IAAI,CAAC,CAAC,CAAC;QACzD,IAAI3D,SAAS,EAAE;UACb,IAAI,CAACyB,UAAU,CAAC,wBAAwBtF,WAAW,GAAG,EAAE,SAAS,CAAC;QACpE;MACF;IACF,CAAC;IAED;IACA;;IAEAkC,iBAAiBA,CAAA,EAAG;MAClB;MACA,MAAMsG,oBAAmB,GAAI,CAC3B7K,UAAU,CAAC8K,SAAS,CAAC;QACnBC,SAAS,EAAE;UACTC,SAAS,EAAE;QACb,CAAC;QACDC,UAAU,EAAE;UACVC,cAAc,EAAE;YACdC,KAAK,EAAE;UACT;QACF,CAAC;QACDC,SAAS,EAAE;UACTF,cAAc,EAAE;YACdC,KAAK,EAAE;UACT;QACF;MACF,CAAC,CAAC,EACFlL,OAAO,CAAC6K,SAAS,CAAC;QAChBO,MAAM,EAAE,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC;QACjBH,cAAc,EAAE;UACdC,KAAK,EAAE;QACT;MACF,CAAC,CAAC,EACFjL,SAAS,EACTC,MAAM,EACNE,SAAS,CAACyK,SAAS,CAAC;QAClBE,SAAS,EAAE;MACb,CAAC,CAAC,EACFxK,UAAU,CAACsK,SAAS,CAAC;QACnBI,cAAc,EAAE;UACdC,KAAK,EAAE;QACT;MACF,CAAC,CAAC,EACF1K,SAAS,CAACqK,SAAS,CAAC;QAClBQ,mBAAmB,EAAE;MACvB,CAAC,CAAC,EACF5K,SAAS,CAACoK,SAAS,CAAC;QAClBS,KAAK,EAAE,CAAC,SAAS,EAAE,WAAW,CAAC;QAC/BC,UAAU,EAAE,CAAC,MAAM,EAAE,QAAQ,EAAE,OAAO,EAAE,SAAS,CAAC;QAClDC,gBAAgB,EAAE;MACpB,CAAC,CAAC,EACFlL,WAAW,CAACuK,SAAS,CAAC;QACpBI,cAAc,EAAE;UACdC,KAAK,EAAE;QACT;MACF,CAAC,EACF;MAED,MAAMO,YAAW,GAAKpJ,WAAW,IAAK;QACpC,MAAMqJ,UAAS,GAAI,CACjB,GAAGd,oBAAoB,EACvBzK,WAAW,CAAC0K,SAAS,CAAC;UACpBxI,WAAW,EAAEA,CAAC;YAAEsJ;UAAK,CAAC,KAAK;YACzB,IAAIA,IAAI,CAACC,IAAI,CAACzK,IAAG,KAAM,SAAS,EAAE,OAAO,WAAW;YACpD,IAAIwK,IAAI,CAACC,IAAI,CAACzK,IAAG,KAAM,WAAW,EAAE,OAAO,2BAA2B;YACtE,IAAIwK,IAAI,CAACC,IAAI,CAACzK,IAAG,KAAM,YAAY,EAAE,OAAO,qBAAqB;YACjE,OAAOkB,WAAU,IAAK,8BAA8B;UACtD;QACF,CAAC,CAAC,EACF3B,mBAAkB,CACnB;QAED,OAAO,IAAIb,MAAM,CAAC;UAChByC,OAAO,EAAE,EAAE;UACXoJ,UAAU,EAAEA,UAAU;UACtBG,QAAQ,EAAEA,CAAA,KAAM;YACd;UAAA,CACD;UACDC,QAAQ,EAAEA,CAAA,KAAM;YACdpG,OAAO,CAACC,GAAG,CAAC,qBAAqB,CAAC;UACpC,CAAC;UACDoG,WAAW,EAAE;YACX7K,UAAU,EAAE;cACVgK,KAAK,EAAE,6EAA6E;cACpFc,KAAK,EAAE;YACT,CAAC;YACDC,aAAa,EAAEA,CAACC,IAAI,EAAE9C,KAAK,KAAK;cAC9B;cACA;cACA,IAAIA,KAAK,CAAC+C,OAAM,IAAK/C,KAAK,CAACgD,GAAE,KAAM,GAAG,EAAE;gBACtChD,KAAK,CAACC,cAAc,CAAC,CAAC;gBACtB6C,IAAI,CAACG,QAAQ,CAACH,IAAI,CAACI,KAAK,CAACC,EAAE,CAACC,OAAO,CAACN,IAAI,CAACI,KAAK,CAACG,SAAS,CAACC,IAAI,EAAER,IAAI,CAACI,KAAK,CAACG,SAAS,CAACE,EAAE,EAAET,IAAI,CAACI,KAAK,CAACM,MAAM,CAACC,KAAK,CAACC,IAAI,CAAC,CAAC;gBACtH,IAAI,CAAC3D,aAAa,CAAC,CAAC;gBACpB,OAAO,IAAI;cACb;;cAEA;cACA,IAAIC,KAAK,CAAC+C,OAAM,IAAK/C,KAAK,CAACgD,GAAE,KAAM,GAAG,EAAE;gBACtChD,KAAK,CAACC,cAAc,CAAC,CAAC;gBACtB6C,IAAI,CAACG,QAAQ,CAACH,IAAI,CAACI,KAAK,CAACC,EAAE,CAACC,OAAO,CAACN,IAAI,CAACI,KAAK,CAACG,SAAS,CAACC,IAAI,EAAER,IAAI,CAACI,KAAK,CAACG,SAAS,CAACE,EAAE,EAAET,IAAI,CAACI,KAAK,CAACM,MAAM,CAACC,KAAK,CAACE,MAAM,CAAC,CAAC;gBACxH,IAAI,CAAC5D,aAAa,CAAC,CAAC;gBACpB,OAAO,IAAI;cACb;;cAEA;cACA,IAAIC,KAAK,CAAC+C,OAAM,IAAK/C,KAAK,CAACgD,GAAE,KAAM,GAAG,EAAE;gBACtChD,KAAK,CAACC,cAAc,CAAC,CAAC;gBACtB6C,IAAI,CAACG,QAAQ,CAACH,IAAI,CAACI,KAAK,CAACC,EAAE,CAACC,OAAO,CAACN,IAAI,CAACI,KAAK,CAACG,SAAS,CAACC,IAAI,EAAER,IAAI,CAACI,KAAK,CAACG,SAAS,CAACE,EAAE,EAAET,IAAI,CAACI,KAAK,CAACM,MAAM,CAACC,KAAK,CAACG,SAAS,CAAC,CAAC;gBAC3H,IAAI,CAAC7D,aAAa,CAAC,CAAC;gBACpB,OAAO,IAAI;cACb;;cAEA;cACA,IAAIC,KAAK,CAAC+C,OAAM,IAAK/C,KAAK,CAAC6D,QAAO,IAAK7D,KAAK,CAACgD,GAAE,KAAM,GAAG,EAAE;gBACxDhD,KAAK,CAACC,cAAc,CAAC,CAAC;gBACtB6C,IAAI,CAACG,QAAQ,CAACH,IAAI,CAACI,KAAK,CAACC,EAAE,CAACC,OAAO,CAACN,IAAI,CAACI,KAAK,CAACG,SAAS,CAACC,IAAI,EAAER,IAAI,CAACI,KAAK,CAACG,SAAS,CAACE,EAAE,EAAET,IAAI,CAACI,KAAK,CAACM,MAAM,CAACC,KAAK,CAACK,MAAM,CAAC,CAAC;gBACxH,IAAI,CAAC/D,aAAa,CAAC,CAAC;gBACpB,OAAO,IAAI;cACb;;cAEA;cACA,IAAIC,KAAK,CAAC+C,OAAM,IAAK/C,KAAK,CAACgD,GAAE,KAAM,GAAG,EAAE;gBACtChD,KAAK,CAACC,cAAc,CAAC,CAAC;gBACtB6C,IAAI,CAACG,QAAQ,CAACH,IAAI,CAACI,KAAK,CAACC,EAAE,CAACY,IAAI,CAAC,CAAC,CAAC;gBACnC,IAAI,CAAChE,aAAa,CAAC,CAAC;gBACpB,OAAO,IAAI;cACb;;cAEA;cACA,IAAIC,KAAK,CAAC+C,OAAM,IAAK/C,KAAK,CAACgD,GAAE,KAAM,GAAG,EAAE;gBACtChD,KAAK,CAACC,cAAc,CAAC,CAAC;gBACtB6C,IAAI,CAACG,QAAQ,CAACH,IAAI,CAACI,KAAK,CAACC,EAAE,CAACa,IAAI,CAAC,CAAC,CAAC;gBACnC,IAAI,CAACjE,aAAa,CAAC,CAAC;gBACpB,OAAO,IAAI;cACb;cAEA,OAAO,KAAK;YACd;UACF;QACF,CAAC,CAAC;MACJ,CAAC;;MAED;MACA,IAAI,CAACjH,QAAQ,CAAC2F,OAAO,CAAC,CAAClB,OAAO,EAAEmB,KAAK,KAAK;QACxC,MAAMvF,MAAK,GAAIkJ,YAAY,CAAC9E,OAAO,CAACtE,WAAW,CAAC;QAChDE,MAAM,CAAC2G,EAAE,CAAC,QAAQ,EAAE,MAAM;UACxB,IAAI,CAAChH,QAAQ,CAAC4F,KAAK,CAAC,CAACxF,OAAM,GAAIC,MAAM,CAACqE,OAAO,CAAC,CAAC;QACjD,CAAC,CAAC;QACFD,OAAO,CAACpE,MAAK,GAAIA,MAAM;MACzB,CAAC,CAAC;;MAEF;MACA,IAAI,CAACC,iBAAiB,CAACqF,OAAO,CAAC,CAAClB,OAAO,EAAEmB,KAAK,KAAK;QACjD,MAAMvF,MAAK,GAAIkJ,YAAY,CAAC9E,OAAO,CAACtE,WAAW,CAAC;QAChDE,MAAM,CAAC2G,EAAE,CAAC,QAAQ,EAAE,MAAM;UACxB,IAAI,CAAC1G,iBAAiB,CAACsF,KAAK,CAAC,CAACxF,OAAM,GAAIC,MAAM,CAACqE,OAAO,CAAC,CAAC;QAC1D,CAAC,CAAC;QACFD,OAAO,CAACpE,MAAK,GAAIA,MAAM;MACzB,CAAC,CAAC;;MAEF;MACA,IAAI,CAACG,mBAAkB,GAAI+I,YAAY,CAAC,gEAAgE,CAAC;MACzG,IAAI,CAAC/I,mBAAmB,CAACwG,EAAE,CAAC,QAAQ,EAAE,MAAM;QAC1C;MAAA,CACD,CAAC;IACJ,CAAC;IAED;IACAmE,UAAUA,CAAC9K,MAAM,EAAEyJ,KAAK,EAAE;MACxB,IAAI,CAACzJ,MAAM,EAAE;MAEb,QAAOyJ,KAAK;QACV,KAAK,WAAW;UACdzJ,MAAM,CAAC+K,KAAK,CAAC,CAAC,CAACC,KAAK,CAAC,CAAC,CAACC,YAAY,CAAC,CAAC,CAACC,GAAG,CAAC,CAAC;UAC3C;QACF,KAAK,IAAI;UACPlL,MAAM,CAAC+K,KAAK,CAAC,CAAC,CAACC,KAAK,CAAC,CAAC,CAACG,aAAa,CAAC;YAAEC,KAAK,EAAE;UAAE,CAAC,CAAC,CAACF,GAAG,CAAC,CAAC;UACxD;QACF,KAAK,IAAI;UACPlL,MAAM,CAAC+K,KAAK,CAAC,CAAC,CAACC,KAAK,CAAC,CAAC,CAACG,aAAa,CAAC;YAAEC,KAAK,EAAE;UAAE,CAAC,CAAC,CAACF,GAAG,CAAC,CAAC;UACxD;QACF,KAAK,IAAI;UACPlL,MAAM,CAAC+K,KAAK,CAAC,CAAC,CAACC,KAAK,CAAC,CAAC,CAACG,aAAa,CAAC;YAAEC,KAAK,EAAE;UAAE,CAAC,CAAC,CAACF,GAAG,CAAC,CAAC;UACxD;QACF,KAAK,YAAY;UACflL,MAAM,CAAC+K,KAAK,CAAC,CAAC,CAACC,KAAK,CAAC,CAAC,CAACK,gBAAgB,CAAC,CAAC,CAACH,GAAG,CAAC,CAAC;UAC/C;QACF,KAAK,MAAM;UACTlL,MAAM,CAAC+K,KAAK,CAAC,CAAC,CAACC,KAAK,CAAC,CAAC,CAACM,eAAe,CAAC,CAAC,CAACJ,GAAG,CAAC,CAAC;UAC9C;MACJ;MACA,IAAI,CAACtE,aAAa,CAAC,CAAC;IACtB,CAAC;IAED;IACA2E,eAAeA,CAACvL,MAAM,EAAE;MACtB,IAAI,CAACA,MAAM,EAAE,OAAO,WAAW;MAE/B,IAAIA,MAAM,CAACwL,QAAQ,CAAC,SAAS,EAAE;QAAEJ,KAAK,EAAE;MAAE,CAAC,CAAC,EAAE,OAAO,IAAI;MACzD,IAAIpL,MAAM,CAACwL,QAAQ,CAAC,SAAS,EAAE;QAAEJ,KAAK,EAAE;MAAE,CAAC,CAAC,EAAE,OAAO,IAAI;MACzD,IAAIpL,MAAM,CAACwL,QAAQ,CAAC,SAAS,EAAE;QAAEJ,KAAK,EAAE;MAAE,CAAC,CAAC,EAAE,OAAO,IAAI;MACzD,IAAIpL,MAAM,CAACwL,QAAQ,CAAC,YAAY,CAAC,EAAE,OAAO,YAAY;MACtD,IAAIxL,MAAM,CAACwL,QAAQ,CAAC,WAAW,CAAC,EAAE,OAAO,MAAM;MAE/C,OAAO,WAAW;IACpB,CAAC;IAED;IACAC,gBAAgBA,CAACzL,MAAM,EAAE;MACvB,IAAI,CAACA,MAAM,EAAE;MAEb,IAAIA,MAAM,CAACwL,QAAQ,CAAC,YAAY,EAAE;QAAE,WAAW,EAAE;MAAS,CAAC,CAAC,EAAE;QAC5DxL,MAAM,CAAC+K,KAAK,CAAC,CAAC,CAACC,KAAK,CAAC,CAAC,CAACU,gBAAgB,CAAC,YAAY,EAAE;UAAE,WAAW,EAAE;QAAK,CAAC,CAAC,CAACR,GAAG,CAAC,CAAC;MACpF,OAAO,IAAIlL,MAAM,CAACwL,QAAQ,CAAC,YAAY,CAAC,EAAE;QACxCxL,MAAM,CAAC+K,KAAK,CAAC,CAAC,CAACC,KAAK,CAAC,CAAC,CAACU,gBAAgB,CAAC,YAAY,EAAE;UAAE,WAAW,EAAE;QAAS,CAAC,CAAC,CAACR,GAAG,CAAC,CAAC;MACxF,OAAO;QACLlL,MAAM,CAAC+K,KAAK,CAAC,CAAC,CAACC,KAAK,CAAC,CAAC,CAACW,gBAAgB,CAAC,CAAC,CAACD,gBAAgB,CAAC,YAAY,EAAE;UAAE,WAAW,EAAE;QAAS,CAAC,CAAC,CAACR,GAAG,CAAC,CAAC;MAC3G;MACA,IAAI,CAACtE,aAAa,CAAC,CAAC;IACtB,CAAC;IAED;IACA+E,gBAAgBA,CAAC3L,MAAM,EAAE;MACvB,IAAI,CAACA,MAAM,EAAE;MAEb,IAAIA,MAAM,CAACwL,QAAQ,CAAC,YAAY,EAAE;QAAE,WAAW,EAAE;MAAS,CAAC,CAAC,EAAE;QAC5DxL,MAAM,CAAC+K,KAAK,CAAC,CAAC,CAACC,KAAK,CAAC,CAAC,CAACU,gBAAgB,CAAC,YAAY,EAAE;UAAE,WAAW,EAAE;QAAK,CAAC,CAAC,CAACR,GAAG,CAAC,CAAC;MACpF,OAAO;QACLlL,MAAM,CAAC+K,KAAK,CAAC,CAAC,CAACC,KAAK,CAAC,CAAC,CAACW,gBAAgB,CAAC,CAAC,CAACT,GAAG,CAAC,CAAC;MACjD;MACA,IAAI,CAACtE,aAAa,CAAC,CAAC;IACtB,CAAC;IAEDtE,cAAcA,CAAA,EAAG;MACf,IAAI,CAAC3C,QAAQ,CAAC2F,OAAO,CAAClB,OAAM,IAAK;QAC/B,IAAIA,OAAO,CAACpE,MAAM,EAAE;UAClBoE,OAAO,CAACpE,MAAM,CAAC4L,OAAO,CAAC,CAAC;UACxBxH,OAAO,CAACpE,MAAK,GAAI,IAAI;QACvB;MACF,CAAC,CAAC;MACF,IAAI,CAACC,iBAAiB,CAACqF,OAAO,CAAClB,OAAM,IAAK;QACxC,IAAIA,OAAO,CAACpE,MAAM,EAAE;UAClBoE,OAAO,CAACpE,MAAM,CAAC4L,OAAO,CAAC,CAAC;UACxBxH,OAAO,CAACpE,MAAK,GAAI,IAAI;QACvB;MACF,CAAC,CAAC;MACF,IAAI,IAAI,CAACG,mBAAmB,EAAE;QAC5B,IAAI,CAACA,mBAAmB,CAACyL,OAAO,CAAC,CAAC;QAClC,IAAI,CAACzL,mBAAkB,GAAI,IAAI;MACjC;IACF,CAAC;IAED0L,YAAYA,CAACzH,OAAO,EAAE;MACpB,IAAIA,OAAO,CAACpE,MAAM,EAAE;QAClBoE,OAAO,CAACpE,MAAM,CAACwF,QAAQ,CAACsG,YAAY,CAAC,CAAC;QACtC,IAAI,CAAClF,aAAa,CAAC,CAAC;QACpB,IAAI,CAACzB,UAAU,CAAC,kBAAkB,EAAE,MAAM,CAAC;MAC7C;IACF,CAAC;IAED4G,kBAAkBA,CAAA,EAAG;MACnB,IAAI,IAAI,CAAC5L,mBAAmB,EAAE;QAC5B,IAAI,CAACA,mBAAmB,CAACqF,QAAQ,CAACsG,YAAY,CAAC,CAAC;QAChD,IAAI,CAAC5L,cAAa,GAAI,EAAE;QACxB,IAAI,CAAC0G,aAAa,CAAC,CAAC;QACpB,IAAI,CAACzB,UAAU,CAAC,wBAAwB,EAAE,MAAM,CAAC;MACnD;IACF,CAAC;IAEDzF,gBAAgBA,CAAA,EAAG;MACjB,MAAMsM,KAAI,GAAI,IAAItJ,IAAI,CAAC,CAAC;MACxB,MAAMkF,IAAG,GAAIoE,KAAK,CAACC,WAAW,CAAC,CAAC;MAChC,MAAMtE,KAAI,GAAIuE,MAAM,CAACF,KAAK,CAACG,QAAQ,CAAC,IAAI,CAAC,CAAC,CAACC,QAAQ,CAAC,CAAC,EAAE,GAAG,CAAC;MAC3D,MAAM1E,GAAE,GAAIwE,MAAM,CAACF,KAAK,CAACK,OAAO,CAAC,CAAC,CAAC,CAACD,QAAQ,CAAC,CAAC,EAAE,GAAG,CAAC;MACpD,OAAO,GAAGxE,IAAI,IAAID,KAAK,IAAID,GAAG,EAAE;IAClC,CAAC;IAED4E,wBAAwBA,CAAA,EAAG;MACzB,IAAI,CAAC,IAAI,CAACnM,mBAAmB,EAAE;MAE/B,MAAMoM,WAAU,GAAI;AAC1B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB;MAEV,MAAMC,gBAAe,GAAID,WAAW,CAACtF,KAAK,CAAC,IAAI,CAAC,CAAC9C,GAAG,CAACsI,IAAG,IAAK;QAC3D,IAAIA,IAAI,CAACpF,IAAI,CAAC,MAAM,EAAE,EAAE,OAAO,SAAS;QAExC,IAAI,UAAU,CAACqF,IAAI,CAACD,IAAI,CAACpF,IAAI,CAAC,CAAC,CAAC,EAAE;UAChC,OAAO,8BAA8BoF,IAAI,CAACE,OAAO,CAAC,aAAa,EAAE,EAAE,CAAC,YAAY;QAClF;QAEA,IAAI,gBAAgB,CAACD,IAAI,CAACD,IAAI,CAACpF,IAAI,CAAC,CAAC,CAAC,EAAE;UACtC,OAAO,WAAWoF,IAAI,YAAY;QACpC;QAEA,OAAO,MAAMA,IAAI,MAAM;MACzB,CAAC,CAAC,CAACG,IAAI,CAAC,EAAE,CAAC;MAEX,IAAI,CAACzM,mBAAmB,CAACqF,QAAQ,CAACC,UAAU,CAAC+G,gBAAgB,CAAC;MAC9D,IAAI,CAAC5F,aAAa,CAAC,CAAC;MACpB,IAAI,CAACzB,UAAU,CAAC,yGAAyG,EAAE,MAAM,CAAC;IACpI,CAAC;IAED0H,kBAAkBA,CAAA,EAAG;MACnB,IAAI,CAAC,IAAI,CAAC1M,mBAAmB,EAAE;MAE/B,MAAM2M,WAAU,GAAI,IAAI,CAAC3M,mBAAmB,CAACoE,OAAO,CAAC,CAAC;MAEtD,IAAI,CAACuI,WAAW,CAACzF,IAAI,CAAC,CAAC,EAAE;QACvB,IAAI,CAAClC,UAAU,CAAC,sDAAsD,EAAE,OAAO,CAAC;QAChF;MACF;MAEA,IAAI;QACF,MAAM4H,KAAI,GAAID,WAAW,CAAC7F,KAAK,CAAC,IAAI,CAAC,CAACR,MAAM,CAACgG,IAAG,IAAKA,IAAI,CAACpF,IAAI,CAAC,MAAM,EAAE,CAAC;QACxE,MAAM5C,KAAI,GAAI,EAAE;QAChB,IAAIuI,UAAS,GAAI,CAAC;QAClB,IAAIC,aAAY,GAAI,CAAC;QACrB,IAAIC,eAAc,GAAI,IAAI;QAE1B,KAAK,IAAIC,CAAA,GAAI,CAAC,EAAEA,CAAA,GAAIJ,KAAK,CAACvL,MAAM,EAAE2L,CAAC,EAAE,EAAE;UACrC,MAAMV,IAAG,GAAIM,KAAK,CAACI,CAAC,CAAC,CAAC9F,IAAI,CAAC,CAAC;UAE5B,IAAIoF,IAAG,KAAM,EAAE,EAAE;UAEjB,IAAI,IAAI,CAACW,mBAAmB,CAACX,IAAI,CAAC,EAAE;YAClC,IAAIS,eAAe,EAAE;cACnBD,aAAa,EAAE;cACf,MAAMI,UAAS,GAAI,GAAGH,eAAe,IAAID,aAAa,EAAE;cACxD,MAAMK,WAAU,GAAI,IAAI,CAACC,kBAAkB,CAACd,IAAI,CAAC;cACjD,MAAMe,QAAO,GAAI,IAAI,CAACC,eAAe,CAAChB,IAAI,EAAEa,WAAW,CAAC;cAExD7I,KAAK,CAACiJ,IAAI,CAAC;gBACTC,MAAM,EAAEN,UAAU;gBAClBO,GAAG,EAAEN,WAAW;gBAChBE,QAAQ,EAAEA,QAAQ;gBAClBpC,KAAK,EAAE;cACT,CAAC,CAAC;YACJ,OAAO;cACL,MAAMkC,WAAU,GAAI,IAAI,CAACC,kBAAkB,CAACd,IAAI,CAAC;cACjD,MAAMe,QAAO,GAAI,IAAI,CAACC,eAAe,CAAChB,IAAI,EAAEa,WAAW,CAAC;cAExD7I,KAAK,CAACiJ,IAAI,CAAC;gBACTC,MAAM,EAAE,GAAGX,UAAU,EAAE;gBACvBY,GAAG,EAAEN,WAAW;gBAChBE,QAAQ,EAAEA;cACZ,CAAC,CAAC;cACFR,UAAU,EAAE;cACZC,aAAY,GAAI,CAAC;YACnB;UACF,OACK,IAAI,IAAI,CAACY,iBAAiB,CAACpB,IAAI,CAAC,EAAE;YACrChI,KAAK,CAACiJ,IAAI,CAAC;cAAEC,MAAM,EAAE,EAAE;cAAEC,GAAG,EAAE,EAAE;cAAEJ,QAAQ,EAAEf,IAAI;cAAErB,KAAK,EAAE;YAAU,CAAC,CAAC;YACrE8B,eAAc,GAAI,IAAI;YACtBD,aAAY,GAAI,CAAC;UACnB,OACK,IAAIR,IAAI,CAACqB,UAAU,CAAC,GAAG,CAAC,EAAE;YAC7BrJ,KAAK,CAACiJ,IAAI,CAAC;cAAEC,MAAM,EAAE,EAAE;cAAEC,GAAG,EAAE,EAAE;cAAEJ,QAAQ,EAAEf,IAAI;cAAErB,KAAK,EAAE;YAAW,CAAC,CAAC;YACtE8B,eAAc,GAAI,IAAI;YACtBD,aAAY,GAAI,CAAC;UACnB,OACK,IAAIR,IAAI,CAACsB,WAAW,CAAC,CAAC,CAACD,UAAU,CAAC,KAAK,KAAKrB,IAAI,CAACsB,WAAW,CAAC,CAAC,CAACD,UAAU,CAAC,KAAK,KAC3ErB,IAAI,CAACsB,WAAW,CAAC,CAAC,CAACD,UAAU,CAAC,KAAK,KAAKrB,IAAI,CAACsB,WAAW,CAAC,CAAC,CAACD,UAAU,CAAC,KAAK,CAAC,EAAE;YACrFrJ,KAAK,CAACiJ,IAAI,CAAC;cAAEC,MAAM,EAAE,EAAE;cAAEC,GAAG,EAAE,EAAE;cAAEJ,QAAQ,EAAEf,IAAI;cAAErB,KAAK,EAAE;YAAc,CAAC,CAAC;YACzE8B,eAAc,GAAI,IAAI;YACtBD,aAAY,GAAI,CAAC;UACnB,OACK,IAAIR,IAAI,CAACsB,WAAW,CAAC,CAAC,CAACC,QAAQ,CAAC,iBAAiB,CAAC,EAAE;YACvDvJ,KAAK,CAACiJ,IAAI,CAAC;cAAEC,MAAM,EAAE,EAAE;cAAEC,GAAG,EAAE,EAAE;cAAEJ,QAAQ,EAAE,iBAAiB;cAAEpC,KAAK,EAAE;YAAM,CAAC,CAAC;YAC9E8B,eAAc,GAAI,IAAI;YACtBD,aAAY,GAAI,CAAC;UACnB,OACK;YACH,MAAMK,WAAU,GAAI,IAAI,CAACC,kBAAkB,CAACd,IAAI,CAAC;YACjD,MAAMe,QAAO,GAAI,IAAI,CAACC,eAAe,CAAChB,IAAI,EAAEa,WAAW,CAAC;YAExD,IAAIA,WAAU,IAAKE,QAAQ,EAAE;cAC3B/I,KAAK,CAACiJ,IAAI,CAAC;gBACTC,MAAM,EAAE,GAAGX,UAAU,EAAE;gBACvBY,GAAG,EAAEN,WAAW;gBAChBE,QAAQ,EAAEA;cACZ,CAAC,CAAC;cACFN,eAAc,GAAIF,UAAU;cAC5BA,UAAU,EAAE;cACZC,aAAY,GAAI,CAAC;YACnB;UACF;QACF;QAEA,IAAI,CAAC/M,cAAa,GAAIuE,KAAK;QAC3B,IAAI,CAACmC,aAAa,CAAC,CAAC;QACpB,IAAI,CAACzB,UAAU,CAAC,uDAAuD,EAAE,SAAS,CAAC;MACrF,EAAE,OAAOpB,KAAK,EAAE;QACd,IAAI,CAACoB,UAAU,CAAC,sCAAqC,GAAIpB,KAAK,CAACkK,OAAO,EAAE,OAAO,CAAC;MAClF;IACF,CAAC;IAEDb,mBAAmBA,CAACX,IAAI,EAAE;MACxB,MAAMyB,kBAAiB,GAAI,CACzB,gBAAgB,EAChB,UAAU,EACV,WAAW,EACX,MAAM,EACN,MAAM,EACN,MAAM,EACN,gBAAgB,EAChB,gBAAe,CAChB;MAED,OAAOA,kBAAkB,CAACC,IAAI,CAACC,OAAM,IAAKA,OAAO,CAAC1B,IAAI,CAACD,IAAI,CAACsB,WAAW,CAAC,CAAC,CAAC,CAAC;IAC7E,CAAC;IAEDF,iBAAiBA,CAACpB,IAAI,EAAE;MACtB,OAAO,CAACA,IAAI,CAACqB,UAAU,CAAC,GAAG,KACpB,CAACrB,IAAI,CAACsB,WAAW,CAAC,CAAC,CAACD,UAAU,CAAC,KAAK,KACpC,CAACrB,IAAI,CAACsB,WAAW,CAAC,CAAC,CAACD,UAAU,CAAC,KAAK,KACpC,CAACrB,IAAI,CAACsB,WAAW,CAAC,CAAC,CAACD,UAAU,CAAC,KAAK,KACpC,CAACrB,IAAI,CAACsB,WAAW,CAAC,CAAC,CAACD,UAAU,CAAC,KAAK,KACpC,CAACrB,IAAI,CAACsB,WAAW,CAAC,CAAC,CAACC,QAAQ,CAAC,iBAAiB,KAC9C,CAAC,IAAI,CAACT,kBAAkB,CAACd,IAAI,KAC7B,CAAC,IAAI,CAACW,mBAAmB,CAACX,IAAI,KAC9BA,IAAI,CAACjL,MAAK,GAAI,EAAE;IACzB,CAAC;IAED+L,kBAAkBA,CAACd,IAAI,EAAE;MACvB,MAAM4B,QAAO,GAAI,CACf,YAAY,EACZ,YAAY,EACZ,aAAa,EACb,aAAa,EACb,YAAY,EACZ,aAAa,EACb,kEAAiE,CAClE;MAED,KAAK,MAAMD,OAAM,IAAKC,QAAQ,EAAE;QAC9B,MAAMC,KAAI,GAAI7B,IAAI,CAAC6B,KAAK,CAACF,OAAO,CAAC;QACjC,IAAIE,KAAK,EAAE;UACT,OAAO,IAAI,CAACC,qBAAqB,CAACD,KAAK,CAAC,CAAC,KAAKA,KAAK,CAAC,CAAC,CAAC,CAAC;QACzD;MACF;MAEA,OAAO,EAAE;IACX,CAAC;IAEDb,eAAeA,CAAChB,IAAI,EAAEa,WAAW,EAAE;MACjC,IAAI,CAACA,WAAW,EAAE,OAAOb,IAAI;MAE7B,MAAM+B,OAAM,GAAItC,MAAM,CAACoB,WAAW,CAAC,CAACjG,IAAI,CAAC,CAAC;MAC1C,MAAMoH,WAAU,GAAID,OAAO,CAAC7B,OAAO,CAAC,qBAAqB,EAAE,MAAM,CAAC;MAElE,MAAM+B,aAAY,GAAI,IAAIC,MAAM,CAAC,WAAWF,WAAW,UAAUA,WAAW,WAAWA,WAAW,WAAWA,WAAW,IAAIA,WAAW,OAAO,EAAE,GAAG,CAAC;MACpJ,IAAIjB,QAAO,GAAIf,IAAI,CAACE,OAAO,CAAC+B,aAAa,EAAE,EAAE,CAAC,CAACrH,IAAI,CAAC,CAAC;MAErD,IAAI,CAACmG,QAAQ,EAAE,OAAO,EAAE;MACxB,OAAOA,QAAQ,CAACoB,MAAM,CAAC,CAAC,CAAC,CAACC,WAAW,CAAC,IAAIrB,QAAQ,CAACsB,KAAK,CAAC,CAAC,CAAC;IAC7D,CAAC;IAEDP,qBAAqBA,CAACQ,MAAM,EAAE;MAC5B,OAAOA,MAAM,CAACH,MAAM,CAAC,CAAC,CAAC,CAACC,WAAW,CAAC,IAAIE,MAAM,CAACD,KAAK,CAAC,CAAC,CAAC;IACzD,CAAC;IAEDE,WAAWA,CAACC,GAAG,EAAE;MACf,IAAIA,GAAG,CAAC7D,KAAI,KAAM,SAAS,EAAE,OAAO,aAAa;MACjD,IAAI6D,GAAG,CAAC7D,KAAI,KAAM,KAAK,EAAE,OAAO,gBAAgB;MAChD,IAAI6D,GAAG,CAAC7D,KAAI,KAAM,UAAU,EAAE,OAAO,cAAc;MACnD,IAAI6D,GAAG,CAAC7D,KAAI,KAAM,aAAa,EAAE,OAAO,iBAAiB;MACzD,IAAI6D,GAAG,CAAC7D,KAAI,KAAM,KAAK,EAAE,OAAO,SAAS;MACzC,IAAI,CAAC6D,GAAG,CAACtB,MAAK,IAAK,CAACsB,GAAG,CAACrB,GAAE,IAAK,CAACqB,GAAG,CAACzB,QAAQ,EAAE,OAAO,WAAW;MAChE,OAAO,YAAY;IACrB,CAAC;IAED,MAAMnQ,oBAAoBA,CAAA,EAAG;MAC3B;MACA,IAAI,CAAC4F,cAAc,CAAC,+BAA+B,CAAC;MAEpD,IAAI,CAACjC,YAAW,GAAI,IAAI;MAExB,MAAMkO,iBAAgB,GAAI,IAAI,CAAC/O,mBAAkB,GAAI,IAAI,CAACA,mBAAmB,CAACoE,OAAO,CAAC,IAAI,EAAE;MAE5F,IAAI2K,iBAAgB,IAAK,IAAI,CAAChP,cAAc,CAACsB,MAAK,KAAM,CAAC,EAAE;QACzD,IAAI,CAACqL,kBAAkB,CAAC,CAAC;MAC3B;MAEA,MAAMsC,YAAW,GAAI;QACnBjQ,YAAY,EAAE,IAAI,CAACA,YAAY;QAC/BkQ,QAAQ,EAAE,IAAI,CAACzP,QAAQ,CAAC,CAAC,CAAC,CAACK,MAAM,CAACqE,OAAO,CAAC,CAAC;QAC3CgL,OAAO,EAAE,IAAI,CAAC1P,QAAQ,CAAC,CAAC,CAAC,CAACK,MAAM,CAACqE,OAAO,CAAC,CAAC;QAC1CiL,iBAAiB,EAAE,IAAI,CAAC3P,QAAQ,CAAC,CAAC,CAAC,CAACK,MAAM,CAACqE,OAAO,CAAC,CAAC;QACpDkL,SAAS,EAAE,IAAI,CAAC5P,QAAQ,CAAC,CAAC,CAAC,CAACK,MAAM,CAACqE,OAAO,CAAC,CAAC;QAC5CmL,MAAM,EAAE,IAAI,CAACvP,iBAAiB,CAAC,CAAC,CAAC,CAACD,MAAM,CAACqE,OAAO,CAAC,CAAC;QAClDoL,QAAQ,EAAE,IAAI,CAACxP,iBAAiB,CAAC,CAAC,CAAC,CAACD,MAAM,CAACqE,OAAO,CAAC;MACrD,CAAC;MAED,IAAI;QACF,MAAMhH,oBAAoB,CAAC8R,YAAY,EAAE,IAAI,CAACjP,cAAc,CAAC;QAC7D,IAAI,CAACiF,UAAU,CAAC,yCAAyC,EAAE,SAAS,CAAC;MACvE,EAAE,OAAOpB,KAAK,EAAE;QACdZ,OAAO,CAACY,KAAK,CAAC,4BAA4B,EAAEA,KAAK,CAAC;QAClD,IAAI,CAACoB,UAAU,CAAC,mCAAkC,GAAIpB,KAAK,CAACkK,OAAO,EAAE,OAAO,CAAC;MAC/E,UAAU;QACR,IAAI,CAACjN,YAAW,GAAI,KAAK;MAC3B;IACF,CAAC;IAED0O,aAAaA,CAAA,EAAG;MACd,IAAI,CAAC3Q,cAAa,GAAI,IAAI;IAC5B,CAAC;IAED4Q,eAAeA,CAAA,EAAG;MAChB,IAAI,CAAC5Q,cAAa,GAAI,KAAK;IAC7B,CAAC;IAED6Q,YAAYA,CAAA,EAAG;MACb,IAAI,CAAC7Q,cAAa,GAAI,KAAK;MAC3B,IAAI,CAAC8Q,YAAY,CAAC,CAAC;;MAEnB;MACA,IAAI,CAAC5M,cAAc,CAAC,qBAAqB,CAAC;MAE1C,IAAI,CAACkC,UAAU,CAAC,wCAAwC,EAAE,MAAM,CAAC;IACnE,CAAC;IAED0K,YAAYA,CAAA,EAAG;MACb,IAAI,CAAClQ,QAAQ,CAAC2F,OAAO,CAAClB,OAAM,IAAK;QAC/B,IAAIA,OAAO,CAACpE,MAAM,EAAE;UAClBoE,OAAO,CAACpE,MAAM,CAACwF,QAAQ,CAACsG,YAAY,CAAC,CAAC;QACxC;MACF,CAAC,CAAC;MACF,IAAI,CAAC7L,iBAAiB,CAACqF,OAAO,CAAClB,OAAM,IAAK;QACxC,IAAIA,OAAO,CAACpE,MAAM,EAAE;UAClBoE,OAAO,CAACpE,MAAM,CAACwF,QAAQ,CAACsG,YAAY,CAAC,CAAC;QACxC;MACF,CAAC,CAAC;MACF,IAAI,IAAI,CAAC3L,mBAAmB,EAAE;QAC5B,IAAI,CAACA,mBAAmB,CAACqF,QAAQ,CAACsG,YAAY,CAAC,CAAC;MAClD;MACA,IAAI,CAAC5L,cAAa,GAAI,EAAE;MAExB,IAAI,CAAChB,YAAW,GAAI;QAClBC,UAAU,EAAE,EAAE;QACdC,UAAU,EAAE,EAAE;QACdC,MAAM,EAAE,EAAE;QACVC,IAAI,EAAE,EAAE;QACRC,MAAM,EAAE,EAAE;QACVC,QAAQ,EAAE,EAAE;QACZC,KAAK,EAAE,IAAI,CAACC,gBAAgB,CAAC;MAC/B,CAAC;MAED,IAAI,CAACe,iBAAgB,GAAI,IAAI;IAC/B,CAAC;IAED0E,UAAUA,CAAC8I,OAAO,EAAE5E,IAAI,EAAE;MACxB,IAAI,CAACvI,aAAY,GAAImN,OAAO;MAC5B,IAAI,CAAClN,UAAS,GAAIsI,IAAI;MAEtByG,UAAU,CAAC,MAAM;QACf,IAAI,CAAChP,aAAY,GAAI,EAAE;QACvB,IAAI,CAACC,UAAS,GAAI,EAAE;MACtB,CAAC,EAAE,IAAI,CAAC;IACV;EACF;AACF","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}